

<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cuda::barrier &#8212; CUDA Core Compute Libraries</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/nvidia-sphinx-theme.css?v=933278ad" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />



    <script src="../../../_static/documentation_options.js?v=bbe6ed3a"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=5ceeb459"></script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'libcudacxx/extended_api/synchronization_primitives/barrier';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://NVIDIA.github.io/cccl/nv-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'unstable';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>

    <link rel="canonical" href="https://NVIDIA.github.io/cccl/libcudacxx/extended_api/synchronization_primitives/barrier.html" />
    <link rel="icon" href="../../../_static/favicon.png"/>

    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="cuda::barrier::init" href="barrier/init.html" />
    <link rel="prev" title="cuda::latch" href="latch.html" />


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="unstable" />


  </head>

  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>


  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../cpp.html">CUDA C++ Core Libraries</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../index.html">libcu++</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../setup.html">Setup</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup/requirements.html">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup/getting.html">Getting libcu++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup/building_and_testing.html">Building &amp; Testing libcu++</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../standard_api.html">Standard API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/algorithms_library.html">Algorithms Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/c_library.html">C Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/concepts_library.html">Concepts Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/container_library.html">Container Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/execution_library.html">Execution Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/numerics_library.html">Numerics Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/ranges_library.html">Ranges Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/synchronization_library.html">Synchronization Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/time_library.html">Time Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/type_support.html">Type Support Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../standard_api/utility_library.html">Utility Library</a></li>
</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../../extended_api.html">Extended API</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../bit.html">Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../execution_model.html">Execution model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../exceptions.html">Exception Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory_model.html">Memory model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thread_groups.html">Thread Groups</a></li>
<li class="toctree-l4 current active"><a class="reference internal" href="../synchronization_primitives.html">Synchronization Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../asynchronous_operations.html">Asynchronous Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory_access_properties.html">Memory access properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functional.html">Functional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../iterators.html">Fancy Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../type_traits.html">Type traits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector_tuple_protocol.html">Vector Tuple Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../numeric.html">Numeric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../random.html">Random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory.html">Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../memory_resource.html">Memory Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../math.html">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mdspan.html">Mdspan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../warp.html">Warp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utility.html">Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../work_stealing.html">Work stealing</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../runtime.html">Runtime</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/cudart_interactions.html">CUDA Runtime interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/stream.html">Streams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/event.html">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/algorithm.html">Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/device.html">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/hierarchy.html">Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/launch.html">Launch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/buffer.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/memory_pools.html">Memory Pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../runtime/legacy_resources.html">Legacy resources</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../ptx_api.html">PTX API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../ptx/examples.html">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ptx/instructions.html">PTX Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../ptx/pragmas.html">PTX Pragmas</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../cub/index.html">CUB</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cub/index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cub/test_overview.html">CUB Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cub/benchmarking.html">CUB Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cub/tuning.html">CUB Tunings</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cub/developer_overview.html">CUB Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/developer/thread_level.html">Thread-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/developer/warp_level.html">Warp-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/developer/block_scope.html">Block-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/developer/device_scope.html">Device-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/developer/nvtx.html">NVTX</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cub/releases.html">CUB Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/releases/changelog.html">CUB 2.1.0</a></li>


















































</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cub/api.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/api_docs/thread_level.html">Thread-level Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/api_docs/warp_wide.html">Warp-Wide “Collective” Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/api_docs/block_wide.html">Block-Wide “Collective” Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cub/api_docs/device_wide.html">Device-Wide Primitives</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cub/api/index.html">API reference</a></li>
</ul>
</details></li>










<li class="toctree-l2 has-children"><a class="reference internal" href="../../../thrust/index.html">Thrust</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../thrust/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../thrust/developer_overview.html">Thrust Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/developer/cmake_options.html">Developer CMake Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/developer/systems.html">Thrust systems</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../thrust/releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../thrust/release_process.html">Release Process</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../thrust/api.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/algorithms.html">Algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/containers.html">Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/function_objects.html">Function Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/iterators.html">Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/memory_management.html">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/numerics.html">Numerics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/parallel_execution_policies.html">Parallel Execution Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/random.html">Random Number Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/system.html">System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../thrust/api_docs/utility.html">Utility</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../thrust/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../cudax/index.html">CUDA Experimental</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cudax/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cudax/container.html">Containers library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/classcuda_1_1experimental_1_1uninitialized__buffer.html">cuda::experimental::uninitialized_buffer</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cudax/memory_resource.html">Memory Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/classcuda_1_1mr_1_1basic__any__resource.html">cuda::mr::basic_any_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/structcuda_1_1memory__pool__properties.html">cuda::memory_pool_properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/structcuda_1_1device__memory__pool.html">cuda::device_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/structcuda_1_1pinned__memory__pool.html">cuda::pinned_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/structcuda_1_1managed__memory__pool.html">cuda::managed_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/classcuda_1_1mr_1_1legacy__pinned__memory__resource.html">cuda::mr::legacy_pinned_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/classcuda_1_1mr_1_1legacy__managed__memory__resource.html">cuda::mr::legacy_managed_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/structcuda_1_1mr_1_1shared__resource.html">cuda::mr::shared_resource</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cudax/graph.html">Graphs library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1graph.html">cuda::experimental::graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1graph__builder.html">cuda::experimental::graph_builder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1graph__builder__ref.html">cuda::experimental::graph_builder_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1graph__node__ref.html">cuda::experimental::graph_node_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of.html">cuda::experimental::stf::graphed_interface_of</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01mdspan_3_01T_00_01P_8_8_8_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; mdspan&lt; T, P… &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01scalar__view_3_01T_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; scalar_view&lt; T &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01void__interface_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; void_interface &gt;</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cudax/stf.html">CUDASTF</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cudax/stf/custom_data_interface.html">Implementation of the <code class="docutils literal notranslate"><span class="pre">matrix</span></code> class</a></li>





<li class="toctree-l4"><a class="reference internal" href="../../../cudax/stf/lower_level_api.html">Lower-level API</a></li>

</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cudax/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cccl/tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cccl/3.0_migration_guide.html">CCCL 2.x ‐ CCCL 3.0 migration guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../cccl/development/index.html">CCCL Development Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cccl/development/macro.html">CCCL Internal Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cccl/development/testing.html">CCCL Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../cccl/development/build_and_bisect_tools.html">Build and Bisect Utilities</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../cccl/development/visibility.html">Symbol Visibility</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../cccl/development/visibility/host_stub_visibility.html">Host Stub Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cccl/development/visibility/device_kernel_visibility.html">Device Kernel Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../cccl/development/visibility/different_architectures.html">Linking TUs compiled with different architectures</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../cccl/contributing.html">Contributing to the CUDA Core Compute Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../cccl/contributing/code_of_conduct.html">Code of Conduct</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../cccl/license.html">License</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../python/index.html">CCCL Python Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../python/setup.html">Setup and Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python/compute.html"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code>: Parallel Computing Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python/coop.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code>: Cooperative Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../python/resources.html">Resources</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../python/api_reference.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../python/compute_api.html"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../python/coop_api.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code> API Reference</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../cpp.html" class="nav-link">CUDA C++ Core Libraries</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">libcu++</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../extended_api.html" class="nav-link">Extended API</a></li>
    
    
    <li class="breadcrumb-item"><a href="../synchronization_primitives.html" class="nav-link">Synchronization Primitives</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code></span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cuda-barrier">
<span id="libcudacxx-extended-api-synchronization-barrier"></span><h1><code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code><a class="headerlink" href="#cuda-barrier" title="Link to this heading">#</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>Defined in header <code class="docutils literal notranslate"><span class="pre">&lt;cuda/barrier&gt;</span></code>:</p>
<div class="highlight-cuda notranslate"><div class="highlight"><pre><span></span><span class="n">template</span><span class="w"> </span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope</span><span class="w"> </span><span class="n">Scope</span><span class="p">,</span>
<span class="w">          </span><span class="n">typename</span><span class="w"> </span><span class="n">CompletionFunction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="cm">/* unspecified */</span><span class="o">&gt;</span>
<span class="n">class</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="p">;</span>
</pre></div>
</div>
<p>The class template <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> is an extended form of <a class="reference external" href="https://en.cppreference.com/w/cpp/thread/barrier">cuda::std::barrier</a>
that takes an additional <a class="reference internal" href="../memory_model.html#libcudacxx-extended-api-memory-model-thread-scopes"><span class="std std-ref">cuda::thread_scope</span></a> argument.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">!(scope</span> <span class="pre">==</span> <span class="pre">cuda::thread_block_scope</span> <span class="pre">&amp;&amp;</span> <span class="pre">cuda::device::is_address_from(this,</span> <span class="pre">cuda::device::address_space::shared))</span></code>, then the semantics are the same as
<a class="reference external" href="https://en.cppreference.com/w/cpp/thread/barrier">cuda::std::barrier</a>, otherwise, see below.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> class templates extends <code class="docutils literal notranslate"><span class="pre">cuda::std::barrier</span></code> with the following additional operations:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 75.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="barrier/init.html#libcudacxx-extended-api-synchronization-barrier-barrier-init"><span class="std std-ref">cuda::barrier::init</span></a></p></td>
<td><p>Initialize a <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="barrier/barrier_native_handle.html#libcudacxx-extended-api-synchronization-barrier-barrier-native-handle"><span class="std std-ref">cuda::device::barrier_native_handle</span></a></p></td>
<td><p>Get the native handle to a <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="barrier/barrier_arrive_tx.html#libcudacxx-extended-api-synchronization-barrier-barrier-arrive-tx"><span class="std std-ref">cuda::device::barrier_arrive_tx</span></a></p></td>
<td><p>Arrive on a <code class="docutils literal notranslate"><span class="pre">cuda::barrier&lt;cuda::thread_scope_block&gt;</span></code> with transaction count update.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="barrier/barrier_expect_tx.html#libcudacxx-extended-api-synchronization-barrier-barrier-expect-tx"><span class="std std-ref">cuda::device::barrier_expect_tx</span></a></p></td>
<td><p>Update transaction count of <code class="docutils literal notranslate"><span class="pre">cuda::barrier&lt;cuda::thread_scope_block&gt;</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">scope</span> <span class="pre">==</span> <span class="pre">cuda::thread_scope_block</span> <span class="pre">&amp;&amp;</span> <span class="pre">cuda::device::is_address_from(this,</span> <span class="pre">cuda::device::address_space::shared)</span></code>, then the semantics of <a class="reference external" href="http://eel.is/c++draft/thread.barrier.class">[thread.barrier.class]</a>
of ISO/IEC IS 14882 (the C++ Standard) are modified as follows:</p>
<blockquote>
<div><p>A barrier is a thread coordination mechanism whose lifetime consists
of a sequence of barrier phases, where each phase allows at most an
expected number of threads to block until the expected number of
threads <strong>and the expected number of transaction-based asynchronous
operations</strong> arrive at the barrier. Each <em>barrier phase</em> consists of
the following steps:</p>
<ol class="arabic simple">
<li><p>The <em>expected count</em> is decremented by each call to <code class="docutils literal notranslate"><span class="pre">arrive</span></code>,<code class="docutils literal notranslate"><span class="pre">arrive_and_drop</span></code><strong>,
or cuda::device::barrier_arrive_tx</strong>.</p></li>
<li><p><strong>The transaction count is incremented by each call to cuda::device::barrier_arrive_tx and decremented by the
completion of transaction-based asynchronous operations such as cuda::memcpy_async_tx.</strong></p></li>
<li><p>Exactly once after <strong>both</strong> the <em>expected count</em> <strong>and the transaction count</strong> reach zero, a thread executes the
<em>completion step</em> during its call to <code class="docutils literal notranslate"><span class="pre">arrive</span></code>, <code class="docutils literal notranslate"><span class="pre">arrive_and_drop</span></code>, <code class="docutils literal notranslate"><span class="pre">cuda::device::barrier_arrive_tx</span></code>,
or <code class="docutils literal notranslate"><span class="pre">wait</span></code>, except that it is implementation-defined whether the step executes if no thread calls <code class="docutils literal notranslate"><span class="pre">wait</span></code>.</p></li>
<li><p>When the completion step finishes, the <em>expected count</em> is reset to what was specified by the <code class="docutils literal notranslate"><span class="pre">expected</span></code>
argument to the constructor, possibly adjusted by calls to <code class="docutils literal notranslate"><span class="pre">arrive_and_drop</span></code>, and the next phase starts.</p></li>
</ol>
<p>Concurrent invocations of the member functions of barrier <strong>and the non-member barrier APIs in cuda::device</strong>,
other than its destructor, do not introduce data races. The member functions <code class="docutils literal notranslate"><span class="pre">arrive</span></code> and <code class="docutils literal notranslate"><span class="pre">arrive_and_drop</span></code>,
<strong>and the non-member function cuda::device::barrier_arrive_tx</strong>, execute atomically.</p>
</div></blockquote>
<p class="rubric">NVCC <code class="docutils literal notranslate"><span class="pre">__shared__</span></code> Initialization Warnings</p>
<p>When using libcu++ with NVCC, a <code class="docutils literal notranslate"><span class="pre">__shared__</span></code> <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> will lead to the following warning because
<code class="docutils literal notranslate"><span class="pre">__shared__</span></code> variables are not initialized:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>warning:<span class="w"> </span>dynamic<span class="w"> </span>initialization<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>supported<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span><span class="k">function</span>-scope<span class="w"> </span>static
__shared__<span class="w"> </span>variable<span class="w"> </span>within<span class="w"> </span>a<span class="w"> </span>__device__/__global__<span class="w"> </span><span class="k">function</span>
</pre></div>
</div>
<p>It can be silenced using <code class="docutils literal notranslate"><span class="pre">#pragma</span> <span class="pre">nv_diag_suppress</span> <span class="pre">static_var_with_dynamic_init</span></code>.</p>
<p>To properly initialize a <code class="docutils literal notranslate"><span class="pre">__shared__</span></code> <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code>, use the
<a class="reference internal" href="barrier/init.html#libcudacxx-extended-api-synchronization-barrier-barrier-init"><span class="std std-ref">cuda::barrier::init</span></a> friend function.</p>
<p class="rubric">Concurrency Restrictions</p>
<p>An object of type <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> or <code class="docutils literal notranslate"><span class="pre">cuda::std::barrier</span></code> shall not be accessed concurrently by CPU and GPU threads unless:</p>
<blockquote>
<div><ul class="simple">
<li><p>it is in unified memory and the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-runtime-api/structcudaDeviceProp.html#structcudaDeviceProp_116f9619ccc85e93bc456b8c69c80e78b">concurrentManagedAccess property</a>
is 1, or</p></li>
<li><p>it is in CPU memory and the <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-runtime-api/structcudaDeviceProp.html#structcudaDeviceProp_1ef82fd7d1d0413c7d6f33287e5b6306f">hostNativeAtomicSupported property</a>
is 1.</p></li>
</ul>
</div></blockquote>
<p>Note, for objects of scopes other than <code class="docutils literal notranslate"><span class="pre">cuda::thread_scope_system</span></code> this is a data-race, and therefore also prohibited
regardless of memory characteristics.</p>
<p>Under CUDA Compute Capability 8 (Ampere) or above, when an object of type <code class="docutils literal notranslate"><span class="pre">cuda::barrier&lt;thread_scope_block&gt;</span></code> is
placed in <code class="docutils literal notranslate"><span class="pre">__shared__</span></code> memory, the member function <code class="docutils literal notranslate"><span class="pre">arrive</span></code> performs a reduction of the arrival count among
<a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#coalesced-group-cg">coalesced threads</a> followed
by the arrival operation in one thread. Programs shall ensure that this transformation would not introduce errors,
for example relative to the requirements of <a class="reference external" href="https://eel.is/c++draft/thread.barrier.class#12">thread.barrier.class paragraph 12</a>
of ISO/IEC IS 14882 (the C++ Standard).</p>
<p>Under CUDA Compute Capability 6 (Pascal) or prior, an object of type <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> or <code class="docutils literal notranslate"><span class="pre">cuda::std::barrier</span></code> may
not be used.</p>
<p class="rubric">Shared memory barriers with transaction count</p>
<p>In addition to the arrival count, a <code class="docutils literal notranslate"><span class="pre">cuda::barrier&lt;thread_scope_block&gt;</span></code> object located in shared memory supports a
<a class="reference external" href="https://docs.nvidia.com/cuda/parallel-thread-execution/index.html#parallel-synchronization-and-communication-instructions-mbarrier-tracking-async-operations">tx-count</a>,
which is used for tracking the completion of some asynchronous memory operations or transactions.
The tx-count tracks the number of asynchronous transactions, in units specified by the asynchronous memory operation
(typically bytes), that are outstanding and yet to be complete. This capability is exposed, starting with the Hopper
architecture (CUDA Compute Capability 9).</p>
<p>The tx-count of <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> must be set to the total amount of asynchronous memory operations, in units as
specified by the asynchronous operations, to be tracked by the current phase. This can be achieved with the
<a class="reference internal" href="barrier/barrier_arrive_tx.html#libcudacxx-extended-api-synchronization-barrier-barrier-arrive-tx"><span class="std std-ref">cuda::device::barrier_arrive_tx</span></a> function call.</p>
<p>Upon completion of each of the asynchronous operations, the tx-count of the <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> will be updated and thus
progress the <code class="docutils literal notranslate"><span class="pre">cuda::barrier</span></code> towards the completion of the current phase. This may complete the current phase.</p>
<p class="rubric">Implementation-Defined Behavior</p>
<p>For each <a class="reference internal" href="../memory_model.html#libcudacxx-extended-api-memory-model-thread-scopes"><span class="std std-ref">cuda::thread_scope</span></a> <code class="docutils literal notranslate"><span class="pre">S</span></code> and <code class="docutils literal notranslate"><span class="pre">CompletionFunction</span></code>
<code class="docutils literal notranslate"><span class="pre">F</span></code>, the value of <code class="docutils literal notranslate"><span class="pre">cuda::barrier&lt;S,</span> <span class="pre">F&gt;::max()</span></code> is as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<colgroup>
<col style="width: 25.0%" />
<col style="width: 25.0%" />
<col style="width: 50.0%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../memory_model.html#libcudacxx-extended-api-memory-model-thread-scopes"><span class="std std-ref">cuda::thread_scope</span></a> <code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CompletionFunction</span></code> <code class="docutils literal notranslate"><span class="pre">F</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">barrier&lt;S,</span> <span class="pre">F&gt;::max()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">cuda::thread_scope_block</span></code></p></td>
<td><p>Default or user-provided</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">&lt;&lt;</span> <span class="pre">20)</span> <span class="pre">-</span> <span class="pre">1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><em>Not</em> <code class="docutils literal notranslate"><span class="pre">cuda::thread_scope_block</span></code></p></td>
<td><p>Default</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuda::std::numeric_limits&lt;cuda::std::int32_t&gt;::max()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><em>Not</em> <code class="docutils literal notranslate"><span class="pre">cuda::thread_scope_block</span></code></p></td>
<td><p>User-provided</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cuda::std::numeric_limits&lt;cuda::std::ptrdiff_t&gt;::max()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Example</p>
<div class="highlight-cuda notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cuda/barrier&gt;</span>

<span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">example_kernel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// This barrier is suitable for all threads in the system.</span>
<span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope_system</span><span class="o">&gt;</span><span class="w"> </span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// This barrier has the same type as the previous one (`a`).</span>
<span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">std</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// This barrier is suitable for all threads on the current processor (e.g. GPU).</span>
<span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope_device</span><span class="o">&gt;</span><span class="w"> </span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// This barrier is suitable for all threads in the same thread block.</span>
<span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope_block</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://godbolt.org/z/7Kbz5qqhh">See it on Godbolt</a></p>
<p class="rubric">Example: 1D TMA load of two buffers with arrival token (sm90+)</p>
<p>The following example shows how to use TMA to load two tiles of data from global memory into shared memory:</p>
<div class="highlight-cuda notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cuda/barrier&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cuda/ptx&gt;</span>

<span class="c1">// selects a single leader thread from the block</span>
<span class="kt">__device__</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">elect_one</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">warp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tid</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">uniform_warp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__shfl_sync</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="n">warp_id</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// broadcast from lane 0</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">uniform_warp_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">ptx</span><span class="o">::</span><span class="n">elect_sync</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">);</span><span class="w"> </span><span class="c1">// elect a leader thread among warp 0</span>
<span class="p">}</span>

<span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">example_kernel</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">gmem1</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">gmem2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tile_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w"> </span><span class="nf">alignas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">smem1</span><span class="p">[</span><span class="n">tile_size</span><span class="p">];</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w"> </span><span class="nf">alignas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">smem2</span><span class="p">[</span><span class="n">tile_size</span><span class="p">];</span>

<span class="w">  </span><span class="cp">#pragma nv_diag_suppress static_var_with_dynamic_init</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope_block</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bar</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// setup the barrier where each thread in the block arrives at</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="nb">blockDim</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nf">__syncthreads</span><span class="p">();</span><span class="w"> </span><span class="c1">// need to sync so other threads can arrive</span>

<span class="w">  </span><span class="c1">// select a single thread from the block and issue two TMA bulk copy operations</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="k">auto</span><span class="w"> </span><span class="n">elected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elect_one</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elected</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">memcpy_async_tx</span><span class="p">(</span><span class="n">smem1</span><span class="p">,</span><span class="w"> </span><span class="n">gmem1</span><span class="p">,</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">aligned_size_t</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">bar</span><span class="p">);</span>
<span class="w">    </span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">memcpy_async_tx</span><span class="p">(</span><span class="n">smem2</span><span class="p">,</span><span class="w"> </span><span class="n">gmem2</span><span class="p">,</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">aligned_size_t</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)),</span><span class="w"> </span><span class="n">bar</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// arrive at the barrier</span>
<span class="w">  </span><span class="c1">// the elected thread also updates the barrier&#39;s expect_tx with the **total** number of loaded bytes</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tx_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elected</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">))</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">barrier_arrive_tx</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tx_count</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// wait for TMA copies to complete</span>
<span class="w">  </span><span class="n">bar</span><span class="p">.</span><span class="n">wait</span><span class="p">(</span><span class="n">cuda</span><span class="o">::</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">token</span><span class="p">));</span>

<span class="w">  </span><span class="c1">// process data in smem ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://godbolt.org/z/ddhzGeWPE">See it on Godbolt</a></p>
<p>Data is loaded from the global memory pointers <code class="docutils literal notranslate"><span class="pre">gmem1</span></code> and <code class="docutils literal notranslate"><span class="pre">gmem2</span></code>
into the shared memory buffers <code class="docutils literal notranslate"><span class="pre">smem1</span></code> and <code class="docutils literal notranslate"><span class="pre">smem2</span></code>.
The shared memory buffers have to be aligned to 16 bytes.
Additionally, a single barrier with block scope is setup by a single leader thread.
Each thread will arrive at the barrier, so <code class="docutils literal notranslate"><span class="pre">blockDim.x</span></code> is passed as arrival count to <code class="docutils literal notranslate"><span class="pre">init</span></code>.
This barrier is used to synchronize the asynchronous TMA copies with the rest of the threads in the block.
The leader initiates the TMA copies using <code class="docutils literal notranslate"><span class="pre">ptx::cp_async_bulk</span></code>,
and updates the barrier’s tx-count with the total number of bytes transferred by the TMA copy operations
while arriving at the barrier using <code class="docutils literal notranslate"><span class="pre">cuda::device::barrier_arrive_tx</span></code>.
All other threads just arrive normally at the barrier.
All threads then wait on the barrier to complete the current phase by calling <code class="docutils literal notranslate"><span class="pre">wait</span></code>.
Once <code class="docutils literal notranslate"><span class="pre">wait</span></code> returns, all data is available in shared memory.</p>
<p class="rubric">Example: 1D TMA load of two buffers with barrier phase parity check (sm90+)</p>
<div class="highlight-cuda notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cuda/barrier&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cuda/ptx&gt;</span>

<span class="c1">// selects a single leader thread from the block</span>
<span class="kt">__device__</span><span class="w"> </span><span class="kt">bool</span><span class="w"> </span><span class="n">elect_one</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">threadIdx</span><span class="p">.</span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">warp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tid</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">32</span><span class="p">;</span>
<span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">uniform_warp_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__shfl_sync</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span><span class="w"> </span><span class="n">warp_id</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// broadcast from lane 0</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">uniform_warp_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">ptx</span><span class="o">::</span><span class="n">elect_sync</span><span class="p">(</span><span class="mh">0xFFFFFFFF</span><span class="p">);</span><span class="w"> </span><span class="c1">// elect a leader thread among warp 0</span>
<span class="p">}</span>

<span class="kr">__global__</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="n">example_kernel</span><span class="p">(</span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">gmem1</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="o">*</span><span class="w"> </span><span class="n">gmem2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">constexpr</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">tile_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1024</span><span class="p">;</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w"> </span><span class="nf">alignas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">smem1</span><span class="p">[</span><span class="n">tile_size</span><span class="p">];</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w"> </span><span class="nf">alignas</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">smem2</span><span class="p">[</span><span class="n">tile_size</span><span class="p">];</span>

<span class="w">  </span><span class="cp">#pragma nv_diag_suppress static_var_with_dynamic_init</span>
<span class="w">  </span><span class="kt">__shared__</span><span class="w">  </span><span class="n">cuda</span><span class="o">::</span><span class="n">barrier</span><span class="o">&lt;</span><span class="n">cuda</span><span class="o">::</span><span class="n">thread_scope_block</span><span class="o">&gt;</span><span class="w"> </span><span class="n">bar</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// setup the barrier where only the leader thread arrives</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">elect_one</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// issue two TMA bulk copy operations</span>
<span class="w">    </span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">memcpy_async_tx</span><span class="p">(</span><span class="n">smem1</span><span class="p">,</span><span class="w"> </span><span class="n">gmem1</span><span class="p">,</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">aligned_size_t</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">bar</span><span class="p">);</span>
<span class="w">    </span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">memcpy_async_tx</span><span class="p">(</span><span class="n">smem2</span><span class="p">,</span><span class="w"> </span><span class="n">gmem2</span><span class="p">,</span><span class="w"> </span><span class="n">cuda</span><span class="o">::</span><span class="n">aligned_size_t</span><span class="o">&lt;</span><span class="mi">16</span><span class="o">&gt;</span><span class="p">(</span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)),</span><span class="w"> </span><span class="n">bar</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// arrive and update the barrier&#39;s expect_tx with the **total** number of loaded bytes</span>
<span class="w">    </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">barrier_arrive_tx</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tile_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">double</span><span class="p">)));</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nf">__syncthreads</span><span class="p">();</span><span class="w"> </span><span class="c1">// need to sync so the barrier is set up when the other threads arrive and wait</span>

<span class="w">  </span><span class="c1">// wait for the current barrier phase to complete</span>
<span class="w">  </span><span class="n">bar</span><span class="p">.</span><span class="n">wait_parity</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// process data in smem ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p><a class="reference external" href="https://godbolt.org/z/oq85PoKKj">See it on Godbolt</a></p>
<p>This is similar to the above example, but this time only the leader thread arrives at the barrier.
This has the advantage that only one leader election is necessary
and a single uniform datapath section is generated.
This generally generates less instructions.
Because now we don’t get an arrival token in each thread, we cannot use <code class="docutils literal notranslate"><span class="pre">wait(token)</span></code> with all threads.
Instead, we just wait until the end of the barrier’s current phase using <code class="docutils literal notranslate"><span class="pre">wait_parity(0)</span></code>
(0 is the parity of the current phase).</p>
<p>Before CCCL 3.2, <code class="docutils literal notranslate"><span class="pre">bar.wait_parity(0);</span></code> contained additional logic which may have lead to unnecessary instructions.
If you are using CCCL below 3.2, you may replace this line with:</p>
<div class="highlight-cuda notranslate"><div class="highlight"><pre><span></span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">cuda</span><span class="o">::</span><span class="n">ptx</span><span class="o">::</span><span class="n">mbarrier_try_wait_parity</span><span class="p">(</span><span class="n">cuda</span><span class="o">::</span><span class="n">device</span><span class="o">::</span><span class="n">barrier_native_handle</span><span class="p">(</span><span class="n">bar</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span>
<span class="w">  </span><span class="p">;</span>
</pre></div>
</div>
<p class="rubric">Example: 1D TMA load and store using <cite>cuda::device::memcpy_async_tx</cite> (sm90+)</p>
<p>This example can be found in <a class="reference internal" href="../asynchronous_operations/memcpy_async_tx.html#libcudacxx-extended-api-asynchronous-operations-memcpy-async-tx-example"><span class="std std-ref">Example</span></a>.</p>
<p class="rubric">Example: 1D TMA load and store using <cite>cuda::memcpy_async</cite> (sm90+)</p>
<p>This example can be found in the
<a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/#using-tma-to-transfer-one-dimensional-arrays">CUDA programming guide</a>.</p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="latch.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><code class="docutils literal notranslate"><span class="pre">cuda::latch</span></code></p>
      </div>
    </a>
    <a class="right-next"
       href="barrier/init.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">cuda::barrier::init</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            

<div class="bd-sidebar-secondary"></div>


              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2026, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>