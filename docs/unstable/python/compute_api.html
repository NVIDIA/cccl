

<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cuda.compute API Reference &#8212; CUDA Core Compute Libraries</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/nvidia-sphinx-theme.css?v=933278ad" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />



    <script src="../_static/documentation_options.js?v=bbe6ed3a"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=5ceeb459"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'python/compute_api';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://NVIDIA.github.io/cccl/nv-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'unstable';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>

    <link rel="canonical" href="https://NVIDIA.github.io/cccl/python/compute_api.html" />
    <link rel="icon" href="../_static/favicon.png"/>

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cuda.coop API Reference" href="coop_api.html" />
    <link rel="prev" title="API Reference" href="api_reference.html" />


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="unstable" />


  </head>

  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>


  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../cpp.html">CUDA C++ Core Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../libcudacxx/index.html">libcu++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../libcudacxx/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/setup.html">Setup</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/setup/requirements.html">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/setup/getting.html">Getting libcu++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/setup/building_and_testing.html">Building &amp; Testing libcu++</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/standard_api.html">Standard API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/algorithms_library.html">Algorithms Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/c_library.html">C Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/concepts_library.html">Concepts Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/container_library.html">Container Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/execution_library.html">Execution Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/numerics_library.html">Numerics Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/ranges_library.html">Ranges Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/synchronization_library.html">Synchronization Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/time_library.html">Time Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/type_support.html">Type Support Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/standard_api/utility_library.html">Utility Library</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/extended_api.html">Extended API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/bit.html">Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/execution_model.html">Execution model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/exceptions.html">Exception Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/memory_model.html">Memory model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/thread_groups.html">Thread Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/synchronization_primitives.html">Synchronization Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/asynchronous_operations.html">Asynchronous Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/memory_access_properties.html">Memory access properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/functional.html">Functional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/iterators.html">Fancy Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/type_traits.html">Type traits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/vector_tuple_protocol.html">Vector Tuple Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/numeric.html">Numeric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/random.html">Random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/memory.html">Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/memory_resource.html">Memory Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/math.html">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/mdspan.html">Mdspan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/warp.html">Warp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/utility.html">Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/extended_api/work_stealing.html">Work stealing</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/runtime.html">Runtime</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/cudart_interactions.html">CUDA Runtime interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/stream.html">Streams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/event.html">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/algorithm.html">Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/device.html">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/hierarchy.html">Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/launch.html">Launch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/buffer.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/memory_pools.html">Memory Pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/runtime/legacy_resources.html">Legacy resources</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../libcudacxx/ptx_api.html">PTX API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/ptx/examples.html">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/ptx/instructions.html">PTX Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/ptx/pragmas.html">PTX Pragmas</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../libcudacxx/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cub/index.html">CUB</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../cub/index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cub/test_overview.html">CUB Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cub/benchmarking.html">CUB Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cub/tuning.html">CUB Tunings</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cub/developer_overview.html">CUB Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cub/developer/thread_level.html">Thread-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/developer/warp_level.html">Warp-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/developer/block_scope.html">Block-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/developer/device_scope.html">Device-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/developer/nvtx.html">NVTX</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cub/releases.html">CUB Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cub/releases/changelog.html">CUB 2.1.0</a></li>


















































</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cub/api.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cub/api_docs/thread_level.html">Thread-level Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/api_docs/warp_wide.html">Warp-Wide “Collective” Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/api_docs/block_wide.html">Block-Wide “Collective” Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cub/api_docs/device_wide.html">Device-Wide Primitives</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../cub/api/index.html">API reference</a></li>
</ul>
</details></li>










<li class="toctree-l2 has-children"><a class="reference internal" href="../thrust/index.html">Thrust</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../thrust/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../thrust/developer_overview.html">Thrust Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../thrust/developer/cmake_options.html">Developer CMake Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/developer/systems.html">Thrust systems</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../thrust/releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../thrust/releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../thrust/release_process.html">Release Process</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../thrust/api.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/algorithms.html">Algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/containers.html">Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/function_objects.html">Function Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/iterators.html">Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/memory_management.html">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/numerics.html">Numerics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/parallel_execution_policies.html">Parallel Execution Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/random.html">Random Number Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/system.html">System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thrust/api_docs/utility.html">Utility</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../thrust/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cudax/index.html">CUDA Experimental</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../cudax/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cudax/container.html">Containers library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/classcuda_1_1experimental_1_1uninitialized__buffer.html">cuda::experimental::uninitialized_buffer</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cudax/memory_resource.html">Memory Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/classcuda_1_1mr_1_1basic__any__resource.html">cuda::mr::basic_any_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/structcuda_1_1memory__pool__properties.html">cuda::memory_pool_properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/structcuda_1_1device__memory__pool.html">cuda::device_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/structcuda_1_1pinned__memory__pool.html">cuda::pinned_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/structcuda_1_1managed__memory__pool.html">cuda::managed_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/classcuda_1_1mr_1_1legacy__pinned__memory__resource.html">cuda::mr::legacy_pinned_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/classcuda_1_1mr_1_1legacy__managed__memory__resource.html">cuda::mr::legacy_managed_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../libcudacxx/api/structcuda_1_1mr_1_1shared__resource.html">cuda::mr::shared_resource</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cudax/graph.html">Graphs library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1graph.html">cuda::experimental::graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1graph__builder.html">cuda::experimental::graph_builder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1graph__builder__ref.html">cuda::experimental::graph_builder_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1graph__node__ref.html">cuda::experimental::graph_node_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of.html">cuda::experimental::stf::graphed_interface_of</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01mdspan_3_01T_00_01P_8_8_8_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; mdspan&lt; T, P… &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01scalar__view_3_01T_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; scalar_view&lt; T &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01void__interface_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; void_interface &gt;</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cudax/stf.html">CUDASTF</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cudax/stf/custom_data_interface.html">Implementation of the <code class="docutils literal notranslate"><span class="pre">matrix</span></code> class</a></li>





<li class="toctree-l4"><a class="reference internal" href="../cudax/stf/lower_level_api.html">Lower-level API</a></li>

</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../cudax/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../cccl/tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cccl/3.0_migration_guide.html">CCCL 2.x ‐ CCCL 3.0 migration guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cccl/development/index.html">CCCL Development Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../cccl/development/macro.html">CCCL Internal Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cccl/development/testing.html">CCCL Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cccl/development/build_and_bisect_tools.html">Build and Bisect Utilities</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../cccl/development/visibility.html">Symbol Visibility</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../cccl/development/visibility/host_stub_visibility.html">Host Stub Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cccl/development/visibility/device_kernel_visibility.html">Device Kernel Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../cccl/development/visibility/different_architectures.html">Linking TUs compiled with different architectures</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../cccl/contributing.html">Contributing to the CUDA Core Compute Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../cccl/contributing/code_of_conduct.html">Code of Conduct</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../cccl/license.html">License</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">CCCL Python Libraries</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="setup.html">Setup and Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute.html"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code>: Parallel Computing Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="coop.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code>: Cooperative Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="resources.html">Resources</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="api_reference.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="coop_api.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code> API Reference</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">CCCL Python Libraries</a></li>
    
    
    <li class="breadcrumb-item"><a href="api_reference.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> API Reference</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cuda-compute-api-reference">
<span id="cuda-compute-module"></span><h1><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> API Reference<a class="headerlink" href="#cuda-compute-api-reference" title="Link to this heading">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> is in public beta.
The API is subject to change without notice.</p>
</div>
<section id="module-cuda.compute.algorithms">
<span id="algorithms"></span><h2>Algorithms<a class="headerlink" href="#module-cuda.compute.algorithms" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.reduce_into">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">reduce_into</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.reduce_into" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide reduction.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">reduce_into</span></code> is used to compute the sum of a sequence of integers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Sum all values in an array using reduction with PLUS operation.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="n">OpKind</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Perform the reduction.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="mi">15</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">d_output</span> <span class="o">==</span> <span class="n">expected_output</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum reduction result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array to store the result of the reduction</p></li>
<li><p><strong>op</strong> – Binary operator to apply.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the data type of the initial value <code class="docutils literal notranslate"><span class="pre">h_init</span></code>.</p></li>
<li><p><strong>num_items</strong> – Number of items to reduce</p></li>
<li><p><strong>h_init</strong> – Initial value for the reduction</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_reduce_into">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_reduce_into</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_reduce_into" title="Link to this definition">#</a></dt>
<dd><p>Computes a device-wide reduction using the specified binary <code class="docutils literal notranslate"><span class="pre">op</span></code> and initial value <code class="docutils literal notranslate"><span class="pre">init</span></code>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_reduce_into</span></code> is used to create a reduction object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Reduction example using the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">init_value</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">init_value</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Create a reducer object.</span>
<span class="n">reducer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_reduce_into</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Allocate temporary storage using any user-defined allocator.</span>
<span class="c1"># The result must be an object exposing `__cuda_array_interface__`.</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the reduction.</span>
<span class="n">reducer</span><span class="p">(</span><span class="n">d_temp_storage</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span> <span class="o">+</span> <span class="n">init_value</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">actual_result</span> <span class="o">==</span> <span class="n">expected_result</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reduce object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array (of size 1) that will store the result of the reduction</p></li>
<li><p><strong>op</strong> – Binary operator to apply.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the data type of the initial value <code class="docutils literal notranslate"><span class="pre">h_init</span></code>.</p></li>
<li><p><strong>init</strong> – Numpy array storing initial value of the reduction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the reduction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.lower_bound">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">lower_bound</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'Operator'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.lower_bound" title="Link to this definition">#</a></dt>
<dd><p>Find the <em>first</em> position that each value in <code class="docutils literal notranslate"><span class="pre">d_values</span></code> would be inserted into
<code class="docutils literal notranslate"><span class="pre">d_data</span></code> to maintain sorted order.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="n">h_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">d_data</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_data</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_values</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>

<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">lower_bound</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_values</span><span class="p">))</span>

<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">h_data</span><span class="p">,</span> <span class="n">h_values</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>
<span class="n">got</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">got</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_data</strong> – Device array containing the sorted input range.</p></li>
<li><p><strong>d_values</strong> – Device array or iterator containing the search values.</p></li>
<li><p><strong>d_out</strong> – Device array to store the index results.</p></li>
<li><p><strong>num_items</strong> – Number of items in <code class="docutils literal notranslate"><span class="pre">d_data</span></code>.</p></li>
<li><p><strong>num_values</strong> – Number of items in <code class="docutils literal notranslate"><span class="pre">d_values</span></code>.</p></li>
<li><p><strong>comp</strong> – Optional comparison operator (default: <code class="docutils literal notranslate"><span class="pre">OpKind.LESS</span></code>).</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_lower_bound">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_lower_bound</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'Operator'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_lower_bound" title="Link to this definition">#</a></dt>
<dd><p>Create a lower_bound object that can be called to find insertion positions.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="n">h_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">d_data</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_data</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_values</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>

<span class="n">searcher</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_lower_bound</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">)</span>
<span class="n">searcher</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_values</span><span class="p">))</span>

<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">h_data</span><span class="p">,</span> <span class="n">h_values</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>
<span class="n">got</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">got</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_data</strong> – Device array containing the sorted input range.</p></li>
<li><p><strong>d_values</strong> – Device array or iterator containing the search values.</p></li>
<li><p><strong>d_out</strong> – Device array to store the index results.</p></li>
<li><p><strong>comp</strong> – Optional comparison operator (default: <code class="docutils literal notranslate"><span class="pre">OpKind.LESS</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that performs lower_bound.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#cuda.compute.algorithms.lower_bound" title="cuda.compute.algorithms.lower_bound"><code class="xref py py-func docutils literal notranslate"><span class="pre">lower_bound()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.upper_bound">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">upper_bound</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'Operator'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.upper_bound" title="Link to this definition">#</a></dt>
<dd><p>Find the <em>last</em> position that each value in <code class="docutils literal notranslate"><span class="pre">d_values</span></code> would be inserted into
<code class="docutils literal notranslate"><span class="pre">d_data</span></code> to maintain sorted order.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="n">h_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">d_data</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_data</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_values</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>

<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">upper_bound</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_values</span><span class="p">))</span>

<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">h_data</span><span class="p">,</span> <span class="n">h_values</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>
<span class="n">got</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">got</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_data</strong> – Device array containing the sorted input range.</p></li>
<li><p><strong>d_values</strong> – Device array or iterator containing the search values.</p></li>
<li><p><strong>d_out</strong> – Device array to store the index results.</p></li>
<li><p><strong>num_items</strong> – Number of items in <code class="docutils literal notranslate"><span class="pre">d_data</span></code>.</p></li>
<li><p><strong>num_values</strong> – Number of items in <code class="docutils literal notranslate"><span class="pre">d_values</span></code>.</p></li>
<li><p><strong>comp</strong> – Optional comparison operator (default: <code class="docutils literal notranslate"><span class="pre">OpKind.LESS</span></code>).</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_upper_bound">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_upper_bound</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">comp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeAliasForwardRef</span><span class="p"><span class="pre">(</span></span><span class="s"><span class="pre">'Operator'</span></span><span class="p"><span class="pre">)</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_upper_bound" title="Link to this definition">#</a></dt>
<dd><p>Create an upper_bound object that can be called to find insertion positions.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="n">h_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="n">d_data</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_data</span><span class="p">)</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_values</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_values</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>

<span class="n">searcher</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_upper_bound</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">)</span>
<span class="n">searcher</span><span class="p">(</span><span class="n">d_data</span><span class="p">,</span> <span class="n">d_values</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_values</span><span class="p">))</span>

<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">h_data</span><span class="p">,</span> <span class="n">h_values</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uintp</span><span class="p">)</span>
<span class="n">got</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">got</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_data</strong> – Device array containing the sorted input range.</p></li>
<li><p><strong>d_values</strong> – Device array or iterator containing the search values.</p></li>
<li><p><strong>d_out</strong> – Device array to store the index results.</p></li>
<li><p><strong>comp</strong> – Optional comparison operator (default: <code class="docutils literal notranslate"><span class="pre">OpKind.LESS</span></code>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that performs upper_bound.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#cuda.compute.algorithms.upper_bound" title="cuda.compute.algorithms.upper_bound"><code class="xref py py-func docutils literal notranslate"><span class="pre">upper_bound()</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.inclusive_scan">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">inclusive_scan</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.inclusive_scan" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide inclusive scan.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">inclusive_scan</span></code> is used to compute an inclusive scan (prefix sum).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Inclusive scan with custom operation (prefix sum of even values).</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="c1"># Define the binary operation for the scan.</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="k">if</span> <span class="n">b</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>


<span class="c1"># Perform the inclusive scan.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">inclusive_scan</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">add_op</span><span class="p">,</span> <span class="n">h_init</span><span class="p">,</span> <span class="n">d_input</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">expected</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Inclusive scan custom result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the scan</p></li>
<li><p><strong>op</strong> – Binary scan operator.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the data type of
the initial value <code class="docutils literal notranslate"><span class="pre">init_value</span></code>.</p></li>
<li><p><strong>init_value</strong> – Initial value for the scan</p></li>
<li><p><strong>num_items</strong> – Number of items to scan</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_inclusive_scan">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_inclusive_scan</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_inclusive_scan" title="Link to this definition">#</a></dt>
<dd><p>Computes a device-wide scan using the specified binary <code class="docutils literal notranslate"><span class="pre">op</span></code> and initial value <code class="docutils literal notranslate"><span class="pre">init</span></code>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_inclusive_scan</span></code> is used to create an inclusive scan object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Inclusive scan example demonstrating the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Create the scanner object and allocate temporary storage.</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_inclusive_scan</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the inclusive scan.</span>
<span class="n">scanner</span><span class="p">(</span><span class="n">d_temp_storage</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inclusive scan object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array that will store the result of the scan</p></li>
<li><p><strong>op</strong> – Binary scan operator.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the data type of
the initial value <code class="docutils literal notranslate"><span class="pre">init_value</span></code>.</p></li>
<li><p><strong>init_value</strong> – Numpy array, device array, or GPU struct storing initial value of the scan, or None for no initial value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the scan</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.exclusive_scan">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">exclusive_scan</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.exclusive_scan" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide exclusive scan.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">exclusive_scan</span></code> is used to compute an exclusive scan with max operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Exclusive scan using custom maximum operation.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Define the binary operation for the scan.</span>


<span class="k">def</span><span class="w"> </span><span class="nf">max_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="c1"># Perform the exclusive scan.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">exclusive_scan</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">max_op</span><span class="p">,</span> <span class="n">h_init</span><span class="p">,</span> <span class="n">d_input</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Exclusive scan max result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the scan</p></li>
<li><p><strong>op</strong> – Binary scan operator.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the data type of
the initial value <code class="docutils literal notranslate"><span class="pre">init_value</span></code>.</p></li>
<li><p><strong>init_value</strong> – Initial value for the scan</p></li>
<li><p><strong>num_items</strong> – Number of items to scan</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_exclusive_scan">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_exclusive_scan</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">init_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_exclusive_scan" title="Link to this definition">#</a></dt>
<dd><p>Computes a device-wide scan using the specified binary <code class="docutils literal notranslate"><span class="pre">op</span></code> and initial value <code class="docutils literal notranslate"><span class="pre">init</span></code>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_exclusive_scan</span></code> is used to create an exclusive scan object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Exclusive scan example demonstrating the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Create the scanner object and allocate temporary storage.</span>
<span class="n">scanner</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_exclusive_scan</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">scanner</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the exclusive scan.</span>
<span class="n">scanner</span><span class="p">(</span><span class="n">d_temp_storage</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exclusive scan object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array that will store the result of the scan</p></li>
<li><p><strong>op</strong> – Binary scan operator.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the data type of
the initial value <code class="docutils literal notranslate"><span class="pre">init_value</span></code>.</p></li>
<li><p><strong>init_value</strong> – Numpy array, device array, or GPU struct storing initial value of the scan, or None for no initial value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the scan</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.unary_transform">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">unary_transform</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.unary_transform" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide unary transform.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">op</span></code> function can reference device arrays as globals or closures - they will
be automatically captured as state arrays, enabling stateful operations like counting.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">unary_transform</span></code> is used to apply a transformation to each element of the input.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use unary_transform to apply a unary operation to each element.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_in</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>


<span class="c1"># Define the unary operation.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">op</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>


<span class="c1"># Perform the unary transform.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">unary_transform</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in</span><span class="p">))</span>

<span class="c1"># Verify the result.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">input_data</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unary transform result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When working with custom struct types, you need to provide type annotations
to help with type inference. See the binary transform struct example for reference:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example demonstrating binary_transform with custom struct types.</span>

<span class="sd">When working with struct inputs in transform operations, you need to provide</span>
<span class="sd">type annotations to help Numba infer the correct types. Unlike reduce_into</span>
<span class="sd">which can infer types from h_init, transform operations require explicit</span>
<span class="sd">annotations when using struct inputs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="n">gpu_struct</span>


<span class="nd">@gpu_struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Point2D</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_points</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point2D</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point2D</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point2D</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>


<span class="n">num_items</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">h_in1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Point2D</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">h_in2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Point2D</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">d_in1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">h_in1</span><span class="p">)</span>
<span class="n">d_in1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">h_in1</span><span class="p">)</span>

<span class="n">d_in2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">h_in2</span><span class="p">)</span>
<span class="n">d_in2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">h_in2</span><span class="p">)</span>

<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in1</span><span class="p">)</span>

<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">binary_transform</span><span class="p">(</span><span class="n">d_in1</span><span class="p">,</span> <span class="n">d_in2</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">add_points</span><span class="p">,</span> <span class="n">num_items</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Binary transform with structs completed successfully&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First result point: x=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the transformation.</p></li>
<li><p><strong>op</strong> – Unary operation to apply to each element.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">U</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the input data type and <code class="docutils literal notranslate"><span class="pre">U</span></code> is the output data type.
Can reference device arrays as globals/closures - they will be automatically captured.</p></li>
<li><p><strong>num_items</strong> – Number of items to transform.</p></li>
<li><p><strong>stream</strong> – CUDA stream to use for the operation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_unary_transform">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_unary_transform</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_unary_transform" title="Link to this definition">#</a></dt>
<dd><p>Create a unary transform object that can be called to apply a transformation
to each element of the input according to the unary operation <code class="docutils literal notranslate"><span class="pre">op</span></code>.</p>
<p>This is the object-oriented API that allows explicit control over temporary
storage allocation. For simpler usage, consider using <a class="reference internal" href="#cuda.compute.algorithms.unary_transform" title="cuda.compute.algorithms.unary_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">unary_transform()</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Unary transform examples demonstrating the object API and well-known operations.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>


<span class="c1"># Define the unary operation.</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_one_op</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>


<span class="c1"># Create the unary transform object.</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_unary_transform</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">add_one_op</span><span class="p">)</span>

<span class="c1"># Perform the unary transform.</span>
<span class="n">transformer</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">add_one_op</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">))</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unary transform object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the transformation.</p></li>
<li><p><strong>op</strong> – Unary operation to apply to each element.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">U</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the input data type and <code class="docutils literal notranslate"><span class="pre">U</span></code> is the output data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that performs the transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.binary_transform">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">binary_transform</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.binary_transform" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide binary transform.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">binary_transform</span></code> is used to apply a transformation to pairs of elements from two input sequences.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use binary_transform to perform elementwise addition.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">input1_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">input2_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_in1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">input1_data</span><span class="p">)</span>
<span class="n">d_in2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">input2_data</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in1</span><span class="p">)</span>

<span class="c1"># Perform the binary transform.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">binary_transform</span><span class="p">(</span><span class="n">d_in1</span><span class="p">,</span> <span class="n">d_in2</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in1</span><span class="p">))</span>

<span class="c1"># Verify the result.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">input1_data</span> <span class="o">+</span> <span class="n">input2_data</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Binary transform result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>When working with custom struct types, you need to provide type annotations
to help with type inference. See the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example demonstrating binary_transform with custom struct types.</span>

<span class="sd">When working with struct inputs in transform operations, you need to provide</span>
<span class="sd">type annotations to help Numba infer the correct types. Unlike reduce_into</span>
<span class="sd">which can infer types from h_init, transform operations require explicit</span>
<span class="sd">annotations when using struct inputs.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="n">gpu_struct</span>


<span class="nd">@gpu_struct</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Point2D</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
    <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>


<span class="k">def</span><span class="w"> </span><span class="nf">add_points</span><span class="p">(</span><span class="n">p1</span><span class="p">:</span> <span class="n">Point2D</span><span class="p">,</span> <span class="n">p2</span><span class="p">:</span> <span class="n">Point2D</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Point2D</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">Point2D</span><span class="p">(</span><span class="n">p1</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">p1</span><span class="o">.</span><span class="n">y</span> <span class="o">+</span> <span class="n">p2</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>


<span class="n">num_items</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">h_in1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Point2D</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">h_in2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">Point2D</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">num_items</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">d_in1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">h_in1</span><span class="p">)</span>
<span class="n">d_in1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">h_in1</span><span class="p">)</span>

<span class="n">d_in2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">h_in2</span><span class="p">)</span>
<span class="n">d_in2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">h_in2</span><span class="p">)</span>

<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in1</span><span class="p">)</span>

<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">binary_transform</span><span class="p">(</span><span class="n">d_in1</span><span class="p">,</span> <span class="n">d_in2</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">add_points</span><span class="p">,</span> <span class="n">num_items</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">h_in1</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">h_in2</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Binary transform with structs completed successfully&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First result point: x=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in1</strong> – Device array or iterator containing the first input sequence of data items.</p></li>
<li><p><strong>d_in2</strong> – Device array or iterator containing the second input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the transformation.</p></li>
<li><p><strong>op</strong> – Binary operation.
The signature is <code class="docutils literal notranslate"><span class="pre">(T1,</span> <span class="pre">T2)</span> <span class="pre">-&gt;</span> <span class="pre">U</span></code>, where <code class="docutils literal notranslate"><span class="pre">T1</span></code> and <code class="docutils literal notranslate"><span class="pre">T2</span></code> are the input data types and
<code class="docutils literal notranslate"><span class="pre">U</span></code> is the output data type.
Can reference device arrays as globals/closures - they will be automatically captured.</p></li>
<li><p><strong>num_items</strong> – Number of items to transform.</p></li>
<li><p><strong>stream</strong> – CUDA stream to use for the operation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_binary_transform">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_binary_transform</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_binary_transform" title="Link to this definition">#</a></dt>
<dd><p>Create a binary transform object that can be called to apply a transformation
to the given pair of input sequences according to the binary operation <code class="docutils literal notranslate"><span class="pre">op</span></code>.</p>
<p>This is the object-oriented API that allows explicit control over temporary
storage allocation. For simpler usage, consider using <a class="reference internal" href="#cuda.compute.algorithms.binary_transform" title="cuda.compute.algorithms.binary_transform"><code class="xref py py-func docutils literal notranslate"><span class="pre">binary_transform()</span></code></a>.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Binary transform examples demonstrating the transform object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input1</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input1</span><span class="p">)</span>
<span class="n">d_input2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input2</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input1</span><span class="p">)</span>

<span class="c1"># Create the binary transform object.</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_binary_transform</span><span class="p">(</span>
    <span class="n">d_input1</span><span class="p">,</span> <span class="n">d_input2</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span>
<span class="p">)</span>

<span class="c1"># Perform the binary transform.</span>
<span class="n">transformer</span><span class="p">(</span><span class="n">d_input1</span><span class="p">,</span> <span class="n">d_input2</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h_input1</span><span class="p">))</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Binary transform object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in1</strong> – Device array or iterator containing the first input sequence of data items.</p></li>
<li><p><strong>d_in2</strong> – Device array or iterator containing the second input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the result of the transformation.</p></li>
<li><p><strong>op</strong> – Binary operation.
The signature is <code class="docutils literal notranslate"><span class="pre">(T1,</span> <span class="pre">T2)</span> <span class="pre">-&gt;</span> <span class="pre">U</span></code>, where <code class="docutils literal notranslate"><span class="pre">T1</span></code> and <code class="docutils literal notranslate"><span class="pre">T2</span></code> are the input data types and
<code class="docutils literal notranslate"><span class="pre">U</span></code> is the output data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that performs the transformation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.histogram_even">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">histogram_even</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_histogram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_output_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">lower_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating" title="(in NumPy v2.4)"><span class="pre">floating</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.integer" title="(in NumPy v2.4)"><span class="pre">integer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">upper_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.floating" title="(in NumPy v2.4)"><span class="pre">floating</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.integer" title="(in NumPy v2.4)"><span class="pre">integer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.histogram_even" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide histogram computation with evenly-spaced bins.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">histogram_even</span></code> is used to compute a histogram with evenly-spaced bins.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Basic histogram example.</span><a class="headerlink" href="#id5" title="Link to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use histogram_even to bin a sequence of samples.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">h_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">6.1</span><span class="p">,</span> <span class="mf">999.5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
<span class="p">)</span>
<span class="n">d_samples</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_samples</span><span class="p">)</span>
<span class="n">num_levels</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">d_histogram</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">num_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">lower_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">upper_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Perform the histogram even.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">histogram_even</span><span class="p">(</span>
    <span class="n">d_samples</span><span class="p">,</span>
    <span class="n">d_histogram</span><span class="p">,</span>
    <span class="n">num_levels</span><span class="p">,</span>
    <span class="n">lower_level</span><span class="p">,</span>
    <span class="n">upper_level</span><span class="p">,</span>
    <span class="n">num_samples</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_actual_histogram</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_histogram</span><span class="p">)</span>
<span class="n">h_expected_histogram</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
    <span class="n">h_samples</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">num_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">lower_level</span><span class="p">,</span> <span class="n">upper_level</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">h_expected_histogram</span> <span class="o">=</span> <span class="n">h_expected_histogram</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">h_actual_histogram</span><span class="p">,</span> <span class="n">h_expected_histogram</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Histogram even basic result: </span><span class="si">{</span><span class="n">h_actual_histogram</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_samples</strong> – Device array or iterator containing the input sequence of data samples</p></li>
<li><p><strong>d_histogram</strong> – Device array to store the computed histogram</p></li>
<li><p><strong>num_output_levels</strong> – Number of histogram bin levels (num_bins = num_output_levels - 1)</p></li>
<li><p><strong>lower_level</strong> – Lower sample value bound (inclusive)</p></li>
<li><p><strong>upper_level</strong> – Upper sample value bound (exclusive)</p></li>
<li><p><strong>num_samples</strong> – Number of input samples</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_histogram_even">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_histogram_even</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_histogram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_num_output_levels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_lower_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_upper_level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_histogram_even" title="Link to this definition">#</a></dt>
<dd><p>Implements a device-wide histogram that places <code class="docutils literal notranslate"><span class="pre">d_samples</span></code> into evenly-spaced bins.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_histogram_even</span></code> is used to create a histogram object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use histogram object API to bin a sequence of samples.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.7</span><span class="p">,</span> <span class="mf">6.2</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mf">6.4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
<span class="p">)</span>
<span class="n">d_samples</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_samples</span><span class="p">)</span>

<span class="n">num_levels</span> <span class="o">=</span> <span class="mi">6</span>

<span class="c1"># note that the object API requires passing numpy arrays</span>
<span class="c1"># rather than scalars:</span>
<span class="n">h_num_output_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">num_levels</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_lower_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_upper_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">d_histogram</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_levels</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="c1"># Create the histogram object.</span>
<span class="n">histogrammer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_histogram_even</span><span class="p">(</span>
    <span class="n">d_samples</span><span class="p">,</span>
    <span class="n">d_histogram</span><span class="p">,</span>
    <span class="n">h_num_output_levels</span><span class="p">,</span>
    <span class="n">h_lower_level</span><span class="p">,</span>
    <span class="n">h_upper_level</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_samples</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">histogrammer</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_samples</span><span class="p">,</span>
    <span class="n">d_histogram</span><span class="p">,</span>
    <span class="n">h_num_output_levels</span><span class="p">,</span>
    <span class="n">h_lower_level</span><span class="p">,</span>
    <span class="n">h_upper_level</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_samples</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Allocate the temporary storage.</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the histogram.</span>
<span class="n">histogrammer</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_samples</span><span class="p">,</span>
    <span class="n">d_histogram</span><span class="p">,</span>
    <span class="n">h_num_output_levels</span><span class="p">,</span>
    <span class="n">h_lower_level</span><span class="p">,</span>
    <span class="n">h_upper_level</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_samples</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_result</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_histogram</span><span class="p">)</span>
<span class="n">expected_histogram</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">h_result</span><span class="p">,</span> <span class="n">expected_histogram</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Histogram object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_samples</strong> – Device array or iterator containing the input samples to be histogrammed</p></li>
<li><p><strong>d_histogram</strong> – Device array to store the histogram</p></li>
<li><p><strong>h_num_output_levels</strong> – Host array containing the number of output levels</p></li>
<li><p><strong>h_lower_level</strong> – Host array containing the lower level</p></li>
<li><p><strong>h_upper_level</strong> – Host array containing the upper level</p></li>
<li><p><strong>num_samples</strong> – Number of samples to be histogrammed</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the histogram</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.merge_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">merge_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.merge_sort" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide merge sort.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">merge_sort</span></code> is used to sort a sequence of keys inplace. It also rearranges the items according to the keys’ order.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Demonstrate basic merge sort with keys and values.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">8.3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
<span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)</span>

<span class="c1"># Perform the merge sort.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">merge_sort</span><span class="p">(</span>
    <span class="n">d_in_keys</span><span class="p">,</span>
    <span class="n">d_in_values</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="p">,</span>
    <span class="n">d_in_values</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">LESS</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">h_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_in_values</span><span class="p">)</span>

<span class="n">argsort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">,</span> <span class="n">stable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Merge sort basic result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or iterator containing the input sequence of keys</p></li>
<li><p><strong>d_in_items</strong> – Device array or iterator containing the input sequence of items (optional)</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys</p></li>
<li><p><strong>d_out_items</strong> – Device array to store the sorted items (optional)</p></li>
<li><p><strong>op</strong> – The comparison operator for sorting. The signature is  <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">int8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.</p></li>
<li><p><strong>num_items</strong> – Number of items to sort</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_merge_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_merge_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_merge_sort" title="Link to this definition">#</a></dt>
<dd><p>Implements a device-wide merge sort using <code class="docutils literal notranslate"><span class="pre">d_in_keys</span></code> and the comparison operator <code class="docutils literal notranslate"><span class="pre">op</span></code>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_merge_sort</span></code> is used to create a merge sort object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Merge sort example demonstrating the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">)</span>
<span class="n">d_input_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_values</span><span class="p">)</span>
<span class="n">d_output_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_keys</span><span class="p">)</span>
<span class="n">d_output_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_values</span><span class="p">)</span>

<span class="c1"># Create the merge sort object.</span>
<span class="n">sorter</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_merge_sort</span><span class="p">(</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">LESS</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">sorter</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">LESS</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Allocate the temporary storage.</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the merge sort.</span>
<span class="n">sorter</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">LESS</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_keys</span> <span class="o">=</span> <span class="n">d_output_keys</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">actual_values</span> <span class="o">=</span> <span class="n">d_output_values</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Merge sort object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or iterator containing the input keys to be sorted</p></li>
<li><p><strong>d_in_items</strong> – Optional device array or iterator that contains each key’s corresponding item</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys</p></li>
<li><p><strong>d_out_items</strong> – Device array to store the sorted items</p></li>
<li><p><strong>op</strong> – The comparison operator for sorting. The signature is  <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">int8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the merge sort</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.radix_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">radix_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.algorithms.SortOrder" title="cuda.compute.algorithms._sort._sort_common.SortOrder"><span class="pre">SortOrder</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">begin_bit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">end_bit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.radix_sort" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide radix sort.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">radix_sort</span></code> is used to sort a sequence of keys. It also rearranges the values according to the keys’ order.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use radix_sort to sort keys and values.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SortOrder</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">8.3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
<span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)</span>

<span class="c1"># Prepare the output arrays.</span>
<span class="n">d_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">d_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_values</span><span class="p">)</span>

<span class="c1"># Perform the radix sort.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">radix_sort</span><span class="p">(</span>
    <span class="n">d_in_keys</span><span class="p">,</span>
    <span class="n">d_out_keys</span><span class="p">,</span>
    <span class="n">d_in_values</span><span class="p">,</span>
    <span class="n">d_out_values</span><span class="p">,</span>
    <span class="n">SortOrder</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_keys</span><span class="p">)</span>
<span class="n">h_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_values</span><span class="p">)</span>

<span class="n">argsort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">,</span> <span class="n">stable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radix sort basic result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the following example, <code class="docutils literal notranslate"><span class="pre">radix_sort</span></code> is used to sort a sequence of keys with a <a href="#id1"><span class="problematic" id="id2">``</span></a>DoubleBuffer` for reduced temporary storage.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use radix_sort with DoubleBuffer for reduced temporary storage.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">DoubleBuffer</span><span class="p">,</span>
    <span class="n">SortOrder</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">2.7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">8.3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mf">5.4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span>
<span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)</span>

<span class="n">d_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">d_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_values</span><span class="p">)</span>

<span class="c1"># Create the double buffer.</span>
<span class="n">keys_double_buffer</span> <span class="o">=</span> <span class="n">DoubleBuffer</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">,</span> <span class="n">d_out_keys</span><span class="p">)</span>
<span class="n">values_double_buffer</span> <span class="o">=</span> <span class="n">DoubleBuffer</span><span class="p">(</span><span class="n">d_in_values</span><span class="p">,</span> <span class="n">d_out_values</span><span class="p">)</span>

<span class="c1"># Perform the radix sort.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">radix_sort</span><span class="p">(</span>
    <span class="n">keys_double_buffer</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">values_double_buffer</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">SortOrder</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">keys_double_buffer</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
<span class="n">h_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">values_double_buffer</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>

<span class="n">argsort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">,</span> <span class="n">stable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">h_expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>
<span class="n">h_expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)[</span><span class="n">argsort</span><span class="p">]</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">h_expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_values</span><span class="p">,</span> <span class="n">h_expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Radix sort buffer result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or DoubleBuffer containing the input sequence of keys</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys (optional)</p></li>
<li><p><strong>d_in_values</strong> – Device array or DoubleBuffer containing the input sequence of values (optional)</p></li>
<li><p><strong>d_out_values</strong> – Device array to store the sorted values (optional)</p></li>
<li><p><strong>order</strong> – Sort order (ascending or descending)</p></li>
<li><p><strong>num_items</strong> – Number of items to sort</p></li>
<li><p><strong>begin_bit</strong> – Beginning bit position for comparison (optional)</p></li>
<li><p><strong>end_bit</strong> – Ending bit position for comparison (optional)</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_radix_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_radix_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.algorithms.SortOrder" title="cuda.compute.algorithms._sort._sort_common.SortOrder"><span class="pre">SortOrder</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_radix_sort" title="Link to this definition">#</a></dt>
<dd><p>Implements a device-wide radix sort using <code class="docutils literal notranslate"><span class="pre">d_in_keys</span></code> in the requested order.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_radix_sort</span></code> is used to create a radix sort object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use radix_sort with the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">SortOrder</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">)</span>
<span class="n">d_input_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_values</span><span class="p">)</span>
<span class="n">d_output_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_keys</span><span class="p">)</span>
<span class="n">d_output_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_values</span><span class="p">)</span>

<span class="c1"># Create the radix sort object.</span>
<span class="n">sorter</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_radix_sort</span><span class="p">(</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">SortOrder</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">sorter</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the radix sort.</span>
<span class="n">sorter</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_keys</span> <span class="o">=</span> <span class="n">d_output_keys</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">actual_values</span> <span class="o">=</span> <span class="n">d_output_values</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Radix sort object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or DoubleBuffer containing the input keys to be sorted</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys</p></li>
<li><p><strong>d_in_values</strong> – Optional Device array or DoubleBuffer containing the input keys to be sorted</p></li>
<li><p><strong>d_out_values</strong> – Device array to store the sorted values</p></li>
<li><p><strong>op</strong> – Callable representing the comparison operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the radix sort</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.segmented_reduce">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">segmented_reduce</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">start_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">end_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.segmented_reduce" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide segmented reduction.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">segmented_reduce</span></code> is used to compute the minimum value of segments in a sequence of integers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use segmented_reduce to find the minimum in each segment.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>


<span class="k">def</span><span class="w"> </span><span class="nf">min_op</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="k">else</span> <span class="n">b</span>


<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span><span class="o">.</span><span class="n">max</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">max_val</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Prepare the offsets.</span>
<span class="n">offsets</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">first_segment</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">second_segment</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">third_segment</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="c1"># Prepare the input array.</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="o">*</span><span class="n">first_segment</span><span class="p">,</span> <span class="o">*</span><span class="n">second_segment</span><span class="p">,</span> <span class="o">*</span><span class="n">third_segment</span><span class="p">],</span>
    <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the start and end offsets.</span>
<span class="n">start_o</span> <span class="o">=</span> <span class="n">offsets</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">end_o</span> <span class="o">=</span> <span class="n">offsets</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

<span class="c1"># Prepare the output array.</span>
<span class="n">n_segments</span> <span class="o">=</span> <span class="n">start_o</span><span class="o">.</span><span class="n">size</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n_segments</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Perform the segmented reduce.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">segmented_reduce</span><span class="p">(</span>
    <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">start_o</span><span class="p">,</span> <span class="n">end_o</span><span class="p">,</span> <span class="n">min_op</span><span class="p">,</span> <span class="n">h_init</span><span class="p">,</span> <span class="n">n_segments</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">d_output</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">d_output</span> <span class="o">==</span> <span class="n">expected_output</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segmented reduce basic result: </span><span class="si">{</span><span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array to store the result of the reduction for each segment</p></li>
<li><p><strong>start_offsets_in</strong> – Device array or iterator containing the sequence of beginning offsets</p></li>
<li><p><strong>end_offsets_in</strong> – Device array or iterator containing the sequence of ending offsets</p></li>
<li><p><strong>op</strong> – Binary operator to apply.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the data type of the initial value <code class="docutils literal notranslate"><span class="pre">h_init</span></code>.</p></li>
<li><p><strong>h_init</strong> – Initial value for the reduction</p></li>
<li><p><strong>num_segments</strong> – Number of segments to reduce</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_segmented_reduce">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_segmented_reduce</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">start_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">end_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">h_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.GpuStruct" title="cuda.compute.typing.GpuStruct"><span class="pre">GpuStruct</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_segmented_reduce" title="Link to this definition">#</a></dt>
<dd><p>Computes a device-wide segmented reduction using the specified binary <code class="docutils literal notranslate"><span class="pre">op</span></code> and initial value <code class="docutils literal notranslate"><span class="pre">init</span></code>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_segmented_reduce</span></code> is used to create a segmented reduction object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Segmented reduction using the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="n">start_offsets</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">end_offsets</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="c1"># Create the segmented reduce object.</span>
<span class="n">reducer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_segmented_reduce</span><span class="p">(</span>
    <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">h_init</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span> <span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">,</span> <span class="n">h_init</span>
<span class="p">)</span>

<span class="c1"># Allocate the temporary storage.</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the segmented reduce.</span>
<span class="n">reducer</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_output</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">,</span>
    <span class="n">start_offsets</span><span class="p">,</span>
    <span class="n">end_offsets</span><span class="p">,</span>
    <span class="n">h_init</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_result</span><span class="p">,</span> <span class="n">expected_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Segmented reduce object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_out</strong> – Device array that will store the result of the reduction</p></li>
<li><p><strong>start_offsets_in</strong> – Device array or iterator containing offsets to start of segments</p></li>
<li><p><strong>end_offsets_in</strong> – Device array or iterator containing offsets to end of segments</p></li>
<li><p><strong>op</strong> – Binary operator to apply.
The signature is <code class="docutils literal notranslate"><span class="pre">(T,</span> <span class="pre">T)</span> <span class="pre">-&gt;</span> <span class="pre">T</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is
the data type of the initial value <code class="docutils literal notranslate"><span class="pre">h_init</span></code>.</p></li>
<li><p><strong>init</strong> – Numpy array storing initial value of the reduction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the reduction</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.unique_by_key">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">unique_by_key</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_num_selected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.unique_by_key" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide unique by key operation using the single-phase API.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">unique_by_key</span></code> is used to populate the arrays of output keys and items with the first key and its corresponding item from each sequence of equal keys. It also outputs the number of items selected.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use unique_by_key to remove all</span>
<span class="sd">but the first value for each group of consecutive keys.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;float32&quot;</span><span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_values</span><span class="p">)</span>
<span class="n">d_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">d_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_values</span><span class="p">)</span>
<span class="n">d_out_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Perform the unique by key operation.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">unique_by_key</span><span class="p">(</span>
    <span class="n">d_in_keys</span><span class="p">,</span>
    <span class="n">d_in_values</span><span class="p">,</span>
    <span class="n">d_out_keys</span><span class="p">,</span>
    <span class="n">d_out_values</span><span class="p">,</span>
    <span class="n">d_out_num_selected</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">EQUAL_TO</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_num_selected</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_keys</span><span class="p">)[:</span><span class="n">num_selected</span><span class="p">]</span>
<span class="n">h_out_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_values</span><span class="p">)[:</span><span class="n">num_selected</span><span class="p">]</span>

<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Unique by key basic result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_values</span><span class="si">}</span><span class="s2">, count: </span><span class="si">{</span><span class="n">num_selected</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or iterator containing the input sequence of keys</p></li>
<li><p><strong>d_in_items</strong> – Device array or iterator that contains each key’s corresponding item</p></li>
<li><p><strong>d_out_keys</strong> – Device array or iterator to store the outputted keys</p></li>
<li><p><strong>d_out_items</strong> – Device array or iterator to store each outputted key’s item</p></li>
<li><p><strong>d_out_num_selected</strong> – Device array to store how many items were selected</p></li>
<li><p><strong>op</strong> – Callable or OpKind representing the equality operator</p></li>
<li><p><strong>num_items</strong> – Number of items to process</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_unique_by_key">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_unique_by_key</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_num_selected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_unique_by_key" title="Link to this definition">#</a></dt>
<dd><p>Implements a device-wide unique by key operation using <code class="docutils literal notranslate"><span class="pre">d_in_keys</span></code> and the comparison operator <code class="docutils literal notranslate"><span class="pre">op</span></code>. Only the first key and its value from each run is selected and the total number of items selected is also reported.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_unique_by_key</span></code> is used to create a unique by key object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use unique_by_key with the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Unique by key example demonstrating the object API</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">)</span>
<span class="n">d_input_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_values</span><span class="p">)</span>
<span class="n">d_output_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_keys</span><span class="p">)</span>
<span class="n">d_output_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_values</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Create the unique by key object.</span>
<span class="n">uniquer</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_unique_by_key</span><span class="p">(</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">EQUAL_TO</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">uniquer</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">EQUAL_TO</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Allocate the temporary storage.</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the unique by key operation.</span>
<span class="n">uniquer</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_input_values</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_output_values</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">EQUAL_TO</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">num_selected</span> <span class="o">=</span> <span class="n">d_num_selected</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">actual_keys</span> <span class="o">=</span> <span class="n">d_output_keys</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected</span><span class="p">]</span>
<span class="n">actual_values</span> <span class="o">=</span> <span class="n">d_output_values</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Unique by key object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or iterator containing the input sequence of keys</p></li>
<li><p><strong>d_in_items</strong> – Device array or iterator that contains each key’s corresponding item</p></li>
<li><p><strong>d_out_keys</strong> – Device array or iterator to store the outputted keys</p></li>
<li><p><strong>d_out_items</strong> – Device array or iterator to store each outputted key’s item</p></li>
<li><p><strong>d_out_num_selected</strong> – Device array to store how many items were selected</p></li>
<li><p><strong>op</strong> – Callable or OpKind representing the equality operator</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform unique by key</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.segmented_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">segmented_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_segments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">start_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">end_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.algorithms.SortOrder" title="cuda.compute.algorithms._sort._sort_common.SortOrder"><span class="pre">SortOrder</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.segmented_sort" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide segmented sort.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">segmented_sort</span></code> is used to perform a segmented sort. It also rearranges the values according to the keys’ order.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use segmented_sort to sort keys and values within segments.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare input keys and values, and segment offsets.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="c1"># 3 segments: [0,3), [3,5), [5,9)</span>
<span class="n">start_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">end_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_vals</span><span class="p">)</span>
<span class="n">d_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">d_out_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_vals</span><span class="p">)</span>

<span class="c1"># Perform the segmented sort (ascending within each segment).</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">segmented_sort</span><span class="p">(</span>
    <span class="n">d_in_keys</span><span class="p">,</span>
    <span class="n">d_out_keys</span><span class="p">,</span>
    <span class="n">d_in_vals</span><span class="p">,</span>
    <span class="n">d_out_vals</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">start_offsets</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">),</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_offsets</span><span class="p">),</span>
    <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">SortOrder</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_keys</span><span class="p">)</span>
<span class="n">h_out_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">d_out_vals</span><span class="p">)</span>

<span class="n">expected_pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">):</span>
    <span class="n">seg_pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">],</span> <span class="n">h_in_vals</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">]),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">expected_pairs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">seg_pairs</span><span class="p">)</span>

<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h_in_keys</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h_in_vals</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_vals</span><span class="p">,</span> <span class="n">expected_vals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segmented sort basic result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_vals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In the following example, <code class="docutils literal notranslate"><span class="pre">segmented_sort</span></code> is used to perform a segmented sort with a <a href="#id3"><span class="problematic" id="id4">``</span></a>DoubleBuffer` for reduced temporary storage.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use segmented_sort with DoubleBuffer for reduced temporary storage.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare input keys and values, and segment offsets.</span>
<span class="n">h_in_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>
<span class="n">h_in_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;int32&quot;</span><span class="p">)</span>

<span class="c1"># 3 segments: [0,3), [3,5), [5,9)</span>
<span class="n">start_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">end_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">d_in_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">)</span>
<span class="n">d_in_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_in_vals</span><span class="p">)</span>
<span class="n">d_tmp_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">)</span>
<span class="n">d_tmp_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in_vals</span><span class="p">)</span>

<span class="c1"># Create double buffers for keys and values.</span>
<span class="n">keys_db</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">DoubleBuffer</span><span class="p">(</span><span class="n">d_in_keys</span><span class="p">,</span> <span class="n">d_tmp_keys</span><span class="p">)</span>
<span class="n">vals_db</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">DoubleBuffer</span><span class="p">(</span><span class="n">d_in_vals</span><span class="p">,</span> <span class="n">d_tmp_vals</span><span class="p">)</span>

<span class="c1"># Perform the segmented sort (descending within each segment).</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">segmented_sort</span><span class="p">(</span>
    <span class="n">keys_db</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">vals_db</span><span class="p">,</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_in_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">start_offsets</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">),</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_offsets</span><span class="p">),</span>
    <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">SortOrder</span><span class="o">.</span><span class="n">DESCENDING</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">h_out_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">keys_db</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>
<span class="n">h_out_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(</span><span class="n">vals_db</span><span class="o">.</span><span class="n">current</span><span class="p">())</span>

<span class="n">expected_pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">):</span>
    <span class="n">seg_pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">h_in_keys</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">],</span> <span class="n">h_in_vals</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">]),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="n">expected_pairs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">seg_pairs</span><span class="p">)</span>

<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h_in_keys</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">h_in_vals</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">h_out_vals</span><span class="p">,</span> <span class="n">expected_vals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segmented sort buffer result - keys: </span><span class="si">{</span><span class="n">h_out_keys</span><span class="si">}</span><span class="s2">, values: </span><span class="si">{</span><span class="n">h_out_vals</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or DoubleBuffer containing the input keys to be sorted</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys (optional)</p></li>
<li><p><strong>d_in_values</strong> – Device array or DoubleBuffer containing the input values to be sorted (optional)</p></li>
<li><p><strong>d_out_values</strong> – Device array to store the sorted values (optional)</p></li>
<li><p><strong>num_items</strong> – Total number of items to sort</p></li>
<li><p><strong>num_segments</strong> – Number of segments to sort</p></li>
<li><p><strong>start_offsets_in</strong> – Device array or iterator containing the sequence of beginning offsets</p></li>
<li><p><strong>end_offsets_in</strong> – Device array or iterator containing the sequence of ending offsets</p></li>
<li><p><strong>order</strong> – Sort order (ascending or descending)</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_segmented_sort">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_segmented_sort</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.algorithms.DoubleBuffer" title="cuda.compute.algorithms._sort._sort_common.DoubleBuffer"><span class="pre">DoubleBuffer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">start_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">end_offsets_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.algorithms.SortOrder" title="cuda.compute.algorithms._sort._sort_common.SortOrder"><span class="pre">SortOrder</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_segmented_sort" title="Link to this definition">#</a></dt>
<dd><p>Performs a device-wide segmented sort using the specified keys and values.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_segmented_sort</span></code> is used to create a segmented sort object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use segmented_sort with the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and segment offsets.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">h_input_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">start_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">end_offsets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">d_input_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">)</span>
<span class="n">d_input_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input_vals</span><span class="p">)</span>
<span class="n">d_output_keys</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_keys</span><span class="p">)</span>
<span class="n">d_output_vals</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input_vals</span><span class="p">)</span>

<span class="c1"># Create the segmented sort object.</span>
<span class="n">sorter</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_segmented_sort</span><span class="p">(</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_vals</span><span class="p">,</span>
    <span class="n">d_output_vals</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">),</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_offsets</span><span class="p">),</span>
    <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">SortOrder</span><span class="o">.</span><span class="n">ASCENDING</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">sorter</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_vals</span><span class="p">,</span>
    <span class="n">d_output_vals</span><span class="p">,</span>
    <span class="n">h_input_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">start_offsets</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">),</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_offsets</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the segmented sort.</span>
<span class="n">sorter</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input_keys</span><span class="p">,</span>
    <span class="n">d_output_keys</span><span class="p">,</span>
    <span class="n">d_input_vals</span><span class="p">,</span>
    <span class="n">d_output_vals</span><span class="p">,</span>
    <span class="n">h_input_keys</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">start_offsets</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">),</span>
    <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">end_offsets</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start_offsets</span><span class="p">,</span> <span class="n">end_offsets</span><span class="p">):</span>
    <span class="n">seg_pairs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">h_input_keys</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">],</span> <span class="n">h_input_vals</span><span class="p">[</span><span class="n">s</span><span class="p">:</span><span class="n">e</span><span class="p">]),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">kv</span><span class="p">:</span> <span class="n">kv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">expected_pairs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">seg_pairs</span><span class="p">)</span>

<span class="n">expected_keys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">v</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">expected_pairs</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="n">actual_keys</span> <span class="o">=</span> <span class="n">d_output_keys</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">actual_values</span> <span class="o">=</span> <span class="n">d_output_vals</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_keys</span><span class="p">,</span> <span class="n">expected_keys</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_values</span><span class="p">,</span> <span class="n">expected_values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Segmented sort object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in_keys</strong> – Device array or DoubleBuffer containing the input keys to be sorted</p></li>
<li><p><strong>d_out_keys</strong> – Device array to store the sorted keys</p></li>
<li><p><strong>d_in_values</strong> – Optional Device array or DoubleBuffer containing the input values to be sorted</p></li>
<li><p><strong>d_out_values</strong> – Device array to store the sorted values</p></li>
<li><p><strong>start_offsets_in</strong> – Device array or iterator containing the sequence of beginning offsets</p></li>
<li><p><strong>end_offsets_in</strong> – Device array or iterator containing the sequence of ending offsets</p></li>
<li><p><strong>order</strong> – SortOrder specifying the order of the sort</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the segmented sort</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.three_way_partition">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">three_way_partition</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_first_part_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_second_part_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_unselected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_num_selected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">select_first_part_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">select_second_part_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.three_way_partition" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide three-way partition. Given an input sequence of data items, it partitions the items into three parts:
- The first part is selected by the <code class="docutils literal notranslate"><span class="pre">select_first_part_op</span></code> operator.
- The second part is selected by the <code class="docutils literal notranslate"><span class="pre">select_second_part_op</span></code> operator.
- The unselected items are not selected by either operator.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">three_way_partition</span></code> is used to partition a sequence of integers into three parts.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use three_way_partition to partition a sequence of integers into three parts.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_first_part</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_second_part</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_unselected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">less_than_op</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">greater_than_equal_op</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">8</span>


<span class="c1"># Perform the three_way_partition.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">three_way_partition</span><span class="p">(</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_first_part</span><span class="p">,</span>
    <span class="n">d_second_part</span><span class="p">,</span>
    <span class="n">d_unselected</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">less_than_op</span><span class="p">,</span>
    <span class="n">greater_than_equal_op</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_first_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_second_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_unselected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_num_selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">actual_num_selected</span> <span class="o">=</span> <span class="n">d_num_selected</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">num_selected_first_part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">num_selected_second_part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">actual_first_part</span> <span class="o">=</span> <span class="n">d_first_part</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected_first_part</span><span class="p">]</span>
<span class="n">actual_second_part</span> <span class="o">=</span> <span class="n">d_second_part</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected_second_part</span><span class="p">]</span>
<span class="n">actual_unselected</span> <span class="o">=</span> <span class="n">d_unselected</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span>
    <span class="p">:</span> <span class="n">d_input</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">num_selected_first_part</span> <span class="o">-</span> <span class="n">num_selected_second_part</span>
<span class="p">]</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_first_part</span><span class="p">,</span> <span class="n">expected_first_part</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_second_part</span><span class="p">,</span> <span class="n">expected_second_part</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_unselected</span><span class="p">,</span> <span class="n">expected_unselected</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">,</span> <span class="n">expected_num_selected</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Three way partition basic example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_first_part_out</strong> – Device array or iterator to store the first part of the output</p></li>
<li><p><strong>d_second_part_out</strong> – Device array or iterator to store the second part of the output</p></li>
<li><p><strong>d_unselected_out</strong> – Device array or iterator to store the unselected items</p></li>
<li><p><strong>d_num_selected_out</strong> – Device array to store the number of items selected. The total number of items selected by <code class="docutils literal notranslate"><span class="pre">select_first_part_op</span></code> and <code class="docutils literal notranslate"><span class="pre">select_second_part_op</span></code> is stored in <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[1]</span></code>, respectively.</p></li>
<li><p><strong>select_first_part_op</strong> – Unary operator to select the first part.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).</p></li>
<li><p><strong>select_second_part_op</strong> – Unary operator to select the second part.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).</p></li>
<li><p><strong>num_items</strong> – Number of items to partition</p></li>
<li><p><strong>stream</strong> – CUDA stream for the operation (optional)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_three_way_partition">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_three_way_partition</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_first_part_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_second_part_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_unselected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_num_selected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">select_first_part_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">select_second_part_op</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_three_way_partition" title="Link to this definition">#</a></dt>
<dd><p>Computes a device-wide three-way partition using the specified unary <code class="docutils literal notranslate"><span class="pre">select_first_part_op</span></code> and <code class="docutils literal notranslate"><span class="pre">select_second_part_op</span></code> operators.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_three_way_partition</span></code> is used to create a three-way partition object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use three_way_partition with the object API.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_first_part</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_second_part</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_unselected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">less_than_op</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">8</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span>


<span class="k">def</span><span class="w"> </span><span class="nf">greater_than_equal_op</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">8</span>


<span class="c1"># Create the three_way_partition object.</span>
<span class="n">partitioner</span> <span class="o">=</span> <span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">make_three_way_partition</span><span class="p">(</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_first_part</span><span class="p">,</span>
    <span class="n">d_second_part</span><span class="p">,</span>
    <span class="n">d_unselected</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">less_than_op</span><span class="p">,</span>
    <span class="n">greater_than_equal_op</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Get the temporary storage size.</span>
<span class="n">temp_storage_size</span> <span class="o">=</span> <span class="n">partitioner</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_first_part</span><span class="p">,</span>
    <span class="n">d_second_part</span><span class="p">,</span>
    <span class="n">d_unselected</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">less_than_op</span><span class="p">,</span>
    <span class="n">greater_than_equal_op</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Perform the three_way_partition.</span>
<span class="n">partitioner</span><span class="p">(</span>
    <span class="n">d_temp_storage</span><span class="p">,</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_first_part</span><span class="p">,</span>
    <span class="n">d_second_part</span><span class="p">,</span>
    <span class="n">d_unselected</span><span class="p">,</span>
    <span class="n">d_num_selected</span><span class="p">,</span>
    <span class="n">less_than_op</span><span class="p">,</span>
    <span class="n">greater_than_equal_op</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">h_input</span><span class="p">),</span>
<span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_first_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_second_part</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_unselected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">expected_num_selected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

<span class="n">actual_num_selected</span> <span class="o">=</span> <span class="n">d_num_selected</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="n">num_selected_first_part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">num_selected_second_part</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">actual_first_part</span> <span class="o">=</span> <span class="n">d_first_part</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected_first_part</span><span class="p">]</span>
<span class="n">actual_second_part</span> <span class="o">=</span> <span class="n">d_second_part</span><span class="o">.</span><span class="n">get</span><span class="p">()[:</span><span class="n">num_selected_second_part</span><span class="p">]</span>
<span class="n">actual_unselected</span> <span class="o">=</span> <span class="n">d_unselected</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span>
    <span class="p">:</span> <span class="n">d_input</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">num_selected_first_part</span> <span class="o">-</span> <span class="n">num_selected_second_part</span>
<span class="p">]</span>

<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_first_part</span><span class="p">,</span> <span class="n">expected_first_part</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_second_part</span><span class="p">,</span> <span class="n">expected_second_part</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_unselected</span><span class="p">,</span> <span class="n">expected_unselected</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">actual_num_selected</span><span class="p">,</span> <span class="n">expected_num_selected</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Three way partition object example completed successfully&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items</p></li>
<li><p><strong>d_first_part_out</strong> – Device array or iterator to store the first part of the output</p></li>
<li><p><strong>d_second_part_out</strong> – Device array or iterator to store the second part of the output</p></li>
<li><p><strong>d_unselected_out</strong> – Device array or iterator to store the unselected items</p></li>
<li><p><strong>d_num_selected_out</strong> – Device array to store the number of items selected. The total number of items selected by <code class="docutils literal notranslate"><span class="pre">select_first_part_op</span></code> and <code class="docutils literal notranslate"><span class="pre">select_second_part_op</span></code> is stored in <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[1]</span></code>, respectively.</p></li>
<li><p><strong>select_first_part_op</strong> – Unary operator to select the first part.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).
Can reference device arrays as globals/closures - they will be automatically captured.</p></li>
<li><p><strong>select_second_part_op</strong> – Unary operator to select the second part.
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).
Can reference device arrays as globals/closures - they will be automatically captured.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that can be used to perform the three-way partition</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.select">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_num_selected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">stream</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.select" title="Link to this definition">#</a></dt>
<dd><p>Performs device-wide selection of elements based on a condition.</p>
<p>Given an input sequence, this function selects all elements for which the condition
function <code class="docutils literal notranslate"><span class="pre">cond</span></code> returns true (non-zero) and writes them to the output in a
compacted form. The number of selected elements is written to <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[0]</span></code>.</p>
<p>This function automatically handles temporary storage allocation and execution.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cond</span></code> function can reference device arrays as globals or closures - they will
be automatically captured as state arrays, enabling stateful operations like counting.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">select</span></code> is used to select even numbers from an input array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">select</span>

<span class="c1"># Create input data</span>
<span class="n">d_in</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>


<span class="c1"># Define select condition (keep even numbers)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">is_even</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>


<span class="c1"># Execute select</span>
<span class="n">select</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">d_num_selected</span><span class="p">,</span> <span class="n">is_even</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in</span><span class="p">))</span>

<span class="c1"># Get results</span>
<span class="n">num_selected</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_num_selected</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="p">[:</span><span class="n">num_selected</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="n">num_selected</span><span class="si">}</span><span class="s2"> items: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Output: Selected 4 items: [2 4 6 8]</span>
<span class="c1"># example-end</span>

<span class="k">assert</span> <span class="n">num_selected</span> <span class="o">==</span> <span class="mi">4</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<p>You can also use iterators for more complex selection patterns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">select</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute.iterators</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransformIterator</span>

<span class="c1"># Create input data</span>
<span class="n">d_in</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>


<span class="c1"># Create iterator that squares each value</span>
<span class="k">def</span><span class="w"> </span><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>


<span class="n">squared_iter</span> <span class="o">=</span> <span class="n">TransformIterator</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">square</span><span class="p">)</span>


<span class="c1"># Select squared values that are greater than 20</span>
<span class="k">def</span><span class="w"> </span><span class="nf">greater_than_20</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">20</span>


<span class="n">select</span><span class="p">(</span><span class="n">squared_iter</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">d_num_selected</span><span class="p">,</span> <span class="n">greater_than_20</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in</span><span class="p">))</span>

<span class="c1"># Get results</span>
<span class="n">num_selected</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_num_selected</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="p">[:</span><span class="n">num_selected</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="n">num_selected</span><span class="si">}</span><span class="s2"> items: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Output: Selected 4 items: [25 36 49 64]</span>
<span class="c1"># (5^2=25, 6^2=36, 7^2=49, 8^2=64, all &gt; 20)</span>
<span class="c1"># example-end</span>

<span class="k">assert</span> <span class="n">num_selected</span> <span class="o">==</span> <span class="mi">4</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the selected output items.</p></li>
<li><p><strong>d_num_selected_out</strong> – Device array to store the number of items that passed the selection.
The count is stored in <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[0]</span></code>.</p></li>
<li><p><strong>cond</strong> – Selection condition (predicate).
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).
Can reference device arrays as globals/closures - they will be automatically captured.</p></li>
<li><p><strong>num_items</strong> – Number of items in the input sequence.</p></li>
<li><p><strong>stream</strong> – CUDA stream to use for the operation (optional).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.algorithms.make_select">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">make_select</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="#cuda.compute.typing.IteratorT" title="cuda.compute.typing.IteratorT"><span class="pre">IteratorT</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_num_selected_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cond</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.Operator" title="cuda.compute.typing.Operator"><span class="pre">Operator</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.make_select" title="Link to this definition">#</a></dt>
<dd><p>Create a select object that can be called to select elements matching a condition.</p>
<p>This is the object-oriented API that allows explicit control over temporary
storage allocation. For simpler usage, consider using <a class="reference internal" href="#cuda.compute.algorithms.select" title="cuda.compute.algorithms.select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a>.</p>
<p class="rubric">Example</p>
<p>Below, <code class="docutils literal notranslate"><span class="pre">make_select</span></code> is used to create a select object that can be reused.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute.algorithms</span><span class="w"> </span><span class="kn">import</span> <span class="n">make_select</span>

<span class="c1"># Create input data</span>
<span class="n">d_in</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_out</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>
<span class="n">d_num_selected</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>


<span class="c1"># Define select condition (keep values &gt; 5)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">greater_than_5</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">5</span>


<span class="c1"># Create select object (can be reused)</span>
<span class="n">selector</span> <span class="o">=</span> <span class="n">make_select</span><span class="p">(</span><span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">d_num_selected</span><span class="p">,</span> <span class="n">greater_than_5</span><span class="p">)</span>

<span class="c1"># Get required temp storage</span>
<span class="n">temp_storage_bytes</span> <span class="o">=</span> <span class="n">selector</span><span class="p">(</span>
    <span class="kc">None</span><span class="p">,</span> <span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">d_num_selected</span><span class="p">,</span> <span class="n">greater_than_5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">d_temp_storage</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">temp_storage_bytes</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>

<span class="c1"># Execute select</span>
<span class="n">selector</span><span class="p">(</span><span class="n">d_temp_storage</span><span class="p">,</span> <span class="n">d_in</span><span class="p">,</span> <span class="n">d_out</span><span class="p">,</span> <span class="n">d_num_selected</span><span class="p">,</span> <span class="n">greater_than_5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in</span><span class="p">))</span>

<span class="c1"># Get results</span>
<span class="n">num_selected</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_num_selected</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_out</span><span class="p">[:</span><span class="n">num_selected</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="n">num_selected</span><span class="si">}</span><span class="s2"> items: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Output: Selected 5 items: [ 6  7  8  9 10]</span>

<span class="c1"># Reuse the same select object with different input</span>
<span class="n">d_in2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_out2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_in2</span><span class="p">)</span>
<span class="n">d_num_selected2</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">cp</span><span class="o">.</span><span class="n">uint64</span><span class="p">)</span>

<span class="n">selector</span><span class="p">(</span><span class="n">d_temp_storage</span><span class="p">,</span> <span class="n">d_in2</span><span class="p">,</span> <span class="n">d_out2</span><span class="p">,</span> <span class="n">d_num_selected2</span><span class="p">,</span> <span class="n">greater_than_5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_in2</span><span class="p">))</span>

<span class="n">num_selected2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d_num_selected2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">d_out2</span><span class="p">[:</span><span class="n">num_selected2</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second select: </span><span class="si">{</span><span class="n">num_selected2</span><span class="si">}</span><span class="s2"> items: </span><span class="si">{</span><span class="n">result2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Output: Second select: 5 items: [10 20 15  8 30]</span>
<span class="c1"># example-end</span>

<span class="k">assert</span> <span class="n">num_selected</span> <span class="o">==</span> <span class="mi">5</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">result</span> <span class="o">==</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d_in</strong> – Device array or iterator containing the input sequence of data items.</p></li>
<li><p><strong>d_out</strong> – Device array or iterator to store the selected output items.</p></li>
<li><p><strong>d_num_selected_out</strong> – Device array to store the number of items that passed the selection.
The count is stored in <code class="docutils literal notranslate"><span class="pre">d_num_selected_out[0]</span></code>.</p></li>
<li><p><strong>cond</strong> – Selection condition (predicate).
The signature is <code class="docutils literal notranslate"><span class="pre">(T)</span> <span class="pre">-&gt;</span> <span class="pre">uint8</span></code>, where <code class="docutils literal notranslate"><span class="pre">T</span></code> is the input data type.
Returns 1 (selected) or 0 (not selected).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable object that performs the selection operation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.algorithms.DoubleBuffer">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">DoubleBuffer</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_alternate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.DoubleBuffer" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.algorithms.DoubleBuffer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">d_current</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">d_alternate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><span class="pre">DeviceArrayLike</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.DoubleBuffer.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.algorithms.DoubleBuffer.current">
<span class="sig-name descname"><span class="pre">current</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.DoubleBuffer.current" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.algorithms.DoubleBuffer.alternate">
<span class="sig-name descname"><span class="pre">alternate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.DoubleBuffer.alternate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.algorithms.SortOrder">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.algorithms.</span></span><span class="sig-name descname"><span class="pre">SortOrder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.algorithms.SortOrder" title="Link to this definition">#</a></dt>
<dd><dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.algorithms.SortOrder.ASCENDING">
<span class="sig-name descname"><span class="pre">ASCENDING</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></span><a class="headerlink" href="#cuda.compute.algorithms.SortOrder.ASCENDING" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.algorithms.SortOrder.DESCENDING">
<span class="sig-name descname"><span class="pre">DESCENDING</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></span><a class="headerlink" href="#cuda.compute.algorithms.SortOrder.DESCENDING" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-cuda.compute.iterators">
<span id="iterators"></span><h2>Iterators<a class="headerlink" href="#module-cuda.compute.iterators" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.CacheModifiedInputIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">CacheModifiedInputIterator</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">modifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'stream'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'global'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'volatile'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stream'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.CacheModifiedInputIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that wraps a device pointer with cache-modified loads.</p>
<p>This iterator uses PTX cache modifiers to control how data is loaded:
- “stream”: Uses streaming loads (ld.global.cs) - hints that data will not be reused
- “global”: Uses global cache loads (ld.global.cg) - caches only at L2
- “volatile”: Uses volatile loads (ld.global.cv) - always fetches from memory</p>
<p>Supports element types of size 1, 2, 4, 8, or 16 bytes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.CacheModifiedInputIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">modifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'stream'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'global'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'volatile'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'stream'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.CacheModifiedInputIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a cache-modified input iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Device array to wrap (must support __cuda_array_interface__)</p></li>
<li><p><strong>modifier</strong> – Cache modifier - “stream”, “global”, or “volatile”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.CacheModifiedInputIterator.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.CacheModifiedInputIterator" title="cuda.compute.iterators._cache_modified.CacheModifiedInputIterator"><span class="pre">CacheModifiedInputIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.CacheModifiedInputIterator.__add__" title="Link to this definition">#</a></dt>
<dd><p>Advance the iterator by offset elements.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.CacheModifiedInputIterator.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#cuda.compute.iterators.CacheModifiedInputIterator.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.ConstantIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">ConstantIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number" title="(in NumPy v2.4)"><span class="pre">number</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ConstantIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator representing a sequence of constant values.</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1constant__iterator.html">thrust::constant_iterator</a>.</p>
<p>Every dereference returns the same constant value.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates the usage of a <code class="docutils literal notranslate"><span class="pre">ConstantIterator</span></code>
representing a sequence of constant values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use constant_iterator.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">ConstantIterator</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">constant_value</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">num_items</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Create the constant iterator.</span>
<span class="n">constant_it</span> <span class="o">=</span> <span class="n">ConstantIterator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">constant_value</span><span class="p">))</span>

<span class="c1"># Prepare the initial value for the reduction.</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Prepare the output array.</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Perform the reduction.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">constant_it</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">num_items</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="n">constant_value</span> <span class="o">*</span> <span class="n">num_items</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">d_output</span> <span class="o">==</span> <span class="n">expected_output</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Constant iterator result: </span><span class="si">{</span><span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (expected: </span><span class="si">{</span><span class="n">expected_output</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – The value of every item in the sequence</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ConstantIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number" title="(in NumPy v2.4)"><span class="pre">number</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ConstantIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a constant iterator with the given value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – The constant value (must be a numpy scalar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ConstantIterator.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.ConstantIterator" title="cuda.compute.iterators._constant.ConstantIterator"><span class="pre">ConstantIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.ConstantIterator.__add__" title="Link to this definition">#</a></dt>
<dd><p>Return a new ConstantIterator (value doesn’t change with position).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.CountingIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">CountingIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number" title="(in NumPy v2.4)"><span class="pre">number</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.CountingIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator representing a sequence of incrementing values.</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1counting__iterator.html">thrust::counting_iterator</a>.</p>
<p>The iterator starts at <cite>start</cite> and increments by 1 for each advance.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates the usage of a <code class="docutils literal notranslate"><span class="pre">CountingIterator</span></code>
representing the sequence <code class="docutils literal notranslate"><span class="pre">[10,</span> <span class="pre">11,</span> <span class="pre">12]</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use counting_iterator.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">CountingIterator</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">first_item</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">num_items</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Create the counting iterator.</span>
<span class="n">first_it</span> <span class="o">=</span> <span class="n">CountingIterator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">first_item</span><span class="p">))</span>

<span class="c1"># Prepare the initial value for the reduction.</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Prepare the output array.</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Perform the reduction.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">first_it</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">num_items</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">first_item</span><span class="p">,</span> <span class="n">first_item</span> <span class="o">+</span> <span class="n">num_items</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">d_output</span> <span class="o">==</span> <span class="n">expected_output</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Counting iterator result: </span><span class="si">{</span><span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (expected: </span><span class="si">{</span><span class="n">expected_output</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>start</strong> – The initial value of the sequence</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.CountingIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.number" title="(in NumPy v2.4)"><span class="pre">number</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.CountingIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a counting iterator starting at <cite>start</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>start</strong> – The initial value (must be a numpy scalar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.CountingIterator.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.CountingIterator" title="cuda.compute.iterators._counting.CountingIterator"><span class="pre">CountingIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.CountingIterator.__add__" title="Link to this definition">#</a></dt>
<dd><p>Return a new CountingIterator advanced by offset elements.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.DiscardIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">DiscardIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_iterator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.DiscardIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that discards all reads and writes.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.DiscardIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reference_iterator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.DiscardIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a discard iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reference_iterator</strong> – Optional iterator or device array used to infer
value_type/state_type. Defaults to a temporary byte buffer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">IteratorBase</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">state_bytes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state_alignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeDescriptor</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase" title="Link to this definition">#</a></dt>
<dd><p>Iterators represent streams of data computed on the fly.</p>
<p>See <a class="reference internal" href="#module-cuda.compute.iterators" title="cuda.compute.iterators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cuda.compute.iterators</span></code></a> for available iterators.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">state_bytes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state_alignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeDescriptor</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_bytes</strong> – bytes object representing iterator’s state</p></li>
<li><p><strong>state_alignment</strong> – Alignment of the state</p></li>
<li><p><strong>value_type</strong> – Type of dereferenced values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.state">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">cuda.compute._bindings.IteratorState</span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.state" title="Link to this definition">#</a></dt>
<dd><p>Return the iterator state for CCCL interop.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.state_alignment">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state_alignment</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.state_alignment" title="Link to this definition">#</a></dt>
<dd><p>Return the alignment of the iterator state.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.value_type">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">value_type</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">TypeDescriptor</span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.value_type" title="Link to this definition">#</a></dt>
<dd><p>Return the TypeDescriptor for dereferenced values.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.children">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">children</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#cuda.compute.iterators.IteratorBase" title="cuda.compute.iterators._base.IteratorBase"><span class="pre">IteratorBase</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.children" title="Link to this definition">#</a></dt>
<dd><p>Return child iterators for automatic dependency tracking. Override in subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.get_advance_op">
<span class="sig-name descname"><span class="pre">get_advance_op</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">cuda.compute._bindings.Op</span></span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.get_advance_op" title="Link to this definition">#</a></dt>
<dd><p>Get the cached Op for the advance operation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.get_input_deref_op">
<span class="sig-name descname"><span class="pre">get_input_deref_op</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Op</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.get_input_deref_op" title="Link to this definition">#</a></dt>
<dd><p>Get the cached Op for input dereference operation, or None if not supported.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.get_output_deref_op">
<span class="sig-name descname"><span class="pre">get_output_deref_op</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Op</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.get_output_deref_op" title="Link to this definition">#</a></dt>
<dd><p>Get the cached Op for output dereference operation, or None if not supported.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.is_input_iterator">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">is_input_iterator</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.is_input_iterator" title="Link to this definition">#</a></dt>
<dd><p>Return True if this iterator supports input dereference.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.is_output_iterator">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">is_output_iterator</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.is_output_iterator" title="Link to this definition">#</a></dt>
<dd><p>Return True if this iterator supports output dereference.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.to_cccl_iter">
<span class="sig-name descname"><span class="pre">to_cccl_iter</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">is_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">cuda.compute._bindings.Iterator</span></span></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.to_cccl_iter" title="Link to this definition">#</a></dt>
<dd><p>Convert this iterator to a CCCL Iterator for algorithm interop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>is_output</strong> – If True, use output_dereference; otherwise use input_dereference</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CCCL Iterator object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.IteratorBase.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Hashable" title="(in Python v3.14)"><span class="pre">Hashable</span></a></span><a class="headerlink" href="#cuda.compute.iterators.IteratorBase.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
<p>Note: state_bytes is intentionally excluded - iterators with the same
type structure but different runtime state should share cached reducers.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.PermutationIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">PermutationIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.PermutationIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that accesses values through an index mapping.</p>
<p>At position i, yields values[indices[i]].</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1permutation__iterator.html">thrust::permutation_iterator</a>.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates accessing values through an index mapping.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Demonstrate reduction with permutation iterator as input.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
    <span class="n">PermutationIterator</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create a permutation iterator which selects values at the given indices:</span>
<span class="n">d_values</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_indices</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>  <span class="c1"># permutation indices</span>
<span class="n">perm_it</span> <span class="o">=</span> <span class="n">PermutationIterator</span><span class="p">(</span><span class="n">d_values</span><span class="p">,</span> <span class="n">d_indices</span><span class="p">)</span>

<span class="c1"># Prepare the initial value and output for the reduction.</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Perform the reduction on the permuted values.</span>
<span class="n">num_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_indices</span><span class="p">)</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">perm_it</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="n">num_items</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result:</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="n">d_values</span><span class="p">[</span><span class="n">d_indices</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_output</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Permutation iterator result: </span><span class="si">{</span><span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (expected: </span><span class="si">{</span><span class="n">expected_output</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.PermutationIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.PermutationIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a permutation iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – Iterator or array providing the values to be permuted</p></li>
<li><p><strong>indices</strong> – Iterator or array providing the indices for permutation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.PermutationIterator.children">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">children</span></span><a class="headerlink" href="#cuda.compute.iterators.PermutationIterator.children" title="Link to this definition">#</a></dt>
<dd><p>Return child iterators for automatic dependency tracking. Override in subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.PermutationIterator.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.PermutationIterator" title="cuda.compute.iterators._permutation.PermutationIterator"><span class="pre">PermutationIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.PermutationIterator.__add__" title="Link to this definition">#</a></dt>
<dd><p>Advance the indices iterator by offset, keeping values at base.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.PermutationIterator.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#cuda.compute.iterators.PermutationIterator.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.ReverseIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">ReverseIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ReverseIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that reverses the direction of an underlying iterator.</p>
<p>Advance with positive offset moves backward in the underlying iterator.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ReverseIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ReverseIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a reverse iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>underlying</strong> – The underlying iterator or array to reverse</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.ReverseIterator.children">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">children</span></span><a class="headerlink" href="#cuda.compute.iterators.ReverseIterator.children" title="Link to this definition">#</a></dt>
<dd><p>Return child iterators for automatic dependency tracking. Override in subclasses.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.ReverseIterator.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#cuda.compute.iterators.ReverseIterator.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.ShuffleIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">ShuffleIterator</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">_current_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ShuffleIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that produces a deterministic random permutation of indices.</p>
<p>At position <code class="docutils literal notranslate"><span class="pre">i</span></code>, yields <code class="docutils literal notranslate"><span class="pre">bijection(i)</span></code> where the bijection is a random
permutation of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">num_items)</span></code> parameterized by <code class="docutils literal notranslate"><span class="pre">seed</span></code>.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates the usage of a <code class="docutils literal notranslate"><span class="pre">ShuffleIterator</span></code>
to randomly permute indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Using ShuffleIterator to obtain a random permutation of an array</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="n">PermutationIterator</span><span class="p">,</span> <span class="n">ShuffleIterator</span>

<span class="c1"># Input data and output array:</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>
<span class="n">num_items</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_input</span><span class="p">)</span>

<span class="c1"># Create a shuffle iterator that produces a random permutation of [0, num_items)</span>
<span class="n">shuffle_it</span> <span class="o">=</span> <span class="n">ShuffleIterator</span><span class="p">(</span><span class="n">num_items</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Use PermutationIterator to permute the data according to the random indices</span>
<span class="n">perm_it</span> <span class="o">=</span> <span class="n">PermutationIterator</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">shuffle_it</span><span class="p">)</span>

<span class="c1"># Use unary_transform to write values into d_output</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">unary_transform</span><span class="p">(</span><span class="n">perm_it</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="n">num_items</span><span class="p">)</span>

<span class="c1"># Verify it is a valid permutation of the input data:</span>
<span class="n">cp</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_array_equal</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">d_output</span><span class="p">),</span> <span class="n">d_input</span><span class="p">)</span>

<span class="c1"># Print the values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input data: </span><span class="si">{</span><span class="n">d_input</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shuffled data: </span><span class="si">{</span><span class="n">d_output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_items</strong> – Number of elements in the domain to permute. Must be &gt; 0.</p></li>
<li><p><strong>seed</strong> – Seed for the random permutation. Different seeds produce
different (deterministic) permutations. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ShuffleIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">num_items</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">_current_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ShuffleIterator.__init__" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_bytes</strong> – bytes object representing iterator’s state</p></li>
<li><p><strong>state_alignment</strong> – Alignment of the state</p></li>
<li><p><strong>value_type</strong> – Type of dereferenced values</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">TransformIterator</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform_op</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">is_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.TransformIterator" title="Link to this definition">#</a></dt>
<dd><p>An iterator that applies a unary function to elements as they are read from an underlying iterator.</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1transform__iterator.html">thrust::transform_iterator</a>.</p>
<p>For input iteration (default): reads from underlying, applies transform, returns result.
For output iteration: applies transform to input values, writes to underlying.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates the usage of a <code class="docutils literal notranslate"><span class="pre">TransformIterator</span></code> composed with a <code class="docutils literal notranslate"><span class="pre">CountingIterator</span></code>
to transform the input before performing a reduction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Using ``reduce_into`` with a ``TransformIterator`` to compute the</span>
<span class="sd">sum of squares of a sequence of numbers.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
    <span class="n">TransformIterator</span><span class="p">,</span>
    <span class="n">reduce_into</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Prepare the input and output arrays.</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>  <span class="c1"># Initial value for the reduction</span>

<span class="c1"># Create a TransformIterator to (lazily) apply the square</span>
<span class="n">it_input</span> <span class="o">=</span> <span class="n">TransformIterator</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">:</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Use `reduce_into` to compute the sum of the squares of the input.</span>
<span class="n">reduce_into</span><span class="p">(</span><span class="n">it_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result.</span>
<span class="n">expected_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_input</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_output</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transform iterator result: </span><span class="si">{</span><span class="n">d_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> (expected: </span><span class="si">{</span><span class="n">expected_output</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>underlying</strong> – The underlying iterator or device array</p></li>
<li><p><strong>transform_op</strong> – The unary operation to apply</p></li>
<li><p><strong>output_value_type</strong> – TypeDescriptor for the output type (optional, will be inferred if not provided)</p></li>
<li><p><strong>is_input</strong> – True for input iterator (default), False for output iterator</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform_op</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TypeDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">is_input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.TransformIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a transform iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>underlying</strong> – The underlying iterator or device array to transform</p></li>
<li><p><strong>transform_op</strong> – The unary transform operation (callable or OpKind)</p></li>
<li><p><strong>value_type</strong> – TypeDescriptor for the transformed value type.
For input iterators: inferred if None.
For output iterators: must be provided or have annotations.</p></li>
<li><p><strong>is_input</strong> – True for input iterator, False for output iterator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformIterator.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.TransformIterator" title="cuda.compute.iterators._transform.TransformIterator"><span class="pre">TransformIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.TransformIterator.advance" title="Link to this definition">#</a></dt>
<dd><p>Return a new iterator advanced by offset elements.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformIterator.children">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">children</span></span><a class="headerlink" href="#cuda.compute.iterators.TransformIterator.children" title="Link to this definition">#</a></dt>
<dd><p>Return child iterators for automatic dependency tracking. Override in subclasses.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformIterator.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#cuda.compute.iterators.TransformIterator.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformOutputIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">TransformOutputIterator</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform_op</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">output_value_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.TransformOutputIterator" title="Link to this definition">#</a></dt>
<dd><p>An iterator that applies a unary function to values before writing them to an underlying iterator.</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1transform__output__iterator.html">thrust::transform_output_iterator</a>.</p>
<p>This is a convenience subclass of TransformIterator configured for output mode.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates the usage of a <code class="docutils literal notranslate"><span class="pre">TransformOutputIterator</span></code> to transform the output
of a reduction before writing to an output array:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">TransformOutputIterator example demonstrating reduction with transform output iterator.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpKind</span><span class="p">,</span>
    <span class="n">TransformOutputIterator</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Create input and output arrays</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>


<span class="c1"># Define the transform operation to be applied</span>
<span class="c1"># to the result of the sum reduction.</span>
<span class="c1"># TransformOutputIterator requires type annotations:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mf">0.5</span>


<span class="c1"># Create transform output iterator</span>
<span class="n">d_out_it</span> <span class="o">=</span> <span class="n">TransformOutputIterator</span><span class="p">(</span><span class="n">d_output</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">)</span>


<span class="c1"># Apply a sum reduction into the transform output iterator</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span>
    <span class="n">d_input</span><span class="p">,</span>
    <span class="n">d_out_it</span><span class="p">,</span>
    <span class="n">OpKind</span><span class="o">.</span><span class="n">PLUS</span><span class="p">,</span>
    <span class="nb">len</span><span class="p">(</span><span class="n">d_input</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
<span class="p">)</span>

<span class="k">assert</span> <span class="n">cp</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">d_output</span><span class="p">,</span> <span class="n">cp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">d_input</span><span class="p">)),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>underlying</strong> – The underlying iterator or device array</p></li>
<li><p><strong>transform_op</strong> – The operation to be applied to values before they are written</p></li>
<li><p><strong>output_value_type</strong> – TypeDescriptor for the input value type (optional, will be extracted from annotations if not provided)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.TransformOutputIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">underlying</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">transform_op</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">output_value_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.TransformOutputIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a transform iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>underlying</strong> – The underlying iterator or device array to transform</p></li>
<li><p><strong>transform_op</strong> – The unary transform operation (callable or OpKind)</p></li>
<li><p><strong>value_type</strong> – TypeDescriptor for the transformed value type.
For input iterators: inferred if None.
For output iterators: must be provided or have annotations.</p></li>
<li><p><strong>is_input</strong> – True for input iterator, False for output iterator</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.iterators.ZipIterator">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.iterators.</span></span><span class="sig-name descname"><span class="pre">ZipIterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ZipIterator" title="Link to this definition">#</a></dt>
<dd><p>Iterator that zips multiple iterators together.</p>
<p>At each position, yields a tuple of values from all underlying iterators.</p>
<p>Similar to <a class="reference external" href="https://nvidia.github.io/cccl/thrust/api/classthrust_1_1zip__iterator.html">thrust::zip_iterator</a>.</p>
<p class="rubric">Example</p>
<p>The code snippet below demonstrates how to zip together an array and a
<a class="reference internal" href="#cuda.compute.iterators.CountingIterator" title="cuda.compute.iterators.CountingIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">CountingIterator</span></code></a> to
find the index of the maximum value of the array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example showing how to use zip_iterator with counting iterator to</span>
<span class="sd">find the index with maximum value in an array.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">CountingIterator</span><span class="p">,</span>
    <span class="n">ZipIterator</span><span class="p">,</span>
<span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">max_by_value</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reduction operation that returns the pair with the larger value.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">p1</span> <span class="k">if</span> <span class="n">p1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">p2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">p2</span>


<span class="c1"># Create the counting iterator.</span>
<span class="n">counting_it</span> <span class="o">=</span> <span class="n">CountingIterator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="c1"># Prepare the input array.</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Create the zip iterator.</span>
<span class="n">zip_it</span> <span class="o">=</span> <span class="n">ZipIterator</span><span class="p">(</span><span class="n">counting_it</span><span class="p">,</span> <span class="n">arr</span><span class="p">)</span>

<span class="n">num_items</span> <span class="o">=</span> <span class="mi">8</span>

<span class="c1"># Note: initial value passed as a numpy struct</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s2">&quot;index&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)],</span> <span class="n">align</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="c1"># Perform the reduction.</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">zip_it</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">max_by_value</span><span class="p">,</span> <span class="n">num_items</span><span class="p">,</span> <span class="n">h_init</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expected_index</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">expected_value</span> <span class="o">=</span> <span class="mi">7</span>

<span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;index&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_index</span>
<span class="k">assert</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="n">expected_value</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Zip iterator with counting result: index=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;(expected: </span><span class="si">{</span><span class="n">expected_index</span><span class="si">}</span><span class="s2">), value=</span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (expected: </span><span class="si">{</span><span class="n">expected_value</span><span class="si">}</span><span class="s2">)&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ZipIterator.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.iterators.ZipIterator.__init__" title="Link to this definition">#</a></dt>
<dd><p>Create a zip iterator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*args</strong> – Iterators or arrays to zip together. Can be:
- Multiple iterators/arrays: ZipIterator(it1, it2, it3)
- A single sequence of iterators: ZipIterator([it1, it2, it3])</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.ZipIterator.children">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">children</span></span><a class="headerlink" href="#cuda.compute.iterators.ZipIterator.children" title="Link to this definition">#</a></dt>
<dd><p>Return child iterators for automatic dependency tracking. Override in subclasses.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.iterators.ZipIterator.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#cuda.compute.iterators.ZipIterator" title="cuda.compute.iterators._zip.ZipIterator"><span class="pre">ZipIterator</span></a></span></span><a class="headerlink" href="#cuda.compute.iterators.ZipIterator.__add__" title="Link to this definition">#</a></dt>
<dd><p>Advance all child iterators by offset.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="cuda.compute.iterators.ZipIterator.kind">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">kind</span></span><a class="headerlink" href="#cuda.compute.iterators.ZipIterator.kind" title="Link to this definition">#</a></dt>
<dd><p>Return a hashable kind for caching purposes.</p>
</dd></dl>

</dd></dl>

</section>
<section id="operators">
<h2>Operators<a class="headerlink" href="#operators" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.op.</span></span><span class="sig-name descname"><span class="pre">OpKind</span></span><a class="headerlink" href="#cuda.compute.op.OpKind" title="Link to this definition">#</a></dt>
<dd><p>Enumeration of operator kinds for CUDA parallel algorithms.</p>
<p>This enum defines the types of operations that can be performed
in parallel algorithms, including arithmetic, logical, and bitwise operations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.PLUS">
<span class="sig-name descname"><span class="pre">PLUS</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.PLUS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.MINUS">
<span class="sig-name descname"><span class="pre">MINUS</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.MINUS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.MULTIPLIES">
<span class="sig-name descname"><span class="pre">MULTIPLIES</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.MULTIPLIES" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.DIVIDES">
<span class="sig-name descname"><span class="pre">DIVIDES</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.DIVIDES" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.MODULUS">
<span class="sig-name descname"><span class="pre">MODULUS</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.MODULUS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.EQUAL_TO">
<span class="sig-name descname"><span class="pre">EQUAL_TO</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.EQUAL_TO" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.NOT_EQUAL_TO">
<span class="sig-name descname"><span class="pre">NOT_EQUAL_TO</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.NOT_EQUAL_TO" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.GREATER">
<span class="sig-name descname"><span class="pre">GREATER</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.GREATER" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.LESS">
<span class="sig-name descname"><span class="pre">LESS</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.LESS" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.GREATER_EQUAL">
<span class="sig-name descname"><span class="pre">GREATER_EQUAL</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.GREATER_EQUAL" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.LESS_EQUAL">
<span class="sig-name descname"><span class="pre">LESS_EQUAL</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.LESS_EQUAL" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.LOGICAL_AND">
<span class="sig-name descname"><span class="pre">LOGICAL_AND</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.LOGICAL_AND" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.LOGICAL_OR">
<span class="sig-name descname"><span class="pre">LOGICAL_OR</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.LOGICAL_OR" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.LOGICAL_NOT">
<span class="sig-name descname"><span class="pre">LOGICAL_NOT</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.LOGICAL_NOT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.BIT_AND">
<span class="sig-name descname"><span class="pre">BIT_AND</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.BIT_AND" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.BIT_OR">
<span class="sig-name descname"><span class="pre">BIT_OR</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.BIT_OR" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.BIT_XOR">
<span class="sig-name descname"><span class="pre">BIT_XOR</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.BIT_XOR" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.BIT_NOT">
<span class="sig-name descname"><span class="pre">BIT_NOT</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.BIT_NOT" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.IDENTITY">
<span class="sig-name descname"><span class="pre">IDENTITY</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.IDENTITY" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.NEGATE">
<span class="sig-name descname"><span class="pre">NEGATE</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.NEGATE" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.MINIMUM">
<span class="sig-name descname"><span class="pre">MINIMUM</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.MINIMUM" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cuda.compute.op.OpKind.MAXIMUM">
<span class="sig-name descname"><span class="pre">MAXIMUM</span></span><a class="headerlink" href="#cuda.compute.op.OpKind.MAXIMUM" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.op.RawOp">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.op.</span></span><span class="sig-name descname"><span class="pre">RawOp</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ltoir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">b''</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state_alignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">extra_ltoirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.op.RawOp" title="Link to this definition">#</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">RawOp</span></code> can be used to directly pass compiled device code (LTO-IR) implementing custom operators.</p>
<p>This is useful for users who wish to implement custom operators in C++ or another language,
or wish to use a different compilation pipeline than the default
(JIT compilation from Python callables using Numba CUDA).</p>
<p class="rubric">Example</p>
<p>The example below shows how to compile C++ device code to LTOIR and use it with
<a class="reference internal" href="#cuda.compute.algorithms.reduce_into" title="cuda.compute.algorithms.reduce_into"><code class="xref py py-func docutils literal notranslate"><span class="pre">reduce_into</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Create a custom C++ operator from LTOIR bytecode using RawOp.</span>

<span class="sd">This example demonstrates how to compile C++ device code to LTOIR and use it</span>
<span class="sd">as a custom operator.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cupy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">cuda.compute</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.compute.op</span><span class="w"> </span><span class="kn">import</span> <span class="n">RawOp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cuda.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">Device</span><span class="p">,</span> <span class="n">Program</span><span class="p">,</span> <span class="n">ProgramOptions</span>


<span class="k">def</span><span class="w"> </span><span class="nf">get_arch</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the SM architecture string for the current device.&quot;&quot;&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">Device</span><span class="p">()</span>
    <span class="n">device</span><span class="o">.</span><span class="n">set_current</span><span class="p">()</span>
    <span class="n">cc_major</span><span class="p">,</span> <span class="n">cc_minor</span> <span class="o">=</span> <span class="n">device</span><span class="o">.</span><span class="n">compute_capability</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;sm_</span><span class="si">{</span><span class="n">cc_major</span><span class="si">}{</span><span class="n">cc_minor</span><span class="si">}</span><span class="s2">&quot;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">compile_cpp_to_ltoir</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arch</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compile C++ source to LTOIR using cuda.core.&quot;&quot;&quot;</span>
    <span class="n">opts</span> <span class="o">=</span> <span class="n">ProgramOptions</span><span class="p">(</span>
        <span class="n">arch</span><span class="o">=</span><span class="n">arch</span><span class="p">,</span>
        <span class="n">relocatable_device_code</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">link_time_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">prog</span> <span class="o">=</span> <span class="n">Program</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="s2">&quot;c++&quot;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">opts</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prog</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;ltoir&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">code</span>


<span class="c1"># Define a C++ custom multiply operator</span>
<span class="n">cpp_source</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">extern &quot;C&quot; __device__ void multiply_op(void* a, void* b, void* result) {</span>
<span class="s2">    *static_cast&lt;int*&gt;(result) = *static_cast&lt;int*&gt;(a) * *static_cast&lt;int*&gt;(b);</span>
<span class="s2">}</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="c1"># Compile C++ to LTOIR</span>
<span class="n">arch</span> <span class="o">=</span> <span class="n">get_arch</span><span class="p">()</span>
<span class="n">ltoir_bytes</span> <span class="o">=</span> <span class="n">compile_cpp_to_ltoir</span><span class="p">(</span><span class="n">cpp_source</span><span class="p">,</span> <span class="n">arch</span><span class="p">)</span>

<span class="c1"># Create a RawOp from the LTOIR bytecode</span>
<span class="n">multiply_op</span> <span class="o">=</span> <span class="n">RawOp</span><span class="p">(</span><span class="n">ltoir</span><span class="o">=</span><span class="n">ltoir_bytes</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;multiply_op&quot;</span><span class="p">)</span>

<span class="c1"># Prepare test data</span>
<span class="n">h_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">d_input</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>
<span class="n">d_output</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">h_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Use the custom operator with reduce_into</span>
<span class="n">cuda</span><span class="o">.</span><span class="n">compute</span><span class="o">.</span><span class="n">reduce_into</span><span class="p">(</span><span class="n">d_input</span><span class="p">,</span> <span class="n">d_output</span><span class="p">,</span> <span class="n">multiply_op</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d_input</span><span class="p">),</span> <span class="n">h_init</span><span class="p">)</span>

<span class="c1"># Verify the result</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">d_output</span><span class="o">.</span><span class="n">get</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">expected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">h_input</span><span class="p">)</span>  <span class="c1"># 1 * 2 * 3 * 4 * 5 = 120</span>
<span class="k">assert</span> <span class="n">result</span> <span class="o">==</span> <span class="n">expected</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Expected </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom multiply reduction result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RawOp stateless example completed successfully!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The ABI name of the operator</p></li>
<li><p><strong>ltoir</strong> – bytes object containing the LTO-IR of the compiled operator</p></li>
<li><p><strong>state</strong> – Optional bytes representing the operator’s state</p></li>
<li><p><strong>state_alignment</strong> – Alignment requirement for the state bytes (default: 1)</p></li>
<li><p><strong>extra_ltoirs</strong> – Optional list of additional LTO-IRs to include during linking</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>The provided LTO-IR must define a function with the specified name and the correct signature.</p></li>
<li><p>The function must use untyped pointers for all parameters and return type. The function body
is responsible for correctly interpreting the pointer arguments based on the expected input and output types.
For stateless operators, the signature is</p>
<blockquote>
<div><p>void func(void* arg1, void* arg2, …, void* result)`</p>
</div></blockquote>
<p>For stateful operators, the first parameter must be a pointer to the state:</p>
<blockquote>
<div><p>void func(void* state, void* arg1, void* arg2, …)</p>
</div></blockquote>
</li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.op.RawOp.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">ltoir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">b''</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">state_alignment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">extra_ltoirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.op.RawOp.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.op.RawOp.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">input_types</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">output_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">cuda.compute._bindings.Op</span></span></span><a class="headerlink" href="#cuda.compute.op.RawOp.compile" title="Link to this definition">#</a></dt>
<dd><p>Compile this operator to an Op for CCCL interop.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_types</strong> – Tuple of TypeDescriptors for input arguments</p></li>
<li><p><strong>output_type</strong> – Optional TypeDescriptor for return value (inferred if None)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Compiled Op object for C++ interop</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.op.RawOp.get_state">
<span class="sig-name descname"><span class="pre">get_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.14)"><span class="pre">bytes</span></a></span></span><a class="headerlink" href="#cuda.compute.op.RawOp.get_state" title="Link to this definition">#</a></dt>
<dd><p>Return the op’s state bytes.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-cuda.compute.struct">
<span id="utilities"></span><h2>Utilities<a class="headerlink" href="#module-cuda.compute.struct" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="cuda.compute.struct.gpu_struct">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.struct.</span></span><span class="sig-name descname"><span class="pre">gpu_struct</span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="n"><span class="pre">field_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.dtype.html#numpy.dtype" title="(in NumPy v2.4)"><span class="pre">dtype</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><span class="pre">type</span></a></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'AnonymousStruct'</span></span></em>,</dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.struct.gpu_struct" title="Link to this definition">#</a></dt>
<dd><p>A factory for creating struct types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>field_dict</strong> – A dictionary, numpy dtype, or annotated class providing the
mapping of field names to data types.</p></li>
<li><p><strong>name</strong> – The name of the struct type that will be returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A struct class helpful for writing operations on struct values.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-cuda.compute.typing">
<span id="typing"></span><h2>Typing<a class="headerlink" href="#module-cuda.compute.typing" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.typing.DeviceArrayLike">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.typing.</span></span><span class="sig-name descname"><span class="pre">DeviceArrayLike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.typing.DeviceArrayLike" title="Link to this definition">#</a></dt>
<dd><p>Protocol for array-like objects that expose device memory via CUDA Array Interface.</p>
<p>Any object implementing the <code class="docutils literal notranslate"><span class="pre">__cuda_array_interface__</span></code> attribute can be used
where a <a class="reference internal" href="#cuda.compute.typing.DeviceArrayLike" title="cuda.compute.typing.DeviceArrayLike"><code class="xref py py-class docutils literal notranslate"><span class="pre">DeviceArrayLike</span></code></a> is expected. This includes CuPy arrays, Numba
device arrays, PyTorch CUDA tensors, and other GPU array types.</p>
<p>See <a class="reference external" href="https://nvidia.github.io/numba-cuda/user/cuda_array_interface.html">CUDA Array Interface specification</a>
for details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cuda.compute.typing.DeviceArrayLike.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cuda.compute.typing.DeviceArrayLike.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.typing.GpuStruct">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.typing.</span></span><span class="sig-name descname"><span class="pre">GpuStruct</span></span><a class="headerlink" href="#cuda.compute.typing.GpuStruct" title="Link to this definition">#</a></dt>
<dd><p>Instance of types created with <a class="reference internal" href="#cuda.compute.struct.gpu_struct" title="cuda.compute.struct.gpu_struct"><code class="xref py py-class docutils literal notranslate"><span class="pre">cuda.compute.struct.gpu_struct</span></code></a>.</p>
<p>alias of TypeVar(‘GpuStruct’, bound=<code class="xref py py-class docutils literal notranslate"><span class="pre">_Struct</span></code>)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cuda.compute.typing.IteratorT">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">cuda.compute.typing.</span></span><span class="sig-name descname"><span class="pre">IteratorT</span></span><a class="headerlink" href="#cuda.compute.typing.IteratorT" title="Link to this definition">#</a></dt>
<dd><p>Type variable for iterator objects.</p>
<p>Represents any subclass of <a class="reference internal" href="#cuda.compute.iterators.IteratorBase" title="cuda.compute.iterators.IteratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">IteratorBase</span></code></a>.
See <a class="reference internal" href="#module-cuda.compute.iterators" title="cuda.compute.iterators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cuda.compute.iterators</span></code></a> for all available iterators.</p>
<p>alias of TypeVar(‘IteratorT’, bound=<a class="reference internal" href="#cuda.compute.iterators.IteratorBase" title="cuda.compute.iterators._base.IteratorBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">IteratorBase</span></code></a>)</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="cuda.compute.typing.Operator">
<span class="sig-prename descclassname"><span class="pre">cuda.compute.typing.</span></span><span class="sig-name descname"><span class="pre">Operator</span></span><a class="headerlink" href="#cuda.compute.typing.Operator" title="Link to this definition">#</a></dt>
<dd><p>Type alias for operator objects passed to algorithm functions.</p>
<p>Algorithms accept the following objects as operators:</p>
<ul class="simple">
<li><p>Python functions or lambdas implementing the operator. This function will be JIT
compiled into device code using <a class="reference external" href="https://nvidia.github.io/numba-cuda/">numba.cuda</a>.</p></li>
<li><p><a class="reference internal" href="#cuda.compute.op.OpKind" title="cuda.compute.op.OpKind"><code class="xref py py-class docutils literal notranslate"><span class="pre">OpKind</span></code></a> enumerators which are pre-defined constants
for common operations.</p></li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">RawOp</span> <span class="pre">&lt;cuda.compute.op.RawOp</span></code> objects containing pre-compiled device code.</p></li>
</ul>
<p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code> | <code class="xref py py-class docutils literal notranslate"><span class="pre">OpKind</span></code> | <a class="reference internal" href="#cuda.compute.op.RawOp" title="cuda.compute.op.RawOp"><code class="xref py py-class docutils literal notranslate"><span class="pre">RawOp</span></code></a> | <code class="xref py py-class docutils literal notranslate"><span class="pre">_OpAdapter</span></code></p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="api_reference.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">API Reference</p>
      </div>
    </a>
    <a class="right-next"
       href="coop_api.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code> API Reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cuda.compute.algorithms">Algorithms</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.reduce_into"><code class="docutils literal notranslate"><span class="pre">reduce_into()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_reduce_into"><code class="docutils literal notranslate"><span class="pre">make_reduce_into()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.lower_bound"><code class="docutils literal notranslate"><span class="pre">lower_bound()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_lower_bound"><code class="docutils literal notranslate"><span class="pre">make_lower_bound()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.upper_bound"><code class="docutils literal notranslate"><span class="pre">upper_bound()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_upper_bound"><code class="docutils literal notranslate"><span class="pre">make_upper_bound()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.inclusive_scan"><code class="docutils literal notranslate"><span class="pre">inclusive_scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_inclusive_scan"><code class="docutils literal notranslate"><span class="pre">make_inclusive_scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.exclusive_scan"><code class="docutils literal notranslate"><span class="pre">exclusive_scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_exclusive_scan"><code class="docutils literal notranslate"><span class="pre">make_exclusive_scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.unary_transform"><code class="docutils literal notranslate"><span class="pre">unary_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_unary_transform"><code class="docutils literal notranslate"><span class="pre">make_unary_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.binary_transform"><code class="docutils literal notranslate"><span class="pre">binary_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_binary_transform"><code class="docutils literal notranslate"><span class="pre">make_binary_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.histogram_even"><code class="docutils literal notranslate"><span class="pre">histogram_even()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_histogram_even"><code class="docutils literal notranslate"><span class="pre">make_histogram_even()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.merge_sort"><code class="docutils literal notranslate"><span class="pre">merge_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_merge_sort"><code class="docutils literal notranslate"><span class="pre">make_merge_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.radix_sort"><code class="docutils literal notranslate"><span class="pre">radix_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_radix_sort"><code class="docutils literal notranslate"><span class="pre">make_radix_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.segmented_reduce"><code class="docutils literal notranslate"><span class="pre">segmented_reduce()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_segmented_reduce"><code class="docutils literal notranslate"><span class="pre">make_segmented_reduce()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.unique_by_key"><code class="docutils literal notranslate"><span class="pre">unique_by_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_unique_by_key"><code class="docutils literal notranslate"><span class="pre">make_unique_by_key()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.segmented_sort"><code class="docutils literal notranslate"><span class="pre">segmented_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_segmented_sort"><code class="docutils literal notranslate"><span class="pre">make_segmented_sort()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.three_way_partition"><code class="docutils literal notranslate"><span class="pre">three_way_partition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_three_way_partition"><code class="docutils literal notranslate"><span class="pre">make_three_way_partition()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.select"><code class="docutils literal notranslate"><span class="pre">select()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.make_select"><code class="docutils literal notranslate"><span class="pre">make_select()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.DoubleBuffer"><code class="docutils literal notranslate"><span class="pre">DoubleBuffer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.DoubleBuffer.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.DoubleBuffer.current"><code class="docutils literal notranslate"><span class="pre">current()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.DoubleBuffer.alternate"><code class="docutils literal notranslate"><span class="pre">alternate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.SortOrder"><code class="docutils literal notranslate"><span class="pre">SortOrder</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.SortOrder.ASCENDING"><code class="docutils literal notranslate"><span class="pre">ASCENDING</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.algorithms.SortOrder.DESCENDING"><code class="docutils literal notranslate"><span class="pre">DESCENDING</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cuda.compute.iterators">Iterators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CacheModifiedInputIterator"><code class="docutils literal notranslate"><span class="pre">CacheModifiedInputIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CacheModifiedInputIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CacheModifiedInputIterator.__add__"><code class="docutils literal notranslate"><span class="pre">__add__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CacheModifiedInputIterator.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ConstantIterator"><code class="docutils literal notranslate"><span class="pre">ConstantIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ConstantIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ConstantIterator.__add__"><code class="docutils literal notranslate"><span class="pre">__add__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CountingIterator"><code class="docutils literal notranslate"><span class="pre">CountingIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CountingIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.CountingIterator.__add__"><code class="docutils literal notranslate"><span class="pre">__add__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.DiscardIterator"><code class="docutils literal notranslate"><span class="pre">DiscardIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.DiscardIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase"><code class="docutils literal notranslate"><span class="pre">IteratorBase</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.state"><code class="docutils literal notranslate"><span class="pre">state</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.state_alignment"><code class="docutils literal notranslate"><span class="pre">state_alignment</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.value_type"><code class="docutils literal notranslate"><span class="pre">value_type</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.get_advance_op"><code class="docutils literal notranslate"><span class="pre">get_advance_op()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.get_input_deref_op"><code class="docutils literal notranslate"><span class="pre">get_input_deref_op()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.get_output_deref_op"><code class="docutils literal notranslate"><span class="pre">get_output_deref_op()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.is_input_iterator"><code class="docutils literal notranslate"><span class="pre">is_input_iterator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.is_output_iterator"><code class="docutils literal notranslate"><span class="pre">is_output_iterator</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.to_cccl_iter"><code class="docutils literal notranslate"><span class="pre">to_cccl_iter()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.IteratorBase.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.PermutationIterator"><code class="docutils literal notranslate"><span class="pre">PermutationIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.PermutationIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.PermutationIterator.children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.PermutationIterator.__add__"><code class="docutils literal notranslate"><span class="pre">__add__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.PermutationIterator.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ReverseIterator"><code class="docutils literal notranslate"><span class="pre">ReverseIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ReverseIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ReverseIterator.children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ReverseIterator.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ShuffleIterator"><code class="docutils literal notranslate"><span class="pre">ShuffleIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ShuffleIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformIterator"><code class="docutils literal notranslate"><span class="pre">TransformIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformIterator.advance"><code class="docutils literal notranslate"><span class="pre">advance()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformIterator.children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformIterator.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformOutputIterator"><code class="docutils literal notranslate"><span class="pre">TransformOutputIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.TransformOutputIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ZipIterator"><code class="docutils literal notranslate"><span class="pre">ZipIterator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ZipIterator.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ZipIterator.children"><code class="docutils literal notranslate"><span class="pre">children</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ZipIterator.__add__"><code class="docutils literal notranslate"><span class="pre">__add__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.iterators.ZipIterator.kind"><code class="docutils literal notranslate"><span class="pre">kind</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#operators">Operators</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind"><code class="docutils literal notranslate"><span class="pre">OpKind</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.PLUS"><code class="docutils literal notranslate"><span class="pre">PLUS</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.MINUS"><code class="docutils literal notranslate"><span class="pre">MINUS</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.MULTIPLIES"><code class="docutils literal notranslate"><span class="pre">MULTIPLIES</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.DIVIDES"><code class="docutils literal notranslate"><span class="pre">DIVIDES</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.MODULUS"><code class="docutils literal notranslate"><span class="pre">MODULUS</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.EQUAL_TO"><code class="docutils literal notranslate"><span class="pre">EQUAL_TO</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.NOT_EQUAL_TO"><code class="docutils literal notranslate"><span class="pre">NOT_EQUAL_TO</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.GREATER"><code class="docutils literal notranslate"><span class="pre">GREATER</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.LESS"><code class="docutils literal notranslate"><span class="pre">LESS</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.GREATER_EQUAL"><code class="docutils literal notranslate"><span class="pre">GREATER_EQUAL</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.LESS_EQUAL"><code class="docutils literal notranslate"><span class="pre">LESS_EQUAL</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.LOGICAL_AND"><code class="docutils literal notranslate"><span class="pre">LOGICAL_AND</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.LOGICAL_OR"><code class="docutils literal notranslate"><span class="pre">LOGICAL_OR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.LOGICAL_NOT"><code class="docutils literal notranslate"><span class="pre">LOGICAL_NOT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.BIT_AND"><code class="docutils literal notranslate"><span class="pre">BIT_AND</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.BIT_OR"><code class="docutils literal notranslate"><span class="pre">BIT_OR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.BIT_XOR"><code class="docutils literal notranslate"><span class="pre">BIT_XOR</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.BIT_NOT"><code class="docutils literal notranslate"><span class="pre">BIT_NOT</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.IDENTITY"><code class="docutils literal notranslate"><span class="pre">IDENTITY</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.NEGATE"><code class="docutils literal notranslate"><span class="pre">NEGATE</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.MINIMUM"><code class="docutils literal notranslate"><span class="pre">MINIMUM</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.OpKind.MAXIMUM"><code class="docutils literal notranslate"><span class="pre">MAXIMUM</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.RawOp"><code class="docutils literal notranslate"><span class="pre">RawOp</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.RawOp.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.RawOp.compile"><code class="docutils literal notranslate"><span class="pre">compile()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.op.RawOp.get_state"><code class="docutils literal notranslate"><span class="pre">get_state()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cuda.compute.struct">Utilities</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.struct.gpu_struct"><code class="docutils literal notranslate"><span class="pre">gpu_struct()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-cuda.compute.typing">Typing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.typing.DeviceArrayLike"><code class="docutils literal notranslate"><span class="pre">DeviceArrayLike</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.typing.DeviceArrayLike.__init__"><code class="docutils literal notranslate"><span class="pre">__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.typing.GpuStruct"><code class="docutils literal notranslate"><span class="pre">GpuStruct</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.typing.IteratorT"><code class="docutils literal notranslate"><span class="pre">IteratorT</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cuda.compute.typing.Operator"><code class="docutils literal notranslate"><span class="pre">Operator</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2026, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>