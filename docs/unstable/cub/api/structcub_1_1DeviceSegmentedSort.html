

<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>cub::DeviceSegmentedSort &#8212; CUDA Core Compute Libraries</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/nvidia-sphinx-theme.css?v=933278ad" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />



    <script src="../../_static/documentation_options.js?v=bbe6ed3a"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=5ceeb459"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'cub/api/structcub_1_1DeviceSegmentedSort';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://NVIDIA.github.io/cccl/nv-versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'unstable';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>

    <link rel="canonical" href="https://NVIDIA.github.io/cccl/cub/api/structcub_1_1DeviceSegmentedSort.html" />
    <link rel="icon" href="../../_static/favicon.png"/>

    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="cub::DeviceSelect" href="structcub_1_1DeviceSelect.html" />
    <link rel="prev" title="cub::DeviceSegmentedScan" href="structcub_1_1DeviceSegmentedScan.html" />


  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="unstable" />


  </head>

  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>


  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        



  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/nvidia-logo-horiz-rgb-blk-for-screen.svg" class="logo__image only-light" alt="CUDA Core Compute Libraries - Home"/>
    <img src="../../_static/nvidia-logo-horiz-rgb-wht-for-screen.svg" class="logo__image only-dark pst-js-only" alt="CUDA Core Compute Libraries - Home"/>
  
  
    <p class="title logo__title">CUDA Core Compute Libraries</p>
  
</a>


  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">


<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/NVIDIA/cccl" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">



<nav class="bd-docs-nav bd-links"
     aria-label="Table of Contents">
  <p class="bd-links__title" role="heading" aria-level="1">Table of Contents</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../cpp.html">CUDA C++ Core Libraries</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../libcudacxx/index.html">libcu++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../libcudacxx/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/setup.html">Setup</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/setup/requirements.html">Requirements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/setup/getting.html">Getting libcu++</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/setup/building_and_testing.html">Building &amp; Testing libcu++</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/standard_api.html">Standard API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/algorithms_library.html">Algorithms Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/c_library.html">C Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/concepts_library.html">Concepts Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/container_library.html">Container Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/execution_library.html">Execution Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/numerics_library.html">Numerics Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/ranges_library.html">Ranges Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/synchronization_library.html">Synchronization Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/time_library.html">Time Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/type_support.html">Type Support Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/standard_api/utility_library.html">Utility Library</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/extended_api.html">Extended API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/bit.html">Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/execution_model.html">Execution model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/exceptions.html">Exception Handling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/memory_model.html">Memory model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/thread_groups.html">Thread Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/synchronization_primitives.html">Synchronization Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/asynchronous_operations.html">Asynchronous Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/memory_access_properties.html">Memory access properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/functional.html">Functional</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/iterators.html">Fancy Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/type_traits.html">Type traits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/vector_tuple_protocol.html">Vector Tuple Protocol</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/numeric.html">Numeric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/random.html">Random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/memory.html">Memory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/memory_resource.html">Memory Resources</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/math.html">Math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/mdspan.html">Mdspan</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/warp.html">Warp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/utility.html">Utility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/extended_api/work_stealing.html">Work stealing</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/runtime.html">Runtime</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/cudart_interactions.html">CUDA Runtime interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/stream.html">Streams</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/event.html">Events</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/algorithm.html">Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/device.html">Devices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/hierarchy.html">Hierarchy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/launch.html">Launch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/buffer.html">Buffer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/memory_pools.html">Memory Pools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/runtime/legacy_resources.html">Legacy resources</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../libcudacxx/ptx_api.html">PTX API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/ptx/examples.html">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/ptx/instructions.html">PTX Instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/ptx/pragmas.html">PTX Pragmas</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../libcudacxx/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">CUB</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../test_overview.html">CUB Tests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../benchmarking.html">CUB Benchmarks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tuning.html">CUB Tunings</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../developer_overview.html">CUB Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../developer/thread_level.html">Thread-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/warp_level.html">Warp-level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/block_scope.html">Block-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/device_scope.html">Device-scope</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developer/nvtx.html">NVTX</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../releases.html">CUB Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../releases/changelog.html">CUB 2.1.0</a></li>


















































</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../api.html">API documentation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../api_docs/thread_level.html">Thread-level Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_docs/warp_wide.html">Warp-Wide “Collective” Primitives</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api_docs/block_wide.html">Block-Wide “Collective” Primitives</a></li>
<li class="toctree-l4 current active"><a class="reference internal" href="../api_docs/device_wide.html">Device-Wide Primitives</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="index.html">API reference</a></li>
</ul>
</details></li>










<li class="toctree-l2 has-children"><a class="reference internal" href="../../thrust/index.html">Thrust</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../thrust/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../thrust/developer_overview.html">Thrust Developer Overview</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/developer/cmake_options.html">Developer CMake Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/developer/systems.html">Thrust systems</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../thrust/releases.html">Releases</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/releases/changelog.html">Changelog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/releases/versioning.html">Versioning</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../thrust/release_process.html">Release Process</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../thrust/api.html">API documentation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/algorithms.html">Algorithms</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/containers.html">Containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/function_objects.html">Function Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/iterators.html">Iterators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/memory_management.html">Memory Management</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/numerics.html">Numerics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/parallel_execution_policies.html">Parallel Execution Policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/random.html">Random Number Generators</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/system.html">System</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../thrust/api_docs/utility.html">Utility</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../thrust/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cudax/index.html">CUDA Experimental</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cudax/index.html">Overview</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cudax/container.html">Containers library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/classcuda_1_1experimental_1_1uninitialized__buffer.html">cuda::experimental::uninitialized_buffer</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cudax/memory_resource.html">Memory Resources</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/classcuda_1_1mr_1_1basic__any__resource.html">cuda::mr::basic_any_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/structcuda_1_1memory__pool__properties.html">cuda::memory_pool_properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/structcuda_1_1device__memory__pool.html">cuda::device_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/structcuda_1_1pinned__memory__pool.html">cuda::pinned_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/structcuda_1_1managed__memory__pool.html">cuda::managed_memory_pool</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/classcuda_1_1mr_1_1legacy__pinned__memory__resource.html">cuda::mr::legacy_pinned_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/classcuda_1_1mr_1_1legacy__managed__memory__resource.html">cuda::mr::legacy_managed_memory_resource</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../libcudacxx/api/structcuda_1_1mr_1_1shared__resource.html">cuda::mr::shared_resource</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cudax/graph.html">Graphs library</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1graph.html">cuda::experimental::graph</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1graph__builder.html">cuda::experimental::graph_builder</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1graph__builder__ref.html">cuda::experimental::graph_builder_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1graph__node__ref.html">cuda::experimental::graph_node_ref</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of.html">cuda::experimental::stf::graphed_interface_of</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01mdspan_3_01T_00_01P_8_8_8_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; mdspan&lt; T, P… &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01scalar__view_3_01T_01_4_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; scalar_view&lt; T &gt; &gt;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/api/structcuda_1_1experimental_1_1stf_1_1graphed__interface__of_3_01void__interface_01_4.html">cuda::experimental::stf::graphed_interface_of&lt; void_interface &gt;</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cudax/stf.html">CUDASTF</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cudax/stf/custom_data_interface.html">Implementation of the <code class="docutils literal notranslate"><span class="pre">matrix</span></code> class</a></li>





<li class="toctree-l4"><a class="reference internal" href="../../cudax/stf/lower_level_api.html">Lower-level API</a></li>

</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../cudax/api/index.html">API reference</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../cccl/tma.html">Tensor Memory Accelerator (TMA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cccl/3.0_migration_guide.html">CCCL 2.x ‐ CCCL 3.0 migration guide</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cccl/development/index.html">CCCL Development Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cccl/development/macro.html">CCCL Internal Macros</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cccl/development/testing.html">CCCL Testing Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../cccl/development/build_and_bisect_tools.html">Build and Bisect Utilities</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../cccl/development/visibility.html">Symbol Visibility</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../cccl/development/visibility/host_stub_visibility.html">Host Stub Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cccl/development/visibility/device_kernel_visibility.html">Device Kernel Visibility Issue</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../cccl/development/visibility/different_architectures.html">Linking TUs compiled with different architectures</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../cccl/contributing.html">Contributing to the CUDA Core Compute Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../cccl/contributing/code_of_conduct.html">Code of Conduct</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../cccl/license.html">License</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../python/index.html">CCCL Python Libraries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../python/setup.html">Setup and Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/compute.html"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code>: Parallel Computing Primitives</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/coop.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code>: Cooperative Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../python/resources.html">Resources</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../python/api_reference.html">API Reference</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../python/compute_api.html"><code class="docutils literal notranslate"><span class="pre">cuda.compute</span></code> API Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../python/coop_api.html"><code class="docutils literal notranslate"><span class="pre">cuda.coop</span></code> API Reference</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>



      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../cpp.html" class="nav-link">CUDA C++ Core Libraries</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">CUB</a></li>
    
    
    <li class="breadcrumb-item"><a href="../api.html" class="nav-link">CUB API documentation</a></li>
    
    
    <li class="breadcrumb-item"><a href="../api_docs/device_wide.html" class="nav-link">Device-Wide Primitives</a></li>
    
    
    <li class="breadcrumb-item"><a href="device.html" class="nav-link">Device-wide Primitives</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">cub::DeviceSegmentedSort</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="cub-devicesegmentedsort">
<h1>cub::DeviceSegmentedSort<a class="headerlink" href="#cub-devicesegmentedsort" title="Link to this heading">#</a></h1>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N3cub19DeviceSegmentedSortE">
<span class="target" id="structcub_1_1DeviceSegmentedSort"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DeviceSegmentedSort</span></span></span><a class="headerlink" href="#_CPPv4N3cub19DeviceSegmentedSortE" title="Link to this definition">#</a><br /></dt>
<dd><p><p>DeviceSegmentedSort provides device-wide, parallel operations for
computing a batched sort across multiple, non-overlapping sequences of
data items residing within device-accessible memory.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The algorithm arranges items into ascending (or descending) order.
The underlying sorting algorithm is undefined. Depending on the segment size,
it might be radix sort, merge sort or something else. Therefore, no
assumptions on the underlying implementation should be made.</p>
</section>
<section id="differences-from-devicesegmentedradixsort">
<h2>Differences from DeviceSegmentedRadixSort<a class="headerlink" href="#differences-from-devicesegmentedradixsort" title="Link to this heading">#</a></h2>
<p>DeviceSegmentedRadixSort is optimized for significantly large segments (tens
of thousands of items and more). Nevertheless, some domains produce a wide
range of segment sizes. DeviceSegmentedSort partitions segments into size
groups and specialize sorting algorithms for each group. This approach leads
to better resource utilization in the presence of segment size imbalance or
moderate segment sizes (up to thousands of items).
This algorithm is more complex and consists of multiple kernels. This fact
leads to longer compilation times as well as larger binaries sizes.</p>
</section>
<section id="supported-types">
<h2>Supported Types<a class="headerlink" href="#supported-types" title="Link to this heading">#</a></h2>
<p>The algorithm has to satisfy the underlying algorithms restrictions. Radix
sort usage restricts the list of supported types. Therefore,
DeviceSegmentedSort can sort all of the built-in C++ numeric primitive types
(<code class="docutils literal notranslate"><span class="pre">unsigned</span> <span class="pre">char</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, etc.) as well as CUDA’s <code class="docutils literal notranslate"><span class="pre">__half</span></code> and
<code class="docutils literal notranslate"><span class="pre">__nv_bfloat16</span></code> 16-bit floating-point types.</p>
<p>Segments are not required to be contiguous. Any element of input(s) or
output(s) outside the specified segments will not be accessed nor modified.</p>
</section>
<section id="a-simple-example">
<h2>A simple example<a class="headerlink" href="#a-simple-example" title="Link to this heading">#</a></h2>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_in</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_out</span><span class="p">;</span><span class="w">      </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
<span class="c1">// d_values_out          &lt;-- [1, 2, 0, 5, 4, 3, 6]</span>
</pre></div>
</div>
</section>
</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-keys-only">Keys-only</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a89c8862e280600b7b2ed44ccb275f7e3"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortKeys</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <cite>segment_offsets+1</cite>).</p></li>
<li><p>SortKeys is not guaranteed to be stable. That is, suppose that <code class="docutils literal notranslate"><span class="pre">i</span></code> and
<code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is not
guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>The range <code class="docutils literal notranslate"><span class="pre">[d_keys_out,</span> <span class="pre">d_keys_out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_keys_in,</span> <span class="pre">d_keys_in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code> will not
be accessed nor modified.</p></li>
</ul>
<section id="snippet">
<h2>Snippet<a class="headerlink" href="#snippet" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">int</span></code> keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible</span>
<span class="c1">// pointers for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">    </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the i-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1ae665894be96b0154bbd827e60300684e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortKeysDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into descending order. Approximately
<code class="docutils literal notranslate"><span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortKeysDescending is not guaranteed to be stable. That is, suppose that
<code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is
not guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>The range <code class="docutils literal notranslate"><span class="pre">[d_keys_out,</span> <span class="pre">d_keys_out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_keys_in,</span> <span class="pre">d_keys_in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code> will not
be accessed nor modified.</p></li>
</ul>
<section id="id1">
<h2>Snippet<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">    </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1aeeb0cb7c0de55334b1a938cf45ebfc36"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortKeys</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeys::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into ascending order. Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers managed by a
DoubleBuffer structure that indicates which of the two buffers is
“current” (and thus contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers may be altered by the sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within the DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span>&#160; <span class="pre">+1</span></code>).</p></li>
<li><p>SortKeys is not guaranteed to be stable. That is, suppose that
<code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is
not guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span> <span class="pre">=</span> <span class="pre">d_keys.Current()</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span> <span class="pre">=</span> <span class="pre">d_keys.Alternate()</span></code>.
The range <code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys[i].Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id2">
<h2>Snippet<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible</span>
<span class="c1">// pointers for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a DoubleBuffer to wrap the pair of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a36ac36e87158357f5dd3989b795a18cc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortKeysDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortKeysDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into descending order. Approximately
<code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers managed by a
DoubleBuffer structure that indicates which of the two buffers is
“current” (and thus contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers may be altered by the sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within the DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortKeysDescending is not guaranteed to be stable. That is, suppose that
<code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is
not guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span> <span class="pre">=</span> <span class="pre">d_keys.Current()</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span> <span class="pre">=</span> <span class="pre">d_keys.Alternate()</span></code>.
The range <code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys[i].Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id3">
<h2>Snippet<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers for</span>
<span class="c1">// sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a DoubleBuffer to wrap the pair of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1aa8209b02bfea645ee49d89a4a0eef578"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortKeys</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into ascending order. Approximately
<code class="docutils literal notranslate"><span class="pre">num_items</span> <span class="pre">+</span>&#160; <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortKeys is stable: it preserves the relative ordering of
equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>The range <code class="docutils literal notranslate"><span class="pre">[d_keys_out,</span> <span class="pre">d_keys_out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_keys_in,</span> <span class="pre">d_keys_in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code> will not
be accessed nor modified.</p></li>
</ul>
<section id="id4">
<h2>Snippet<a class="headerlink" href="#id4" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">    </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1ab7e6fc6f322def4a018ff76053810a36"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortKeysDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortKeysDescending is stable: it preserves the relative ordering of
equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>)
then a postcondition of stable sort is that <code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>The range <code class="docutils literal notranslate"><span class="pre">[d_keys_out,</span> <span class="pre">d_keys_out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_keys_in,</span> <span class="pre">d_keys_in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code> will not
be accessed nor modified.</p></li>
</ul>
<section id="id5">
<h2>Snippet<a class="headerlink" href="#id5" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">    </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done.</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and
<code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1af16bcb5a30bc0cb7553caa121b3760a0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortKeys</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeys::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers managed by a
DoubleBuffer structure that indicates which of the two buffers is
“current” (and thus contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers may be altered by the sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within the DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortKeys is stable: it preserves the relative ordering of
equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span> <span class="pre">=</span> <span class="pre">d_keys.Current()</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span> <span class="pre">=</span> <span class="pre">d_keys.Alternate()</span></code>.
The range <code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys[i].Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id6">
<h2>Snippet<a class="headerlink" href="#id6" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a DoubleBuffer to wrap the pair of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeys</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a811a30092cfb2a0f90c8bfb8a5142b54"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortKeysDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortKeysDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of keys into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers managed by a
DoubleBuffer structure that indicates which of the two buffers is
“current” (and thus contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers may be altered by the sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within the DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortKeysDescending is stable: it preserves the relative ordering of
equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span> <span class="pre">=</span> <span class="pre">d_keys.Current()</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span> <span class="pre">=</span> <span class="pre">d_keys.Alternate()</span></code>.
The range <code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">`i`</span>
<span class="pre">outside</span> <span class="pre">the</span> <span class="pre">specified</span> <span class="pre">segments</span> <span class="pre">``d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys[i].Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id7">
<h2>Snippet<a class="headerlink" href="#id7" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a DoubleBuffer to wrap the pair of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortKeysDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done.</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and
<code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>. If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the
<code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-key-value-pairs">Key-value pairs</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1affd6f18b2c7854624c091534bc802a3b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortPairs</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortPairs is not guaranteed to be stable. That is, suppose that <code class="docutils literal notranslate"><span class="pre">i</span></code> and
<code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is not
guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">in</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys_in,</span> <span class="pre">d_values_in}</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> be any of
<code class="docutils literal notranslate"><span class="pre">{d_keys_out,</span> <span class="pre">d_values_out}</span></code>. The range <code class="docutils literal notranslate"><span class="pre">[out,</span> <span class="pre">out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall
not overlap <code class="docutils literal notranslate"><span class="pre">[in,</span> <span class="pre">in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_in[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_out[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id8">
<h2>Snippet<a class="headerlink" href="#id8" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_in</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_out</span><span class="p">;</span><span class="w">      </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
<span class="c1">// d_values_out          &lt;-- [1, 2, 0, 5, 4, 3, 6]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>d_values_in</strong> – <strong>[in]</strong> Device-accessible pointer to the corresponding input sequence of associated value items</p></li>
<li><p><strong>d_values_out</strong> – <strong>[out]</strong> Device-accessible pointer to the correspondingly-reordered output sequence of associated value items</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]-1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1acec69c488581e85db319dfd43a67bf6b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortPairsDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortPairs is not guaranteed to be stable. That is, suppose that <code class="docutils literal notranslate"><span class="pre">i</span></code> and
<code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is not
guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">in</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys_in,</span> <span class="pre">d_values_in}</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> be any of
<code class="docutils literal notranslate"><span class="pre">{d_keys_out,</span> <span class="pre">d_values_out}</span></code>. The range <code class="docutils literal notranslate"><span class="pre">[out,</span> <span class="pre">out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall
not overlap <code class="docutils literal notranslate"><span class="pre">[in,</span> <span class="pre">in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_in[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_out[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id9">
<h2>Snippet<a class="headerlink" href="#id9" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers for</span>
<span class="c1">// sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_in</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_out</span><span class="p">;</span><span class="w">      </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">    </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
<span class="c1">// d_values_out          &lt;-- [0, 2, 1, 6, 3, 4, 5]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done.</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>d_values_in</strong> – <strong>[in]</strong> Device-accessible pointer to the corresponding input sequence of associated value items</p></li>
<li><p><strong>d_values_out</strong> – <strong>[out]</strong> Device-accessible pointer to the correspondingly-reordered output sequence of associated value items</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the i-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a6c618042fc08b27a93b16cc6a5962255"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortPairs</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_values</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairs::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers and a corresponding
pair of associated value buffers.  Each pair is managed by a DoubleBuffer
structure that indicates which of the two buffers is “current” (and thus
contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers within each pair may be altered by the sorting
operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current” indicator
within each DoubleBuffer wrapper to reference which of the two buffers
now contains the sorted output sequence (a function of the number of key bits
specified and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortPairs is not guaranteed to be stable. That is, suppose that <code class="docutils literal notranslate"><span class="pre">i</span></code> and
<code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is not
guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys.Current(),</span> <span class="pre">d_values.Current()}</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span></code>
be any of <code class="docutils literal notranslate"><span class="pre">{d_keys.Alternate(),</span> <span class="pre">d_values.Alternate()}</span></code>. The range
<code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Current()[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys.Alternate()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id10">
<h2>Snippet<a class="headerlink" href="#id10" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_buf</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_alt_buf</span><span class="p">;</span><span class="w">   </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a set of DoubleBuffers to wrap pairs of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_values</span><span class="p">(</span><span class="n">d_value_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_value_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
<span class="c1">// d_values.Current()    &lt;-- [5, 4, 3, 1, 2, 0, 6]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done.</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>d_values</strong> – <strong>[inout]</strong> Double-buffer of values whose “current” device-accessible buffer contains the unsorted input values and, upon return, is updated to point to the sorted output values</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the i-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1aba3689108f4b6b5452f31ee5a8139275"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SortPairsDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_values</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::SortPairsDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers and a corresponding
pair of associated value buffers. Each pair is managed by a DoubleBuffer
structure that indicates which of the two buffers is “current” (and thus
contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers within each pair may be altered by the
sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within each DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits specified and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>SortPairsDescending is not guaranteed to be stable. That is, suppose that
<code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are equivalent: neither one is less than the other. It is
not guaranteed that the relative order of these two elements will be
preserved by sort.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys.Current(),</span> <span class="pre">d_values.Current()}</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span></code>
be any of <code class="docutils literal notranslate"><span class="pre">{d_keys.Alternate(),</span> <span class="pre">d_values.Alternate()}</span></code>. The range
<code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Current()[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys.Alternate()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id11">
<h2>Snippet<a class="headerlink" href="#id11" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers for</span>
<span class="c1">// sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_buf</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_alt_buf</span><span class="p">;</span><span class="w">   </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a set of DoubleBuffers to wrap pairs of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_values</span><span class="p">(</span><span class="n">d_value_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_value_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">SortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
<span class="c1">// d_values.Current()    &lt;-- [0, 2, 1, 6, 3, 4, 5]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>d_values</strong> – <strong>[inout]</strong> Double-buffer of values whose “current” device-accessible buffer contains the unsorted input values and, upon return, is updated to point to the sorted output values</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a8a4dd91f9374ecd7e495a3c1cefdd912"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortPairs</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortPairs is stable: it preserves the relative ordering of
equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">in</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys_in,</span> <span class="pre">d_values_in}</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> be any of
<code class="docutils literal notranslate"><span class="pre">{d_keys_out,</span> <span class="pre">d_values_out}</span></code>. The range <code class="docutils literal notranslate"><span class="pre">[out,</span> <span class="pre">out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall
not overlap <code class="docutils literal notranslate"><span class="pre">[in,</span> <span class="pre">in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_in[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_out[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id12">
<h2>Snippet<a class="headerlink" href="#id12" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_in</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_out</span><span class="p">;</span><span class="w">      </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
<span class="c1">// d_values_out          &lt;-- [1, 2, 0, 5, 4, 3, 6]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When nullptr, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done.</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>d_values_in</strong> – <strong>[in]</strong> Device-accessible pointer to the corresponding input sequence of associated value items</p></li>
<li><p><strong>d_values_out</strong> – <strong>[out]</strong> Device-accessible pointer to the correspondingly-reordered output sequence of associated value items</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a8c3071d7f24c845da5713d26f728ba4f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortPairsDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_keys_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_in</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_values_out</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_items</span> <span class="pre">+</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The contents of the input data are not altered by the sorting operation.</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortPairsDescending is stable: it preserves the relative ordering
of equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <cite>in</cite> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys_in,</span> <span class="pre">d_values_in}</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> be any of
<code class="docutils literal notranslate"><span class="pre">{d_keys_out,</span> <span class="pre">d_values_out}</span></code>. The range <code class="docutils literal notranslate"><span class="pre">[out,</span> <span class="pre">out</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall
not overlap <code class="docutils literal notranslate"><span class="pre">[in,</span> <span class="pre">in</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>,
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys_in[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_in[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_keys_out[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_values_out[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id13">
<h2>Snippet<a class="headerlink" href="#id13" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_in</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_keys_out</span><span class="p">;</span><span class="w">        </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_in</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_values_out</span><span class="p">;</span><span class="w">      </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span>
<span class="w">    </span><span class="n">d_keys_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys_out</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_in</span><span class="p">,</span><span class="w"> </span><span class="n">d_values_out</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys_out            &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
<span class="c1">// d_values_out          &lt;-- [0, 2, 1, 6, 3, 4, 5]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys_in</strong> – <strong>[in]</strong> Device-accessible pointer to the input data of key data to sort</p></li>
<li><p><strong>d_keys_out</strong> – <strong>[out]</strong> Device-accessible pointer to the sorted output sequence of key data</p></li>
<li><p><strong>d_values_in</strong> – <strong>[in]</strong> Device-accessible pointer to the corresponding input sequence of associated value items</p></li>
<li><p><strong>d_values_out</strong> – <strong>[out]</strong> Device-accessible pointer to the correspondingly-reordered output sequence of associated value items</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1a3719465300741dc8acc408dab1a887ba"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortPairs</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_values</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairs::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into ascending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers and a corresponding
pair of associated value buffers. Each pair is managed by a DoubleBuffer
structure that indicates which of the two buffers is “current” (and thus
contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers within each pair may be altered by the
sorting operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current”
indicator within each DoubleBuffer wrapper to reference which of the two
buffers now contains the sorted output sequence (a function of the number
of key bits specified and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortPairs is stable: it preserves the relative ordering
of equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <cite>y</cite>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys.Current(),</span> <span class="pre">d_values.Current()}</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span></code>
be any of <code class="docutils literal notranslate"><span class="pre">{d_keys.Alternate(),</span> <span class="pre">d_values.Alternate()}</span></code>. The range
<code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Current()[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys.Alternate()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id14">
<h2>Snippet<a class="headerlink" href="#id14" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span>
<span class="c1">// or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_buf</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_alt_buf</span><span class="p">;</span><span class="w">   </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a set of DoubleBuffers to wrap pairs of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_values</span><span class="p">(</span><span class="n">d_value_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_value_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairs</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [6, 7, 8, 0, 3, 5, 9]</span>
<span class="c1">// d_values.Current()    &lt;-- [5, 4, 3, 1, 2, 0, 6]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>d_values</strong> – <strong>[inout]</strong> Double-buffer of values whose “current” device-accessible buffer contains the unsorted input values and, upon return, is updated to point to the sorted output values</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]-1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">KeyT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">ValueT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname sig-name-template"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structcub_1_1DeviceSegmentedSort_1aa50ebb854e311cd04fb860eefe0375e8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">cudaError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">StableSortPairsDescending</span></span></span><span class="sig-paren">(</span>

<dl>
<dd><em class="sig-param"><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">d_temp_storage</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">temp_storage_bytes</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::KeyT"><span class="n"><span class="pre">KeyT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_keys</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">DoubleBuffer</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::ValueT"><span class="n"><span class="pre">ValueT</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">d_values</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_items</span></span></em>,</dd>
<dd><em class="sig-param"><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">cuda</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_segments</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::BeginOffsetIteratorT"><span class="n"><span class="pre">BeginOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_begin_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><a class="reference internal" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="cub::DeviceSegmentedSort::StableSortPairsDescending::EndOffsetIteratorT"><span class="n"><span class="pre">EndOffsetIteratorT</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">d_end_offsets</span></span></em>,</dd>
<dd><em class="sig-param"><span class="n"><span class="pre">cudaStream_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">stream</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span></em></dd>
</dl>

<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t" title="Link to this definition">#</a><br /></dt>
<dd><p><p>Sorts segments of key-value pairs into descending order.
Approximately <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">num_segments</span></code> auxiliary storage required.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 2.2.0: </span>First appears in CUDA Toolkit 12.3.</p>
</div>
<ul class="simple">
<li><p>The sorting operation is given a pair of key buffers and a corresponding
pair of associated value buffers.  Each pair is managed by a DoubleBuffer
structure that indicates which of the two buffers is “current” (and thus
contains the input data to be sorted).</p></li>
<li><p>The contents of both buffers within each pair may be altered by the sorting
operation.</p></li>
<li><p>Upon completion, the sorting operation will update the “current” indicator
within each DoubleBuffer wrapper to reference which of the two buffers
now contains the sorted output sequence (a function of the number of key bits
specified and the targeted device architecture).</p></li>
<li><p>When the input is a contiguous sequence of segments, a single sequence
<code class="docutils literal notranslate"><span class="pre">segment_offsets</span></code> (of length <code class="docutils literal notranslate"><span class="pre">num_segments</span> <span class="pre">+</span> <span class="pre">1</span></code>) can be aliased
for both the <code class="docutils literal notranslate"><span class="pre">d_begin_offsets</span></code> and <code class="docutils literal notranslate"><span class="pre">d_end_offsets</span></code> parameters (where
the latter is specified as <code class="docutils literal notranslate"><span class="pre">segment_offsets</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>StableSortPairsDescending is stable: it preserves the relative ordering
of equivalent elements. That is, if <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are elements such that
<code class="docutils literal notranslate"><span class="pre">x</span></code> precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>, and if the two elements are equivalent (neither
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">&lt;</span> <span class="pre">y</span></code> nor <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">&lt;</span> <span class="pre">x</span></code>) then a postcondition of stable sort is that
<code class="docutils literal notranslate"><span class="pre">x</span></code> still precedes <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p></li>
<li><p>Let <code class="docutils literal notranslate"><span class="pre">cur</span></code> be one of <code class="docutils literal notranslate"><span class="pre">{d_keys.Current(),</span> <span class="pre">d_values.Current()}</span></code> and <code class="docutils literal notranslate"><span class="pre">alt</span></code>
be any of <code class="docutils literal notranslate"><span class="pre">{d_keys.Alternate(),</span> <span class="pre">d_values.Alternate()}</span></code>. The range
<code class="docutils literal notranslate"><span class="pre">[cur,</span> <span class="pre">cur</span> <span class="pre">+</span> <span class="pre">num_items)</span></code> shall not overlap
<code class="docutils literal notranslate"><span class="pre">[alt,</span> <span class="pre">alt</span> <span class="pre">+</span> <span class="pre">num_items)</span></code>. Both ranges shall not overlap
<code class="docutils literal notranslate"><span class="pre">[d_begin_offsets,</span> <span class="pre">d_begin_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> nor
<code class="docutils literal notranslate"><span class="pre">[d_end_offsets,</span> <span class="pre">d_end_offsets</span> <span class="pre">+</span> <span class="pre">num_segments)</span></code> in any way.</p></li>
<li><p>Segments are not required to be contiguous. For all index values <code class="docutils literal notranslate"><span class="pre">i</span></code>
outside the specified segments <code class="docutils literal notranslate"><span class="pre">d_keys.Current()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Current()[i]</span></code>, <code class="docutils literal notranslate"><span class="pre">d_keys.Alternate()[i]</span></code>,
<code class="docutils literal notranslate"><span class="pre">d_values.Alternate()[i]</span></code> will not be accessed nor modified.</p></li>
</ul>
<section id="id15">
<h2>Snippet<a class="headerlink" href="#id15" title="Link to this heading">#</a></h2>
<p>The code snippet below illustrates the batched sorting of three segments
(with one zero-length segment) of <code class="docutils literal notranslate"><span class="pre">i</span></code> nt keys with associated vector of
<code class="docutils literal notranslate"><span class="pre">i</span></code> nt values.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cub/cub.cuh&gt;</span><span class="c1"> // or equivalently &lt;cub/device/device_segmented_sort.cuh&gt;</span>

<span class="c1">// Declare, allocate, and initialize device-accessible pointers</span>
<span class="c1">// for sorting data</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_items</span><span class="p">;</span><span class="w">          </span><span class="c1">// e.g., 7</span>
<span class="kt">int</span><span class="w">  </span><span class="n">num_segments</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., 3</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_offsets</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [0, 3, 3, 7]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_buf</span><span class="p">;</span><span class="w">         </span><span class="c1">// e.g., [8, 6, 7, 5, 3, 0, 9]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_key_alt_buf</span><span class="p">;</span><span class="w">     </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_buf</span><span class="p">;</span><span class="w">       </span><span class="c1">// e.g., [0, 1, 2, 3, 4, 5, 6]</span>
<span class="kt">int</span><span class="w">  </span><span class="o">*</span><span class="n">d_value_alt_buf</span><span class="p">;</span><span class="w">   </span><span class="c1">// e.g., [-, -, -, -, -, -, -]</span>
<span class="p">...</span>

<span class="c1">// Create a set of DoubleBuffers to wrap pairs of device pointers</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_keys</span><span class="p">(</span><span class="n">d_key_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_key_alt_buf</span><span class="p">);</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DoubleBuffer</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="w"> </span><span class="n">d_values</span><span class="p">(</span><span class="n">d_value_buf</span><span class="p">,</span><span class="w"> </span><span class="n">d_value_alt_buf</span><span class="p">);</span>

<span class="c1">// Determine temporary device storage requirements</span>
<span class="kt">void</span><span class="w">     </span><span class="o">*</span><span class="n">d_temp_storage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">;</span>
<span class="kt">size_t</span><span class="w">   </span><span class="n">temp_storage_bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// Allocate temporary storage</span>
<span class="n">cudaMalloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">);</span>

<span class="c1">// Run sorting operation</span>
<span class="n">cub</span><span class="o">::</span><span class="n">DeviceSegmentedSort</span><span class="o">::</span><span class="n">StableSortPairsDescending</span><span class="p">(</span>
<span class="w">    </span><span class="n">d_temp_storage</span><span class="p">,</span><span class="w"> </span><span class="n">temp_storage_bytes</span><span class="p">,</span><span class="w"> </span><span class="n">d_keys</span><span class="p">,</span><span class="w"> </span><span class="n">d_values</span><span class="p">,</span>
<span class="w">    </span><span class="n">num_items</span><span class="p">,</span><span class="w"> </span><span class="n">num_segments</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="p">,</span><span class="w"> </span><span class="n">d_offsets</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="c1">// d_keys.Current()      &lt;-- [8, 7, 6, 9, 5, 3, 0]</span>
<span class="c1">// d_values.Current()    &lt;-- [0, 2, 1, 6, 3, 4, 5]</span>
</pre></div>
</div>
</section>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>KeyT</strong> – <strong>[inferred]</strong> Key type</p></li>
<li><p><strong>ValueT</strong> – <strong>[inferred]</strong> Value type</p></li>
<li><p><strong>BeginOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment beginning offsets (may be a simple pointer type)</p></li>
<li><p><strong>EndOffsetIteratorT</strong> – <strong>[inferred]</strong> Random-access input iterator type for reading segment ending offsets (may be a simple pointer type)</p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>d_temp_storage</strong> – <strong>[in]</strong> Device-accessible allocation of temporary storage. When <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the required allocation size is written to <code class="docutils literal notranslate"><span class="pre">temp_storage_bytes</span></code> and no work is done</p></li>
<li><p><strong>temp_storage_bytes</strong> – <strong>[inout]</strong> Reference to size in bytes of <code class="docutils literal notranslate"><span class="pre">d_temp_storage</span></code> allocation</p></li>
<li><p><strong>d_keys</strong> – <strong>[inout]</strong> Reference to the double-buffer of keys whose “current” device-accessible buffer contains the unsorted input keys and, upon return, is updated to point to the sorted output keys</p></li>
<li><p><strong>d_values</strong> – <strong>[inout]</strong> Double-buffer of values whose “current” device-accessible buffer contains the unsorted input values and, upon return, is updated to point to the sorted output values</p></li>
<li><p><strong>num_items</strong> – <strong>[in]</strong> The total number of items to sort (across all segments)</p></li>
<li><p><strong>num_segments</strong> – <strong>[in]</strong> The number of segments that comprise the sorting data</p></li>
<li><p><strong>d_begin_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of beginning offsets of
length <code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_begin_offsets[i]</span></code> is the first
element of the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code></p>
</p>
</p></li>
<li><p><strong>d_end_offsets</strong> – <strong>[in]</strong> <p><p>Random-access input iterator to the sequence of ending offsets of length
<code class="docutils literal notranslate"><span class="pre">num_segments</span></code>, such that <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span></code> is the last element of
the <em>i</em><sup>th</sup> data segment in <code class="docutils literal notranslate"><span class="pre">d_keys_*</span></code> and <code class="docutils literal notranslate"><span class="pre">d_values_*</span></code>.
If <code class="docutils literal notranslate"><span class="pre">d_end_offsets[i]</span> <span class="pre">-</span> <span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">d_begin_offsets[i]</span></code>, the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th segment is
considered empty.</p>
</p>
</p></li>
<li><p><strong>stream</strong> – <strong>[in]</strong> <p><p><strong>[optional]</strong> CUDA stream to launch kernels within. Default is stream<sub>0</sub>.</p>
</p>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="structcub_1_1DeviceSegmentedScan.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">cub::DeviceSegmentedScan</p>
      </div>
    </a>
    <a class="right-next"
       href="structcub_1_1DeviceSelect.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">cub::DeviceSelect</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            


              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4N3cub19DeviceSegmentedSortE"><code class="docutils literal notranslate"><span class="pre">cub::DeviceSegmentedSort</span></code></a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortKeys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortKeysDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort8SortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortKeys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort18SortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortKeysDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortKeys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortKeysDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort14StableSortKeysE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortKeys()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I000EN3cub19DeviceSegmentedSort24StableSortKeysDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortKeysDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortPairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortPairsDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort9SortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortPairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort19SortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">SortPairsDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortPairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tPK4KeyTP4KeyTPK6ValueTP6ValueTN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortPairsDescending()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort15StableSortPairsE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortPairs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#_CPPv4I0000EN3cub19DeviceSegmentedSort25StableSortPairsDescendingE11cudaError_tPvR6size_tR12DoubleBufferI4KeyTER12DoubleBufferI6ValueTEN4cudaSt7int64_tEN4cudaSt7int64_tE20BeginOffsetIteratorT18EndOffsetIteratorT12cudaStream_t"><code class="docutils literal notranslate"><span class="pre">StableSortPairsDescending()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            

          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  

  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>


  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">




  <p class="copyright">
    
      Copyright © 2026, NVIDIA Corporation.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>