//===----------------------------------------------------------------------===//
//
// Part of libcu++, the C++ Standard Library for your entire system,
// under the Apache License v2.0 with LLVM Exceptions.
// See https://llvm.org/LICENSE.txt for license information.
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
// SPDX-FileCopyrightText: Copyright (c) 2025 NVIDIA CORPORATION & AFFILIATES.
//
//===----------------------------------------------------------------------===//

#include <cuda/std/__charconv_>
#include <cuda/std/array>
#include <cuda/std/cstddef>
#include <cuda/std/cstdint>
#include <cuda/std/type_traits>
#include <cuda/std/utility>

#include "test_macros.h"

constexpr int first_base = 2;
constexpr int last_base  = 36;

[[nodiscard]] __host__ __device__ constexpr bool str_equal(const char* str1, const char* str2, size_t max_len)
{
  for (size_t i = 0; i < max_len; ++i)
  {
    if (str1[i] != str2[i])
    {
      return false;
    }
    if (str1[i] == '\0')
    {
      return true;
    }
  }
  return true;
}

[[nodiscard]] __host__ __device__ constexpr size_t str_len(const char* str)
{
  size_t i{};
  for (; str[i]; ++i)
  {
  }
  return i;
}

struct TestItem
{
  int64_t val; // todo: we currently test values in the range of int64_t, expand it to int128_t
  const char* str_signed;
  const char* str_unsigned = str_signed;
};

template <int Base>
constexpr cuda::std::array<TestItem, 0> test_items{};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<2>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "10"},
  TestItem{3, "11"},
  TestItem{4, "100"},
  TestItem{7, "111"},
  TestItem{8, "1000"},
  TestItem{14, "1110"},
  TestItem{16, "10000"},
  TestItem{23, "10111"},
  TestItem{32, "100000"},
  TestItem{36, "100100"},
  TestItem{127, "1111111"},
  TestItem{200, "11001000"},
  TestItem{255, "11111111"},
  TestItem{8158, "1111111011110"},
  TestItem{50243, "1100010001000011"},
  TestItem{32767, "111111111111111"},
  TestItem{87231, "10101010010111111"},
  TestItem{65535, "1111111111111111"},
  TestItem{17875098, "1000100001100000010011010"},
  TestItem{1787987597, "1101010100100101000011010001101"},
  TestItem{2147483647, "1111111111111111111111111111111"},
  TestItem{4294967295, "11111111111111111111111111111111"},
  TestItem{657687465411, "1001100100100001001110100100110111000011"},
  TestItem{89098098408713, "10100010000100011000100100000010111110100001001"},
  TestItem{4987654351689798, "10001101110000011111011000101111001010001100001000110"},
  TestItem{9223372036854775807, "111111111111111111111111111111111111111111111111111111111111111"},
  TestItem{-1, "-1", "1111111111111111111111111111111111111111111111111111111111111111"},
  TestItem{-13, "-1101", "1111111111111111111111111111111111111111111111111111111111110011"},
  TestItem{-128, "-10000000", "1111111111111111111111111111111111111111111111111111111110000000"},
  TestItem{-879, "-1101101111", "1111111111111111111111111111111111111111111111111111110010010001"},
  TestItem{-12345, "-11000000111001", "1111111111111111111111111111111111111111111111111100111111000111"},
  TestItem{-32768, "-1000000000000000", "1111111111111111111111111111111111111111111111111000000000000000"},
  TestItem{-5165781, "-10011101101001011010101", "1111111111111111111111111111111111111111101100010010110100101011"},
  TestItem{
    -97897347, "-101110101011100101110000011", "1111111111111111111111111111111111111010001010100011010001111101"},
  TestItem{-2147483648,
           "-10000000000000000000000000000000",
           "1111111111111111111111111111111110000000000000000000000000000000"},
  TestItem{-165789751156,
           "-10011010011001110101101101011101110100",
           "1111111111111111111111111101100101100110001010010010100010001100"},
  TestItem{-8798798743521135,
           "-11111010000100111010111111001100011101100011101101111",
           "1111111111100000101111011000101000000110011100010011100010010001"},
  TestItem{-9223372036854775807 - 1,
           "-1000000000000000000000000000000000000000000000000000000000000000",
           "1000000000000000000000000000000000000000000000000000000000000000"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<3>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "10"},
  TestItem{4, "11"},
  TestItem{7, "21"},
  TestItem{8, "22"},
  TestItem{14, "112"},
  TestItem{16, "121"},
  TestItem{23, "212"},
  TestItem{32, "1012"},
  TestItem{36, "1100"},
  TestItem{127, "11201"},
  TestItem{200, "21102"},
  TestItem{255, "100110"},
  TestItem{8158, "102012011"},
  TestItem{50243, "2112220212"},
  TestItem{32767, "1122221121"},
  TestItem{87231, "11102122210"},
  TestItem{65535, "10022220020"},
  TestItem{17875098, "1020122011000200"},
  TestItem{1787987597, "11121121102011212212"},
  TestItem{2147483647, "12112122212110202101"},
  TestItem{4294967295, "102002022201221111210"},
  TestItem{657687465411, "2022212121100222221011020"},
  TestItem{89098098408713, "102200110200202200010100101002"},
  TestItem{4987654351689798, "220020001211002200102102220021000"},
  TestItem{9223372036854775807, "2021110011022210012102010021220101220221"},
  TestItem{-1, "-1", "11112220022122120101211020120210210211220"},
  TestItem{-13, "-111", "11112220022122120101211020120210210211110"},
  TestItem{-128, "-11202", "11112220022122120101211020120210210200012"},
  TestItem{-879, "-1012120", "11112220022122120101211020120210202122101"},
  TestItem{-12345, "-121221020", "11112220022122120101211020120210011220201"},
  TestItem{-32768, "-1122221122", "11112220022122120101211020120202010220022"},
  TestItem{-5165781, "-100201110010020", "11112220022122120101211020020002100201201"},
  TestItem{-97897347, "-20211012200220200", "11112220022122120101210222202121002221021"},
  TestItem{-2147483648, "-12112122212110202102", "11112220022122120101121200220221100002112"},
  TestItem{-165789751156, "-120211221011122222110221", "11112220022122112210222022102010211101000"},
  TestItem{-8798798743521135, "-1120201211221221111212210201011020", "11112211201220201102212201201000002200201"},
  TestItem{
    -9223372036854775807 - 1, "-2021110011022210012102010021220101220222", "2021110011022210012102010021220101220222"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<4>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "10"},
  TestItem{7, "13"},
  TestItem{8, "20"},
  TestItem{14, "32"},
  TestItem{16, "100"},
  TestItem{23, "113"},
  TestItem{32, "200"},
  TestItem{36, "210"},
  TestItem{127, "1333"},
  TestItem{200, "3020"},
  TestItem{255, "3333"},
  TestItem{8158, "1333132"},
  TestItem{50243, "30101003"},
  TestItem{32767, "13333333"},
  TestItem{87231, "111102333"},
  TestItem{65535, "33333333"},
  TestItem{17875098, "1010030002122"},
  TestItem{1787987597, "1222210220122031"},
  TestItem{2147483647, "1333333333333333"},
  TestItem{4294967295, "3333333333333333"},
  TestItem{657687465411, "21210201032210313003"},
  TestItem{89098098408713, "110100203010200113310021"},
  TestItem{4987654351689798, "101232003323011321101201012"},
  TestItem{9223372036854775807, "13333333333333333333333333333333"},
  TestItem{-1, "-1", "33333333333333333333333333333333"},
  TestItem{-13, "-31", "33333333333333333333333333333303"},
  TestItem{-128, "-2000", "33333333333333333333333333332000"},
  TestItem{-879, "-31233", "33333333333333333333333333302101"},
  TestItem{-12345, "-3000321", "33333333333333333333333330333013"},
  TestItem{-32768, "-20000000", "33333333333333333333333320000000"},
  TestItem{-5165781, "-103231023111", "33333333333333333333230102310223"},
  TestItem{-97897347, "-11311130232003", "33333333333333333322022203101331"},
  TestItem{-2147483648, "-2000000000000000", "33333333333333332000000000000000"},
  TestItem{-165789751156, "-2122121311231131310", "33333333333331211212022102202030"},
  TestItem{-8798798743521135, "-133100213113321203230131233", "33333200233120220012130103202101"},
  TestItem{-9223372036854775807 - 1, "-20000000000000000000000000000000", "20000000000000000000000000000000"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<5>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "12"},
  TestItem{8, "13"},
  TestItem{14, "24"},
  TestItem{16, "31"},
  TestItem{23, "43"},
  TestItem{32, "112"},
  TestItem{36, "121"},
  TestItem{127, "1002"},
  TestItem{200, "1300"},
  TestItem{255, "2010"},
  TestItem{8158, "230113"},
  TestItem{50243, "3101433"},
  TestItem{32767, "2022032"},
  TestItem{87231, "10242411"},
  TestItem{65535, "4044120"},
  TestItem{17875098, "14034000343"},
  TestItem{1787987597, "12130211100342"},
  TestItem{2147483647, "13344223434042"},
  TestItem{4294967295, "32244002423140"},
  TestItem{657687465411, "41233420442343121"},
  TestItem{89098098408713, "43134240401143034323"},
  TestItem{4987654351689798, "20212220212103013033143"},
  TestItem{9223372036854775807, "1104332401304422434310311212"},
  TestItem{-1, "-1", "2214220303114400424121122430"},
  TestItem{-13, "-23", "2214220303114400424121122403"},
  TestItem{-128, "-1003", "2214220303114400424121121423"},
  TestItem{-879, "-12004", "2214220303114400424121110422"},
  TestItem{-12345, "-343340", "2214220303114400424120224041"},
  TestItem{-32768, "-2022033", "2214220303114400424114100343"},
  TestItem{-5165781, "-2310301111", "2214220303114400421310321320"},
  TestItem{-97897347, "-200030203342", "2214220303114400224040414034"},
  TestItem{-2147483648, "-13344223434043", "2214220303114332024342133333"},
  TestItem{-165789751156, "-10204014134014111", "2214220303104141404432103320"},
  TestItem{-8798798743521135, "-33211234004311320134020", "2214132041330341112300433411"},
  TestItem{-9223372036854775807 - 1, "-1104332401304422434310311213", "1104332401304422434310311213"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<6>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "11"},
  TestItem{8, "12"},
  TestItem{14, "22"},
  TestItem{16, "24"},
  TestItem{23, "35"},
  TestItem{32, "52"},
  TestItem{36, "100"},
  TestItem{127, "331"},
  TestItem{200, "532"},
  TestItem{255, "1103"},
  TestItem{8158, "101434"},
  TestItem{50243, "1024335"},
  TestItem{32767, "411411"},
  TestItem{87231, "1511503"},
  TestItem{65535, "1223223"},
  TestItem{17875098, "1435043030"},
  TestItem{1787987597, "453230440205"},
  TestItem{2147483647, "553032005531"},
  TestItem{4294967295, "1550104015503"},
  TestItem{657687465411, "1222045404520523"},
  TestItem{89098098408713, "513255033520304345"},
  TestItem{4987654351689798, "121035504435532434130"},
  TestItem{9223372036854775807, "1540241003031030222122211"},
  TestItem{-1, "-1", "3520522010102100444244423"},
  TestItem{-13, "-21", "3520522010102100444244403"},
  TestItem{-128, "-332", "3520522010102100444244052"},
  TestItem{-879, "-4023", "3520522010102100444240401"},
  TestItem{-12345, "-133053", "3520522010102100444111331"},
  TestItem{-32768, "-411412", "3520522010102100443433012"},
  TestItem{-5165781, "-302415353", "3520522010102100141425031"},
  TestItem{-97897347, "-13414140243", "3520522010102043030104141"},
  TestItem{-2147483648, "-553032005532", "3520522010101103412234452"},
  TestItem{-165789751156, "-204055053424124", "3520522005454001350420300"},
  TestItem{-8798798743521135, "-222345252201335025223", "3520255220405455105215201"},
  TestItem{-9223372036854775807 - 1, "-1540241003031030222122212", "1540241003031030222122212"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<7>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "10"},
  TestItem{8, "11"},
  TestItem{14, "20"},
  TestItem{16, "22"},
  TestItem{23, "32"},
  TestItem{32, "44"},
  TestItem{36, "51"},
  TestItem{127, "241"},
  TestItem{200, "404"},
  TestItem{255, "513"},
  TestItem{8158, "32533"},
  TestItem{50243, "266324"},
  TestItem{32767, "164350"},
  TestItem{87231, "512214"},
  TestItem{65535, "362031"},
  TestItem{17875098, "304635663"},
  TestItem{1787987597, "62210433554"},
  TestItem{2147483647, "104134211161"},
  TestItem{4294967295, "211301422353"},
  TestItem{657687465411, "65342052134244"},
  TestItem{89098098408713, "24524060636446322"},
  TestItem{4987654351689798, "3030400064303245065"},
  TestItem{9223372036854775807, "22341010611245052052300"},
  TestItem{-1, "-1", "45012021522523134134601"},
  TestItem{-13, "-16", "45012021522523134134553"},
  TestItem{-128, "-242", "45012021522523134134330"},
  TestItem{-879, "-2364", "45012021522523134132205"},
  TestItem{-12345, "-50664", "45012021522523134053605"},
  TestItem{-32768, "-164351", "45012021522523133640221"},
  TestItem{-5165781, "-61623405", "45012021522523042211164"},
  TestItem{-97897347, "-2266054002", "45012021522520535050600"},
  TestItem{-2147483648, "-104134211162", "45012021522415666623410"},
  TestItem{-165789751156, "-14656265430121", "45012021504533535404451"},
  TestItem{-8798798743521135, "-5255221142205524046", "45003433301350625310523"},
  TestItem{-9223372036854775807 - 1, "-22341010611245052052301", "22341010611245052052301"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<8>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "10"},
  TestItem{14, "16"},
  TestItem{16, "20"},
  TestItem{23, "27"},
  TestItem{32, "40"},
  TestItem{36, "44"},
  TestItem{127, "177"},
  TestItem{200, "310"},
  TestItem{255, "377"},
  TestItem{8158, "17736"},
  TestItem{50243, "142103"},
  TestItem{32767, "77777"},
  TestItem{87231, "252277"},
  TestItem{65535, "177777"},
  TestItem{17875098, "104140232"},
  TestItem{1787987597, "15244503215"},
  TestItem{2147483647, "17777777777"},
  TestItem{4294967295, "37777777777"},
  TestItem{657687465411, "11444116446703"},
  TestItem{89098098408713, "2420430440276411"},
  TestItem{4987654351689798, "215603730571214106"},
  TestItem{9223372036854775807, "777777777777777777777"},
  TestItem{-1, "-1", "1777777777777777777777"},
  TestItem{-13, "-15", "1777777777777777777763"},
  TestItem{-128, "-200", "1777777777777777777600"},
  TestItem{-879, "-1557", "1777777777777777776221"},
  TestItem{-12345, "-30071", "1777777777777777747707"},
  TestItem{-32768, "-100000", "1777777777777777700000"},
  TestItem{-5165781, "-23551325", "1777777777777754226453"},
  TestItem{-97897347, "-565345603", "1777777777777212432175"},
  TestItem{-2147483648, "-20000000000", "1777777777760000000000"},
  TestItem{-165789751156, "-2323165553564", "1777777775454612224214"},
  TestItem{-8798798743521135, "-372047277143543557", "1777405730500634234221"},
  TestItem{-9223372036854775807 - 1, "-1000000000000000000000", "1000000000000000000000"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<9>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "15"},
  TestItem{16, "17"},
  TestItem{23, "25"},
  TestItem{32, "35"},
  TestItem{36, "40"},
  TestItem{127, "151"},
  TestItem{200, "242"},
  TestItem{255, "313"},
  TestItem{8158, "12164"},
  TestItem{50243, "75825"},
  TestItem{32767, "48847"},
  TestItem{87231, "142583"},
  TestItem{65535, "108806"},
  TestItem{17875098, "36564020"},
  TestItem{1787987597, "4547364785"},
  TestItem{2147483647, "5478773671"},
  TestItem{4294967295, "12068657453"},
  TestItem{657687465411, "2285540887136"},
  TestItem{89098098408713, "380420680110332"},
  TestItem{4987654351689798, "26201732612386230"},
  TestItem{9223372036854775807, "67404283172107811827"},
  TestItem{-1, "-1", "145808576354216723756"},
  TestItem{-13, "-14", "145808576354216723743"},
  TestItem{-128, "-152", "145808576354216723605"},
  TestItem{-879, "-1176", "145808576354216722571"},
  TestItem{-12345, "-17836", "145808576354216704821"},
  TestItem{-32768, "-48848", "145808576354216663808"},
  TestItem{-5165781, "-10643106", "145808576354206070651"},
  TestItem{-97897347, "-224180820", "145808576353882532837"},
  TestItem{-2147483648, "-5478773672", "145808576347626840075"},
  TestItem{-165789751156, "-524834588427", "145808575728272124330"},
  TestItem{-8798798743521135, "-46654857455721136", "145751821385651002621"},
  TestItem{-9223372036854775807 - 1, "-67404283172107811828", "67404283172107811828"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<10>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "14"},
  TestItem{16, "16"},
  TestItem{23, "23"},
  TestItem{32, "32"},
  TestItem{36, "36"},
  TestItem{127, "127"},
  TestItem{200, "200"},
  TestItem{255, "255"},
  TestItem{8158, "8158"},
  TestItem{50243, "50243"},
  TestItem{32767, "32767"},
  TestItem{87231, "87231"},
  TestItem{65535, "65535"},
  TestItem{17875098, "17875098"},
  TestItem{1787987597, "1787987597"},
  TestItem{2147483647, "2147483647"},
  TestItem{4294967295, "4294967295"},
  TestItem{657687465411, "657687465411"},
  TestItem{89098098408713, "89098098408713"},
  TestItem{4987654351689798, "4987654351689798"},
  TestItem{9223372036854775807, "9223372036854775807"},
  TestItem{-1, "-1", "18446744073709551615"},
  TestItem{-13, "-13", "18446744073709551603"},
  TestItem{-128, "-128", "18446744073709551488"},
  TestItem{-879, "-879", "18446744073709550737"},
  TestItem{-12345, "-12345", "18446744073709539271"},
  TestItem{-32768, "-32768", "18446744073709518848"},
  TestItem{-5165781, "-5165781", "18446744073704385835"},
  TestItem{-97897347, "-97897347", "18446744073611654269"},
  TestItem{-2147483648, "-2147483648", "18446744071562067968"},
  TestItem{-165789751156, "-165789751156", "18446743907919800460"},
  TestItem{-8798798743521135, "-8798798743521135", "18437945274966030481"},
  TestItem{-9223372036854775807 - 1, "-9223372036854775808", "9223372036854775808"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<11>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "13"},
  TestItem{16, "15"},
  TestItem{23, "21"},
  TestItem{32, "2a"},
  TestItem{36, "33"},
  TestItem{127, "106"},
  TestItem{200, "172"},
  TestItem{255, "212"},
  TestItem{8158, "6147"},
  TestItem{50243, "34826"},
  TestItem{32767, "22689"},
  TestItem{87231, "5a5a1"},
  TestItem{65535, "45268"},
  TestItem{17875098, "a0a990a"},
  TestItem{1787987597, "8382aa600"},
  TestItem{2147483647, "a02220281"},
  TestItem{4294967295, "1904440553"},
  TestItem{657687465411, "233a18479149"},
  TestItem{89098098408713, "26431322850719"},
  TestItem{4987654351689798, "1215247371714788"},
  TestItem{9223372036854775807, "1728002635214590697"},
  TestItem{-1, "-1", "335500516a429071284"},
  TestItem{-13, "-12", "335500516a429071273"},
  TestItem{-128, "-107", "335500516a429071179"},
  TestItem{-879, "-72a", "335500516a429070656"},
  TestItem{-12345, "-9303", "335500516a429062a82"},
  TestItem{-32768, "-2268a", "335500516a4290496a6"},
  TestItem{-5165781, "-2a09145", "335500516a426163140"},
  TestItem{-97897347, "-502957a9", "335500516a388886587"},
  TestItem{-2147483648, "-a02220282", "3355005169526951003"},
  TestItem{-165789751156, "-64346aa0977", "3355005106092080409"},
  TestItem{-8798798743521135, "-21196286565646a8", "3352996641882607688"},
  TestItem{-9223372036854775807 - 1, "-1728002635214590698", "1728002635214590698"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<12>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "12"},
  TestItem{16, "14"},
  TestItem{23, "1b"},
  TestItem{32, "28"},
  TestItem{36, "30"},
  TestItem{127, "a7"},
  TestItem{200, "148"},
  TestItem{255, "193"},
  TestItem{8158, "487a"},
  TestItem{50243, "250ab"},
  TestItem{32767, "16b67"},
  TestItem{87231, "42593"},
  TestItem{65535, "31b13"},
  TestItem{17875098, "5ba0476"},
  TestItem{1787987597, "41a963065"},
  TestItem{2147483647, "4bb2308a7"},
  TestItem{4294967295, "9ba461593"},
  TestItem{657687465411, "a756a250143"},
  TestItem{89098098408713, "9bab984a720b5"},
  TestItem{4987654351689798, "3a74949b2918946"},
  TestItem{9223372036854775807, "41a792678515120367"},
  TestItem{-1, "-1", "839365134a2a240713"},
  TestItem{-13, "-11", "839365134a2a240703"},
  TestItem{-128, "-a8", "839365134a2a240628"},
  TestItem{-879, "-613", "839365134a2a240101"},
  TestItem{-12345, "-7189", "839365134a2a235547"},
  TestItem{-32768, "-16b68", "839365134a2a225768"},
  TestItem{-5165781, "-1891559", "839365134a2856b177"},
  TestItem{-97897347, "-28951683", "839365134a014ab051"},
  TestItem{-2147483648, "-4bb2308a8", "83936513452b00ba28"},
  TestItem{-165789751156, "-2816a79b044", "83936510887b661690"},
  TestItem{-8798798743521135, "-6a2a1618850b213", "83888231a861931501"},
  TestItem{-9223372036854775807 - 1, "-41a792678515120368", "41a792678515120368"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<13>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "11"},
  TestItem{16, "13"},
  TestItem{23, "1a"},
  TestItem{32, "26"},
  TestItem{36, "2a"},
  TestItem{127, "9a"},
  TestItem{200, "125"},
  TestItem{255, "168"},
  TestItem{8158, "3937"},
  TestItem{50243, "19b3b"},
  TestItem{32767, "11bb7"},
  TestItem{87231, "30921"},
  TestItem{65535, "23aa2"},
  TestItem{17875098, "391b1a7"},
  TestItem{1787987597, "226575536"},
  TestItem{2147483647, "282ba4aaa"},
  TestItem{4294967295, "535a79888"},
  TestItem{657687465411, "4a034274122"},
  TestItem{89098098408713, "3a93bb75916a4"},
  TestItem{4987654351689798, "136106a306aa2b9"},
  TestItem{9223372036854775807, "10b269549075433c37"},
  TestItem{-1, "-1", "219505a9511a867b72"},
  TestItem{-13, "-10", "219505a9511a867b63"},
  TestItem{-128, "-9b", "219505a9511a867aa5"},
  TestItem{-879, "-528", "219505a9511a867648"},
  TestItem{-12345, "-5808", "219505a9511a862368"},
  TestItem{-32768, "-11bb8", "219505a9511a855c88"},
  TestItem{-5165781, "-10bb39a", "219505a951197797a6"},
  TestItem{-97897347, "-17388732", "219505a951034ac441"},
  TestItem{-2147483648, "-282ba4aab", "219505a94b67993095"},
  TestItem{-165789751156, "-12831900493", "219505a825b8c676b0"},
  TestItem{-8798798743521135, "-23087b21342b37b", "2192a5216c074397c5"},
  TestItem{-9223372036854775807 - 1, "-10b269549075433c38", "10b269549075433c38"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<14>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "10"},
  TestItem{16, "12"},
  TestItem{23, "19"},
  TestItem{32, "24"},
  TestItem{36, "28"},
  TestItem{127, "91"},
  TestItem{200, "104"},
  TestItem{255, "143"},
  TestItem{8158, "2d8a"},
  TestItem{50243, "1444b"},
  TestItem{32767, "bd27"},
  TestItem{87231, "23b0b"},
  TestItem{65535, "19c51"},
  TestItem{17875098, "253436a"},
  TestItem{1787987597, "12d66ad9b"},
  TestItem{2147483647, "1652ca931"},
  TestItem{4294967295, "2ca5b7463"},
  TestItem{657687465411, "23b91964ccb"},
  TestItem{89098098408713, "1800529d3b449"},
  TestItem{4987654351689798, "63d91a89b041dc"},
  TestItem{9223372036854775807, "4340724c6c71dc7a7"},
  TestItem{-1, "-1", "8681049adb03db171"},
  TestItem{-13, "-d", "8681049adb03db163"},
  TestItem{-128, "-92", "8681049adb03db0c0"},
  TestItem{-879, "-46b", "8681049adb03dab05"},
  TestItem{-12345, "-46db", "8681049adb03d6875"},
  TestItem{-32768, "-bd28", "8681049adb03cd248"},
  TestItem{-5165781, "-986805", "8681049adad85476b"},
  TestItem{-97897347, "-d004c39", "8681049ada13d6337"},
  TestItem{-2147483648, "-1652ca932", "8681049ac49110640"},
  TestItem{-165789751156, "-804a833748", "86810492d639a7828"},
  TestItem{-8798798743521135, "-b12ac1ba9b155d", "8673d1ccbd3829a13"},
  TestItem{-9223372036854775807 - 1, "-4340724c6c71dc7a8", "4340724c6c71dc7a8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<15>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "11"},
  TestItem{23, "18"},
  TestItem{32, "22"},
  TestItem{36, "26"},
  TestItem{127, "87"},
  TestItem{200, "d5"},
  TestItem{255, "120"},
  TestItem{8158, "263d"},
  TestItem{50243, "ed48"},
  TestItem{32767, "9a97"},
  TestItem{87231, "1aca6"},
  TestItem{65535, "14640"},
  TestItem{17875098, "18814d3"},
  TestItem{1787987597, "a6e84182"},
  TestItem{2147483647, "c87e66b7"},
  TestItem{4294967295, "1a20dcd80"},
  TestItem{657687465411, "121945751c6"},
  TestItem{89098098408713, "a479a542a828"},
  TestItem{4987654351689798, "2869550810bbd3"},
  TestItem{9223372036854775807, "160e2ad3246366807"},
  TestItem{-1, "-1", "2c1d56b648c6cd110"},
  TestItem{-13, "-d", "2c1d56b648c6cd103"},
  TestItem{-128, "-88", "2c1d56b648c6cd078"},
  TestItem{-879, "-3d9", "2c1d56b648c6ccc27"},
  TestItem{-12345, "-39d0", "2c1d56b648c6c9631"},
  TestItem{-32768, "-9a98", "2c1d56b648c6c3568"},
  TestItem{-5165781, "-6c0906", "2c1d56b648c00c70a"},
  TestItem{-97897347, "-88db94c", "2c1d56b6483ce16b4"},
  TestItem{-2147483648, "-c87e66b8", "2c1d56b63b3dd6948"},
  TestItem{-165789751156, "-44a4de4371", "2c1d56b1ed77d8c90"},
  TestItem{-8798798743521135, "-47c36e329abc40", "2c18c97e559c213c1"},
  TestItem{-9223372036854775807 - 1, "-160e2ad3246366808", "160e2ad3246366808"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<16>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "10"},
  TestItem{23, "17"},
  TestItem{32, "20"},
  TestItem{36, "24"},
  TestItem{127, "7f"},
  TestItem{200, "c8"},
  TestItem{255, "ff"},
  TestItem{8158, "1fde"},
  TestItem{50243, "c443"},
  TestItem{32767, "7fff"},
  TestItem{87231, "154bf"},
  TestItem{65535, "ffff"},
  TestItem{17875098, "110c09a"},
  TestItem{1787987597, "6a92868d"},
  TestItem{2147483647, "7fffffff"},
  TestItem{4294967295, "ffffffff"},
  TestItem{657687465411, "99213a4dc3"},
  TestItem{89098098408713, "5108c4817d09"},
  TestItem{4987654351689798, "11b83ec5e51846"},
  TestItem{9223372036854775807, "7fffffffffffffff"},
  TestItem{-1, "-1", "ffffffffffffffff"},
  TestItem{-13, "-d", "fffffffffffffff3"},
  TestItem{-128, "-80", "ffffffffffffff80"},
  TestItem{-879, "-36f", "fffffffffffffc91"},
  TestItem{-12345, "-3039", "ffffffffffffcfc7"},
  TestItem{-32768, "-8000", "ffffffffffff8000"},
  TestItem{-5165781, "-4ed2d5", "ffffffffffb12d2b"},
  TestItem{-97897347, "-5d5cb83", "fffffffffa2a347d"},
  TestItem{-2147483648, "-80000000", "ffffffff80000000"},
  TestItem{-165789751156, "-2699d6d774", "ffffffd96629288c"},
  TestItem{-8798798743521135, "-1f4275f98ec76f", "ffe0bd8a06713891"},
  TestItem{-9223372036854775807 - 1, "-8000000000000000", "8000000000000000"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<17>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "16"},
  TestItem{32, "1f"},
  TestItem{36, "22"},
  TestItem{127, "78"},
  TestItem{200, "bd"},
  TestItem{255, "f0"},
  TestItem{8158, "1b3f"},
  TestItem{50243, "a3e8"},
  TestItem{32767, "6b68"},
  TestItem{87231, "10ce4"},
  TestItem{65535, "d5d0"},
  TestItem{17875098, "ca0596"},
  TestItem{1787987597, "4614af50"},
  TestItem{2147483647, "53g7f548"},
  TestItem{4294967295, "a7ffda90"},
  TestItem{657687465411, "594d7e2g76"},
  TestItem{89098098408713, "2a3591510d44"},
  TestItem{4987654351689798, "8990c43d7g311"},
  TestItem{9223372036854775807, "33d3d8307b214008"},
  TestItem{-1, "-1", "67979g60f5428010"},
  TestItem{-13, "-d", "67979g60f5428005"},
  TestItem{-128, "-79", "67979g60f5427ga9"},
  TestItem{-879, "-30c", "67979g60f5427e06"},
  TestItem{-12345, "-28c3", "67979g60f542585f"},
  TestItem{-32768, "-6b69", "67979g60f54215b9"},
  TestItem{-5165781, "-3ae7b8", "67979g60f508a96a"},
  TestItem{-97897347, "-40g2328", "67979g60f1335dfa"},
  TestItem{-2147483648, "-53g7f549", "67979g60a14b9bd9"},
  TestItem{-165789751156, "-16d091d405", "67979g4b24c0bd0d"},
  TestItem{-8798798743521135, "-f1c8795a892be", "678983ea5gaafe64"},
  TestItem{-9223372036854775807 - 1, "-33d3d8307b214009", "33d3d8307b214009"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<18>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "15"},
  TestItem{32, "1e"},
  TestItem{36, "20"},
  TestItem{127, "71"},
  TestItem{200, "b2"},
  TestItem{255, "e3"},
  TestItem{8158, "1734"},
  TestItem{50243, "8b15"},
  TestItem{32767, "5b27"},
  TestItem{87231, "eh43"},
  TestItem{65535, "b44f"},
  TestItem{17875098, "985010"},
  TestItem{1787987597, "2ga46445"},
  TestItem{2147483647, "3928g3h1"},
  TestItem{4294967295, "704he7g3"},
  TestItem{657687465411, "35c4e632af"},
  TestItem{89098098408713, "16h32e8da31b"},
  TestItem{4987654351689798, "45ag9ehdb42f0"},
  TestItem{9223372036854775807, "16agh595df825fa7"},
  TestItem{-1, "-1", "2d3fgb0b9cg4bd2f"},
  TestItem{-13, "-d", "2d3fgb0b9cg4bd23"},
  TestItem{-128, "-72", "2d3fgb0b9cg4bcde"},
  TestItem{-879, "-2cf", "2d3fgb0b9cg4ba81"},
  TestItem{-12345, "-221f", "2d3fgb0b9cg49b11"},
  TestItem{-32768, "-5b28", "2d3fgb0b9cg46208"},
  TestItem{-5165781, "-2d3ddf", "2d3fgb0b9cd97h71"},
  TestItem{-97897347, "-2fea459", "2d3fgb0b9a0818f7"},
  TestItem{-2147483648, "-3928g3h2", "2d3fgb0b63ddd93e"},
  TestItem{-165789751156, "-f0e78hgeg", "2d3fgahe8g8dbe60"},
  TestItem{-8798798743521135, "-7ag5fghea4baf", "2d385ccdad1c71a1"},
  TestItem{-9223372036854775807 - 1, "-16agh595df825fa8", "16agh595df825fa8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<19>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "14"},
  TestItem{32, "1d"},
  TestItem{36, "1h"},
  TestItem{127, "6d"},
  TestItem{200, "aa"},
  TestItem{255, "d8"},
  TestItem{8158, "13b7"},
  TestItem{50243, "7637"},
  TestItem{32767, "4eeb"},
  TestItem{87231, "cdc2"},
  TestItem{65535, "9aa4"},
  TestItem{17875098, "74319c"},
  TestItem{1787987597, "2001gb47"},
  TestItem{2147483647, "27c57h32"},
  TestItem{4294967295, "4f5aff65"},
  TestItem{657687465411, "20ded6i0c9"},
  TestItem{89098098408713, "ea22b8cah4b"},
  TestItem{4987654351689798, "24f9b74c4f2i5"},
  TestItem{9223372036854775807, "ba643dci0ffeehh"},
  TestItem{-1, "-1", "141c8786h1ccaagg"},
  TestItem{-13, "-d", "141c8786h1ccaag4"},
  TestItem{-128, "-6e", "141c8786h1ccaaa3"},
  TestItem{-879, "-285", "141c8786h1cca88c"},
  TestItem{-12345, "-1f3e", "141c8786h1cc8ed3"},
  TestItem{-32768, "-4eec", "141c8786h1cc5f25"},
  TestItem{-5165781, "-21c2c4", "141c8786h1aah84d"},
  TestItem{-97897347, "-21a3fei", "141c8786gib26e1i"},
  TestItem{-2147483648, "-27c57h33", "141c8786ed072cde"},
  TestItem{-165789751156, "-9e9009d4c", "141c877g2bcc0gc5"},
  TestItem{-8798798743521135, "-3ia245if4bh3d", "14188g62b1g7hcd4"},
  TestItem{-9223372036854775807 - 1, "-ba643dci0ffeehi", "ba643dci0ffeehi"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<20>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "13"},
  TestItem{32, "1c"},
  TestItem{36, "1g"},
  TestItem{127, "67"},
  TestItem{200, "a0"},
  TestItem{255, "cf"},
  TestItem{8158, "107i"},
  TestItem{50243, "65c3"},
  TestItem{32767, "41i7"},
  TestItem{87231, "ai1b"},
  TestItem{65535, "83gf"},
  TestItem{17875098, "5be7ei"},
  TestItem{1787987597, "17iei8jh"},
  TestItem{2147483647, "1db1f927"},
  TestItem{4294967295, "3723ai4f"},
  TestItem{657687465411, "15dg76d3ab"},
  TestItem{89098098408713, "8e07hff11fd"},
  TestItem{4987654351689798, "1471a4j4i149i"},
  TestItem{9223372036854775807, "5cbfjia3fh26ja7"},
  TestItem{-1, "-1", "b53bjh07be4dj0f"},
  TestItem{-13, "-d", "b53bjh07be4dj03"},
  TestItem{-128, "-68", "b53bjh07be4die8"},
  TestItem{-879, "-23j", "b53bjh07be4dggh"},
  TestItem{-12345, "-1ah5", "b53bjh07be4c83b"},
  TestItem{-32768, "-41i8", "b53bjh07be49h28"},
  TestItem{-5165781, "-1c5e91", "b53bjh07bcc84bf"},
  TestItem{-97897347, "-1abh377", "b53bjh07a3cgfd9"},
  TestItem{-2147483648, "-1db1f928", "b53bjh05i32i9i8"},
  TestItem{-165789751156, "-69a95ihhg", "b53bjgdi14if130"},
  TestItem{-8798798743521135, "-22j531a7702gf", "b5190bh616hdg41"},
  TestItem{-9223372036854775807 - 1, "-5cbfjia3fh26ja8", "5cbfjia3fh26ja8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<21>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "12"},
  TestItem{32, "1b"},
  TestItem{36, "1f"},
  TestItem{127, "61"},
  TestItem{200, "9b"},
  TestItem{255, "c3"},
  TestItem{8158, "iaa"},
  TestItem{50243, "58jb"},
  TestItem{32767, "3b67"},
  TestItem{87231, "98gi"},
  TestItem{65535, "71cf"},
  TestItem{17875098, "47j323"},
  TestItem{1787987597, "khgd7db"},
  TestItem{2147483647, "140h2d91"},
  TestItem{4294967295, "281d55i3"},
  TestItem{657687465411, "h8380j1hi"},
  TestItem{89098098408713, "573e0c1i832"},
  TestItem{4987654351689798, "e509g876icbc"},
  TestItem{9223372036854775807, "2heiciiie82dh97"},
  TestItem{-1, "-1", "5e8g4ggg7g56dif"},
  TestItem{-13, "-d", "5e8g4ggg7g56di3"},
  TestItem{-128, "-62", "5e8g4ggg7g56dce"},
  TestItem{-879, "-1ki", "5e8g4ggg7g56bij"},
  TestItem{-12345, "-16ki", "5e8g4ggg7g556ij"},
  TestItem{-32768, "-3b68", "5e8g4ggg7g532c8"},
  TestItem{-5165781, "-15bggc", "5e8g4ggg7ekfi24"},
  TestItem{-97897347, "-12k7j99", "5e8g4ggg6d5jf97"},
  TestItem{-2147483648, "-140h2d92", "5e8g4ggf3f9409e"},
  TestItem{-165789751156, "-4810jfbh1", "5e8g4gc86f6c21f"},
  TestItem{-8798798743521135, "-142aeg3hh6d66", "5e7c26203j900ca"},
  TestItem{-9223372036854775807 - 1, "-2heiciiie82dh98", "2heiciiie82dh98"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<22>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "11"},
  TestItem{32, "1a"},
  TestItem{36, "1e"},
  TestItem{127, "5h"},
  TestItem{200, "92"},
  TestItem{255, "bd"},
  TestItem{8158, "gii"},
  TestItem{50243, "4fhh"},
  TestItem{32767, "31f9"},
  TestItem{87231, "8451"},
  TestItem{65535, "638j"},
  TestItem{17875098, "3a6g0a"},
  TestItem{1787987597, "fgkdf5b"},
  TestItem{2147483647, "ikf5bf1"},
  TestItem{4294967295, "1fj8b183"},
  TestItem{657687465411, "bleg6ejd9"},
  TestItem{89098098408713, "37hdih28769"},
  TestItem{4987654351689798, "8bh7ga79fff8"},
  TestItem{9223372036854775807, "1adaibb21dckfa7"},
  TestItem{-1, "-1", "2l4lf104353j8kf"},
  TestItem{-13, "-d", "2l4lf104353j8k3"},
  TestItem{-128, "-5i", "2l4lf104353j8ek"},
  TestItem{-879, "-1hl", "2l4lf104353j72h"},
  TestItem{-12345, "-13b3", "2l4lf104353i59d"},
  TestItem{-32768, "-31fa", "2l4lf104353g756"},
  TestItem{-5165781, "-101325", "2l4lf104343i5ib"},
  TestItem{-97897347, "-iljl59", "2l4lf104283l9f7"},
  TestItem{-2147483648, "-ikf5bf2", "2l4lf10366adj5e"},
  TestItem{-165789751156, "-30a5akg3i", "2l4lf0j3elekegk"},
  TestItem{-8798798743521135, "-f1640a92a4aj", "2l46dgi3ei1949j"},
  TestItem{-9223372036854775807 - 1, "-1adaibb21dckfa8", "1adaibb21dckfa8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<23>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "10"},
  TestItem{32, "19"},
  TestItem{36, "1d"},
  TestItem{127, "5c"},
  TestItem{200, "8g"},
  TestItem{255, "b2"},
  TestItem{8158, "f9g"},
  TestItem{50243, "42mb"},
  TestItem{32767, "2flf"},
  TestItem{87231, "73kf"},
  TestItem{65535, "58k8"},
  TestItem{17875098, "2hk384"},
  TestItem{1787987597, "c1i6jh4"},
  TestItem{2147483647, "ebelf95"},
  TestItem{4294967295, "1606k7ib"},
  TestItem{657687465411, "893h9911i"},
  TestItem{89098098408713, "23ah4568ij5"},
  TestItem{4987654351689798, "5593832cgbh5"},
  TestItem{9223372036854775807, "i6k448cf4192c2"},
  TestItem{-1, "-1", "1ddh88h2782i515"},
  TestItem{-13, "-d", "1ddh88h2782i50g"},
  TestItem{-128, "-5d", "1ddh88h2782i4ig"},
  TestItem{-879, "-1f5", "1ddh88h2782i391"},
  TestItem{-12345, "-107h", "1ddh88h2782h4gc"},
  TestItem{-32768, "-2flg", "1ddh88h2782fc2d"},
  TestItem{-5165781, "-iad44", "1ddh88h27777ek2"},
  TestItem{-97897347, "-f4j339", "1ddh88h26fkm1kk"},
  TestItem{-2147483648, "-ebelf96", "1ddh88h1fjajcf0"},
  TestItem{-165789751156, "-22fl8fd26", "1ddh88eme9h2em0"},
  TestItem{-8798798743521135, "-959237id6l1d", "1dd82melmccb6mg"},
  TestItem{-9223372036854775807 - 1, "-i6k448cf4192c3", "i6k448cf4192c3"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<24>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "18"},
  TestItem{36, "1c"},
  TestItem{127, "57"},
  TestItem{200, "88"},
  TestItem{255, "af"},
  TestItem{8158, "e3m"},
  TestItem{50243, "3f5b"},
  TestItem{32767, "28l7"},
  TestItem{87231, "67af"},
  TestItem{65535, "4hif"},
  TestItem{17875098, "25l13i"},
  TestItem{1787987597, "98d3935"},
  TestItem{2147483647, "b5gge57"},
  TestItem{4294967295, "mb994af"},
  TestItem{657687465411, "5n9cjjc83"},
  TestItem{89098098408713, "19ha6jjmi5h"},
  TestItem{4987654351689798, "36fn6m8cke86"},
  TestItem{9223372036854775807, "acd772jnc9l0l7"},
  TestItem{-1, "-1", "l12ee5fn0ji1if"},
  TestItem{-13, "-d", "l12ee5fn0ji1i3"},
  TestItem{-128, "-58", "l12ee5fn0ji1d8"},
  TestItem{-879, "-1cf", "l12ee5fn0ji061"},
  TestItem{-12345, "-la9", "l12ee5fn0jh487"},
  TestItem{-32768, "-28l8", "l12ee5fn0jfgl8"},
  TestItem{-5165781, "-fdg8l", "l12ee5fn04499j"},
  TestItem{-97897347, "-c71gg3", "l12ee5fmccg92d"},
  TestItem{-2147483648, "-b5gge58", "l12ee5fbj31bd8"},
  TestItem{-165789751156, "-1c3cnkl24", "l12ee43jbjl4gc"},
  TestItem{-8798798743521135, "-5iie89l3j9cf", "l0kjjf7d3fmg61"},
  TestItem{-9223372036854775807 - 1, "-acd772jnc9l0l8", "acd772jnc9l0l8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<25>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "17"},
  TestItem{36, "1b"},
  TestItem{127, "52"},
  TestItem{200, "80"},
  TestItem{255, "a5"},
  TestItem{8158, "d18"},
  TestItem{50243, "359i"},
  TestItem{32767, "22ah"},
  TestItem{87231, "5ee6"},
  TestItem{65535, "44la"},
  TestItem{17875098, "1kj03n"},
  TestItem{1787987597, "782653m"},
  TestItem{2147483647, "8jmdnkm"},
  TestItem{4294967295, "hek2mgk"},
  TestItem{657687465411, "47im4mjgb"},
  TestItem{89098098408713, "n8mkk6n3nd"},
  TestItem{4987654351689798, "227c275f83gn"},
  TestItem{9223372036854775807, "64ie1focnn5g77"},
  TestItem{-1, "-1", "c9c336o0mlb7ef"},
  TestItem{-13, "-d", "c9c336o0mlb7e3"},
  TestItem{-128, "-53", "c9c336o0mlb79d"},
  TestItem{-879, "-1a4", "c9c336o0mlb64c"},
  TestItem{-12345, "-jik", "c9c336o0mlackl"},
  TestItem{-32768, "-22ai", "c9c336o0ml953n"},
  TestItem{-5165781, "-d5f66", "c9c336o0m85h8a"},
  TestItem{-97897347, "-a0faim", "c9c336o0ckklkj"},
  TestItem{-2147483648, "-8jmdnkn", "c9c336nh2nm8ii"},
  TestItem{-165789751156, "-1241lj1l6", "c9c335llkoh5ia"},
  TestItem{-8798798743521135, "-3h6dk4g8a8ka", "c98ali3l6d0nj6"},
  TestItem{-9223372036854775807 - 1, "-64ie1focnn5g78", "64ie1focnn5g78"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<26>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "16"},
  TestItem{36, "1a"},
  TestItem{127, "4n"},
  TestItem{200, "7i"},
  TestItem{255, "9l"},
  TestItem{8158, "c1k"},
  TestItem{50243, "2m8b"},
  TestItem{32767, "1mc7"},
  TestItem{87231, "4p11"},
  TestItem{65535, "3iof"},
  TestItem{17875098, "1d30bk"},
  TestItem{1787987597, "5kcgo1j"},
  TestItem{2147483647, "6oj8ion"},
  TestItem{4294967295, "dnchbnl"},
  TestItem{657687465411, "33n0cgjkf"},
  TestItem{89098098408713, "gah3p9d4oh"},
  TestItem{4987654351689798, "198g3f10hdim"},
  TestItem{9223372036854775807, "3igoecjbmca687"},
  TestItem{-1, "-1", "7b7n2pcniokcgf"},
  TestItem{-13, "-d", "7b7n2pcniokcg3"},
  TestItem{-128, "-4o", "7b7n2pcniokcbi"},
  TestItem{-879, "-17l", "7b7n2pcniokb8l"},
  TestItem{-12345, "-i6l", "7b7n2pcniojk9l"},
  TestItem{-32768, "-1mc8", "7b7n2pcnioig48"},
  TestItem{-5165781, "-b7nhn", "7b7n2pcnidceoj"},
  TestItem{-97897347, "-865oef", "7b7n2pcnaiee21"},
  TestItem{-2147483648, "-6oj8ioo", "7b7n2pcgk5bjhi"},
  TestItem{-165789751156, "-kghjd14g", "7b7n2oi7157bc0"},
  TestItem{-8798798743521135, "-2a8e9ma7ckab", "7b5ckb318h7i65"},
  TestItem{-9223372036854775807 - 1, "-3igoecjbmca688", "3igoecjbmca688"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<27>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "15"},
  TestItem{36, "19"},
  TestItem{127, "4j"},
  TestItem{200, "7b"},
  TestItem{255, "9c"},
  TestItem{8158, "b54"},
  TestItem{50243, "2eon"},
  TestItem{32767, "1hpg"},
  TestItem{87231, "4bhl"},
  TestItem{65535, "38o6"},
  TestItem{17875098, "16h40i"},
  TestItem{1787987597, "4ggb4nn"},
  TestItem{2147483647, "5ehncka"},
  TestItem{4294967295, "b28jpdl"},
  TestItem{657687465411, "28ng9qp46"},
  TestItem{89098098408713, "biciki39a2"},
  TestItem{4987654351689798, "o61m2ibbo70"},
  TestItem{9223372036854775807, "27c48l5b37oaop"},
  TestItem{-1, "-1", "4eo8hfam6fllmo"},
  TestItem{-13, "-d", "4eo8hfam6fllmc"},
  TestItem{-128, "-4k", "4eo8hfam6flli5"},
  TestItem{-879, "-15f", "4eo8hfam6flkha"},
  TestItem{-12345, "-gp6", "4eo8hfam6fl4oj"},
  TestItem{-32768, "-1hph", "4eo8hfam6fk3o8"},
  TestItem{-5165781, "-9jc36", "4eo8hfam6629jj"},
  TestItem{-97897347, "-6m5ioi", "4eo8hfalqkg2p7"},
  TestItem{-2147483648, "-5ehnckb", "4eo8hfagiop92e"},
  TestItem{-165789751156, "-fmp4hqcp", "4eo8helq8b3ma0"},
  TestItem{-8798798743521135, "-1fjmppdnlj46", "4emjojbnjj02ij"},
  TestItem{-9223372036854775807 - 1, "-27c48l5b37oaoq", "27c48l5b37oaoq"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<28>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "14"},
  TestItem{36, "18"},
  TestItem{127, "4f"},
  TestItem{200, "74"},
  TestItem{255, "93"},
  TestItem{8158, "aba"},
  TestItem{50243, "282b"},
  TestItem{32767, "1dm7"},
  TestItem{87231, "3r7b"},
  TestItem{65535, "2rgf"},
  TestItem{17875098, "1127oa"},
  TestItem{1787987597, "3jopobp"},
  TestItem{2147483647, "4clm98f"},
  TestItem{4294967295, "8pfgih3"},
  TestItem{657687465411, "1kkmh0h6b"},
  TestItem{89098098408713, "8bn8p9o4g9"},
  TestItem{4987654351689798, "gndle47p0dq"},
  TestItem{9223372036854775807, "1bk39f3ah3dmq7"},
  TestItem{-1, "-1", "2nc6j26l66rhof"},
  TestItem{-13, "-d", "2nc6j26l66rho3"},
  TestItem{-128, "-4g", "2nc6j26l66rhk0"},
  TestItem{-879, "-13b", "2nc6j26l66rgl5"},
  TestItem{-12345, "-fkp", "2nc6j26l66r23j"},
  TestItem{-32768, "-1dm8", "2nc6j26l66q428"},
  TestItem{-5165781, "-8b905", "2nc6j26l5qg8ob"},
  TestItem{-97897347, "-5j7h1n", "2nc6j26l0fk0ml"},
  TestItem{-2147483648, "-4clm98g", "2nc6j26gld58g0"},
  TestItem{-165789751156, "-c813jj98", "2nc6j1md537qf8"},
  TestItem{-8798798743521135, "-11jlcchmfpnr", "2nb4r8m8gcbk0h"},
  TestItem{-9223372036854775807 - 1, "-1bk39f3ah3dmq8", "1bk39f3ah3dmq8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<29>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "13"},
  TestItem{36, "17"},
  TestItem{127, "4b"},
  TestItem{200, "6q"},
  TestItem{255, "8n"},
  TestItem{8158, "9k9"},
  TestItem{50243, "21lf"},
  TestItem{32767, "19rq"},
  TestItem{87231, "3gks"},
  TestItem{65535, "2jqo"},
  TestItem{17875098, "p7qgk"},
  TestItem{1787987597, "304s6jl"},
  TestItem{2147483647, "3hk7987"},
  TestItem{4294967295, "76beigf"},
  TestItem{657687465411, "193jpcaqi"},
  TestItem{89098098408713, "643457jb33"},
  TestItem{4987654351689798, "bonbd6e6crj"},
  TestItem{9223372036854775807, "q1se8f0m04isb"},
  TestItem{-1, "-1", "1n3rsh11f098rn"},
  TestItem{-13, "-d", "1n3rsh11f098rb"},
  TestItem{-128, "-4c", "1n3rsh11f098nc"},
  TestItem{-879, "-119", "1n3rsh11f097qf"},
  TestItem{-12345, "-ejk", "1n3rsh11f08n84"},
  TestItem{-32768, "-19rr", "1n3rsh11f07rsq"},
  TestItem{-5165781, "-78ncb", "1n3rsh11em0efd"},
  TestItem{-97897347, "-4mbsph", "1n3rsh11a6q927"},
  TestItem{-2147483648, "-3hk7988", "1n3rsh0qq91sjg"},
  TestItem{-165789751156, "-9hkqadrq", "1n3rsgkcn2rnsr"},
  TestItem{-8798798743521135, "-kqeqrdc8q2l", "1n3722331h0bp3"},
  TestItem{-9223372036854775807 - 1, "-q1se8f0m04isc", "q1se8f0m04isc"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<30>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "12"},
  TestItem{36, "16"},
  TestItem{127, "47"},
  TestItem{200, "6k"},
  TestItem{255, "8f"},
  TestItem{8158, "91s"},
  TestItem{50243, "1pon"},
  TestItem{32767, "16c7"},
  TestItem{87231, "36rl"},
  TestItem{65535, "2cof"},
  TestItem{17875098, "m216i"},
  TestItem{1787987597, "2dhbmqh"},
  TestItem{2147483647, "2sb6cs7"},
  TestItem{4294967295, "5qmcpqf"},
  TestItem{657687465411, "10259p0dl"},
  TestItem{89098098408713, "4fnticaknn"},
  TestItem{4987654351689798, "8dbt5ff1e6i"},
  TestItem{9223372036854775807, "hajppbc1fc207"},
  TestItem{-1, "-1", "14l9lkmo30o40f"},
  TestItem{-13, "-d", "14l9lkmo30o403"},
  TestItem{-128, "-48", "14l9lkmo30o3q8"},
  TestItem{-879, "-t9", "14l9lkmo30o317"},
  TestItem{-12345, "-dlf", "14l9lkmo30nk91"},
  TestItem{-32768, "-16c8", "14l9lkmo30mri8"},
  TestItem{-5165781, "-6b9ml", "14l9lkmo2oco7p"},
  TestItem{-97897347, "-40poor", "14l9lkmnsts95j"},
  TestItem{-2147483648, "-2sb6cs8", "14l9lkml4jhl28"},
  TestItem{-165789751156, "-7hcil4ig", "14l9lkf6kc2tc0"},
  TestItem{-8798798743521135, "-er0mmn856of", "14kook019mir61"},
  TestItem{-9223372036854775807 - 1, "-hajppbc1fc208", "hajppbc1fc208"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<31>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "11"},
  TestItem{36, "15"},
  TestItem{127, "43"},
  TestItem{200, "6e"},
  TestItem{255, "87"},
  TestItem{8158, "8f5"},
  TestItem{50243, "1l8n"},
  TestItem{32767, "1330"},
  TestItem{87231, "2sns"},
  TestItem{65535, "2661"},
  TestItem{17875098, "jb0g2"},
  TestItem{1787987597, "20e1m08"},
  TestItem{2147483647, "2d09uc1"},
  TestItem{4294967295, "4q0jto3"},
  TestItem{657687465411, "ns1k4jpl"},
  TestItem{89098098408713, "3bedp0lfkl"},
  TestItem{4987654351689798, "62jt2sednp7"},
  TestItem{9223372036854775807, "bm03i95hia437"},
  TestItem{-1, "-1", "nd075ib45k86f"},
  TestItem{-13, "-d", "nd075ib45k863"},
  TestItem{-128, "-44", "nd075ib45k82c"},
  TestItem{-879, "-sb", "nd075ib45k795"},
  TestItem{-12345, "-cq7", "nd075ib45jqb9"},
  TestItem{-32768, "-1331", "nd075ib45j53f"},
  TestItem{-5165781, "-5icd3", "nd075ib401qod"},
  TestItem{-97897347, "-3d048t", "nd075ib0nk3si"},
  TestItem{-2147483648, "-2d09uc2", "nd075i8m5a8pe"},
  TestItem{-165789751156, "-60ot667s", "nd075caa7e1tj"},
  TestItem{-8798798743521135, "-amodj9ieogq", "nckfc4mpi5ekl"},
  TestItem{-9223372036854775807 - 1, "-bm03i95hia438", "bm03i95hia438"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<32>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "10"},
  TestItem{36, "14"},
  TestItem{127, "3v"},
  TestItem{200, "68"},
  TestItem{255, "7v"},
  TestItem{8158, "7uu"},
  TestItem{50243, "1h23"},
  TestItem{32767, "vvv"},
  TestItem{87231, "2l5v"},
  TestItem{65535, "1vvv"},
  TestItem{17875098, "h1g4q"},
  TestItem{1787987597, "1l951kd"},
  TestItem{2147483647, "1vvvvvv"},
  TestItem{4294967295, "3vvvvvv"},
  TestItem{657687465411, "j4gjkje3"},
  TestItem{89098098408713, "2h13282v89"},
  TestItem{4987654351689798, "4do7r2ua626"},
  TestItem{9223372036854775807, "7vvvvvvvvvvvv"},
  TestItem{-1, "-1", "fvvvvvvvvvvvv"},
  TestItem{-13, "-d", "fvvvvvvvvvvvj"},
  TestItem{-128, "-40", "fvvvvvvvvvvs0"},
  TestItem{-879, "-rf", "fvvvvvvvvvv4h"},
  TestItem{-12345, "-c1p", "fvvvvvvvvvju7"},
  TestItem{-32768, "-1000", "fvvvvvvvvv000"},
  TestItem{-5165781, "-4tkml", "fvvvvvvvr2b9b"},
  TestItem{-97897347, "-2tbis3", "fvvvvvvt2kd3t"},
  TestItem{-2147483648, "-2000000", "fvvvvvu000000"},
  TestItem{-165789751156, "-4qctdlrk", "fvvvvr5j2ia4c"},
  TestItem{-8798798743521135, "-7q2ensothrf", "fvo5th8372e4h"},
  TestItem{-9223372036854775807 - 1, "-8000000000000", "8000000000000"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<33>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "w"},
  TestItem{36, "13"},
  TestItem{127, "3s"},
  TestItem{200, "62"},
  TestItem{255, "7o"},
  TestItem{8158, "7g7"},
  TestItem{50243, "1d4h"},
  TestItem{32767, "u2v"},
  TestItem{87231, "2e3c"},
  TestItem{65535, "1r5u"},
  TestItem{17875098, "f2d7l"},
  TestItem{1787987597, "1cmmctb"},
  TestItem{2147483647, "1lsqtl1"},
  TestItem{4294967295, "3aokq93"},
  TestItem{657687465411, "fe8eg7g9"},
  TestItem{89098098408713, "1ubjpukd0k"},
  TestItem{4987654351689798, "38fcdu5s9du"},
  TestItem{9223372036854775807, "5hg4ck9jd4u37"},
  TestItem{-1, "-1", "b1w8p7j5q9r6f"},
  TestItem{-13, "-d", "b1w8p7j5q9r63"},
  TestItem{-128, "-3t", "b1w8p7j5q9r2k"},
  TestItem{-879, "-ql", "b1w8p7j5q9qcs"},
  TestItem{-12345, "-bb3", "b1w8p7j5q9fsd"},
  TestItem{-32768, "-u2w", "b1w8p7j5q8u3h"},
  TestItem{-5165781, "-4bojr", "b1w8p7j5lv2jm"},
  TestItem{-97897347, "-2gi4i9", "b1w8p7j39oml7"},
  TestItem{-2147483648, "-1lsqtl2", "b1w8p7hgufuie"},
  TestItem{-165789751156, "-3tcaa767", "b1w8p3mqfwk09"},
  TestItem{-8798798743521135, "-5oj768v1cwu", "b1qh60cts8e6j"},
  TestItem{-9223372036854775807 - 1, "-5hg4ck9jd4u38", "5hg4ck9jd4u38"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<34>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "w"},
  TestItem{36, "12"},
  TestItem{127, "3p"},
  TestItem{200, "5u"},
  TestItem{255, "7h"},
  TestItem{8158, "71w"},
  TestItem{50243, "19fp"},
  TestItem{32767, "sbp"},
  TestItem{87231, "27fl"},
  TestItem{65535, "1mnh"},
  TestItem{17875098, "dcqu6"},
  TestItem{1787987597, "15bx82h"},
  TestItem{2147483647, "1d8xqrp"},
  TestItem{4294967295, "2qhxjlh"},
  TestItem{657687465411, "chp78tkn"},
  TestItem{89098098408713, "1fubx38kal"},
  TestItem{4987654351689798, "2e4wnws450i"},
  TestItem{9223372036854775807, "3tdtk1v8j6tpp"},
  TestItem{-1, "-1", "7orp63sh4dphh"},
  TestItem{-13, "-d", "7orp63sh4dph5"},
  TestItem{-128, "-3q", "7orp63sh4dpdq"},
  TestItem{-879, "-pt", "7orp63sh4dopn"},
  TestItem{-12345, "-an3", "7orp63sh4desf"},
  TestItem{-32768, "-sbq", "7orp63sh4cv5q"},
  TestItem{-5165781, "-3temp", "7orp63sh0iasr"},
  TestItem{-97897347, "-258q9p", "7orp63sex4x7r"},
  TestItem{-2147483648, "-1d8xqrq", "7orp63r3tdwnq"},
  TestItem{-165789751156, "-35auvdpm", "7orp60n67gbpu"},
  TestItem{-8798798743521135, "-48v3mdkohmv", "7ong9063hn7sl"},
  TestItem{-9223372036854775807 - 1, "-3tdtk1v8j6tpq", "3tdtk1v8j6tpq"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<35>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "w"},
  TestItem{36, "11"},
  TestItem{127, "3m"},
  TestItem{200, "5p"},
  TestItem{255, "7a"},
  TestItem{8158, "6n3"},
  TestItem{50243, "160i"},
  TestItem{32767, "qq7"},
  TestItem{87231, "217b"},
  TestItem{65535, "1ihf"},
  TestItem{17875098, "bvvw3"},
  TestItem{1787987597, "y1hbow"},
  TestItem{2147483647, "15v22um"},
  TestItem{4294967295, "2br45qa"},
  TestItem{657687465411, "a7r5obub"},
  TestItem{89098098408713, "14jsjs3s4n"},
  TestItem{4987654351689798, "1s9v46xlmyx"},
  TestItem{9223372036854775807, "2pijmikexrxp7"},
  TestItem{-1, "-1", "5g24a25twkwff"},
  TestItem{-13, "-d", "5g24a25twkwf3"},
  TestItem{-128, "-3n", "5g24a25twkwbs"},
  TestItem{-879, "-p4", "5g24a25twkvpc"},
  TestItem{-12345, "-a2p", "5g24a25twkmcq"},
  TestItem{-32768, "-qq8", "5g24a25twk5o8"},
  TestItem{-5165781, "-3fgxq", "5g24a25tt5fgp"},
  TestItem{-97897347, "-1u8b72", "5g24a25s2cl8e"},
  TestItem{-2147483648, "-15v22un", "5g24a24o1itjs"},
  TestItem{-165789751156, "-2k6kgcd1", "5g249yknc4k2f"},
  TestItem{-8798798743521135, "-36mb7iv78yk", "5fxwmpxb1dnfv"},
  TestItem{-9223372036854775807 - 1, "-2pijmikexrxp8", "2pijmikexrxp8"},
}};

template <>
constexpr cuda::std::array<TestItem, 40> test_items<36>{{
  TestItem{0, "0"},
  TestItem{1, "1"},
  TestItem{2, "2"},
  TestItem{3, "3"},
  TestItem{4, "4"},
  TestItem{7, "7"},
  TestItem{8, "8"},
  TestItem{14, "e"},
  TestItem{16, "g"},
  TestItem{23, "n"},
  TestItem{32, "w"},
  TestItem{36, "10"},
  TestItem{127, "3j"},
  TestItem{200, "5k"},
  TestItem{255, "73"},
  TestItem{8158, "6am"},
  TestItem{50243, "12rn"},
  TestItem{32767, "pa7"},
  TestItem{87231, "1vb3"},
  TestItem{65535, "1ekf"},
  TestItem{17875098, "an4ii"},
  TestItem{1787987597, "tkis25"},
  TestItem{2147483647, "zik0zj"},
  TestItem{4294967295, "1z141z3"},
  TestItem{657687465411, "8e4y4w5f"},
  TestItem{89098098408713, "vkz3ncirt"},
  TestItem{4987654351689798, "1d3z4rzkrpi"},
  TestItem{9223372036854775807, "1y2p0ij32e8e7"},
  TestItem{-1, "-1", "3w5e11264sgsf"},
  TestItem{-13, "-d", "3w5e11264sgs3"},
  TestItem{-128, "-3k", "3w5e11264sgow"},
  TestItem{-879, "-of", "3w5e11264sg41"},
  TestItem{-12345, "-9ix", "3w5e11264s79j"},
  TestItem{-32768, "-pa8", "3w5e11264rri8"},
  TestItem{-5165781, "-32pxx", "3w5e11261pquj"},
  TestItem{-97897347, "-1maa2r", "3w5e1124ii6pp"},
  TestItem{-2147483648, "-zik0zk", "3w5e1116m8fsw"},
  TestItem{-165789751156, "-245uxqpg", "3w5e0yy09uq30"},
  TestItem{-8798798743521135, "-2emwwc9n2wf", "3w2ze45tv5dw1"},
  TestItem{-9223372036854775807 - 1, "-1y2p0ij32e8e8", "1y2p0ij32e8e8"},
}};

template <class T, int Base>
__host__ __device__ constexpr void test_to_chars(const TestItem& item)
{
  constexpr cuda::std::size_t buff_size = 150;

  static_assert(cuda::std::is_same_v<
                cuda::std::to_chars_result,
                decltype(cuda::std::to_chars(cuda::std::declval<char*>(), cuda::std::declval<char*>(), T{}, int{}))>);
  static_assert(noexcept(cuda::std::to_chars(cuda::std::declval<char*>(), cuda::std::declval<char*>(), T{}, int{})));

  // std::in_range accepts integer types only
  using RangeT =
    cuda::std::conditional_t<cuda::std::is_same_v<T, char>,
                             cuda::std::conditional_t<cuda::std::is_signed_v<T>, signed char, unsigned char>,
                             T>;

  if (cuda::std::in_range<RangeT>(item.val))
  {
    const auto ref_len = str_len(item.str_signed);
    char buff[buff_size + 1]{};
    char* buff_start = buff + 1;

    const auto value    = static_cast<T>(item.val);
    const char* ref_str = (cuda::std::is_signed_v<T>) ? item.str_signed : item.str_unsigned;

    // Check valid buffer size
    {
      const auto result = cuda::std::to_chars(buff_start, buff_start + buff_size, value, Base);
      assert(result.ec == cuda::std::errc{});
      assert(result.ptr == buff_start + ref_len);

      // Compare with reference string
      assert(str_equal(buff_start, ref_str, buff_size));

      // Check that the operation did not underflow the buffer
      assert(buff[0] == '\0');
    }

    // Check too small buffer
    {
      const auto result = cuda::std::to_chars(buff_start, buff_start + ref_len - 1, value, Base);
      assert(result.ec == cuda::std::errc::value_too_large);
      assert(result.ptr == buff_start + ref_len - 1);
    }

    // Check zero buffer
    {
      const auto result = cuda::std::to_chars(buff_start, buff_start, value, Base);
      assert(result.ec == cuda::std::errc::value_too_large);
      assert(result.ptr == buff_start);
    }
  }
}

template <int Base>
__host__ __device__ constexpr void test_base()
{
  // Test invocability with char (char values are tested during int8_t)
  static_assert(
    cuda::std::is_same_v<
      cuda::std::to_chars_result,
      decltype(cuda::std::to_chars(cuda::std::declval<char*>(), cuda::std::declval<char*>(), char{}, int{}))>);
  static_assert(noexcept(cuda::std::to_chars(cuda::std::declval<char*>(), cuda::std::declval<char*>(), char{}, int{})));

  for (const auto& item : test_items<Base>)
  {
    test_to_chars<char, Base>(item);

    test_to_chars<signed char, Base>(item);
    test_to_chars<signed short, Base>(item);
    test_to_chars<signed int, Base>(item);
    test_to_chars<signed long, Base>(item);
    test_to_chars<signed long long, Base>(item);
#if _CCCL_HAS_INT128()
    test_to_chars<__int128_t, Base>(item);
#endif // _CCCL_HAS_INT128()

    test_to_chars<unsigned char, Base>(item);
    test_to_chars<unsigned short, Base>(item);
    test_to_chars<unsigned int, Base>(item);
    test_to_chars<unsigned long, Base>(item);
    test_to_chars<unsigned long long, Base>(item);
#if _CCCL_HAS_INT128()
    test_to_chars<__uint128_t, Base>(item);
#endif // _CCCL_HAS_INT128()
  }
}

template <int... Base>
__host__ __device__ constexpr void test_helper(cuda::std::integer_sequence<int, Base...>)
{
  (test_base<Base + first_base>(), ...);
}

__host__ __device__ constexpr bool test()
{
  test_helper(cuda::std::make_integer_sequence<int, last_base - first_base + 1>{});

  return true;
}

int main(int, char**)
{
  test();
  static_assert(test());
  return 0;
}
